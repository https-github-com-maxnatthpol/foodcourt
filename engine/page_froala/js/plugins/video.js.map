/*!
 * froala_editor v3.2.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

{"version":3,"file":"video.js","sources":["../../../src/js/plugins/video.js"],"sourcesContent":["import FE from '../index.js'\r\n'use strict';\r\n\r\nObject.assign(FE.POPUP_TEMPLATES, {\r\n  'video.insert': '[_BUTTONS_][_BY_URL_LAYER_][_EMBED_LAYER_][_UPLOAD_LAYER_][_PROGRESS_BAR_]',\r\n  'video.edit': '[_BUTTONS_]',\r\n  'video.size': '[_BUTTONS_][_SIZE_LAYER_]'\r\n})\r\n\r\nObject.assign(FE.DEFAULTS, {\r\n  videoAllowedTypes: ['mp4', 'webm', 'ogg', 'mp3', 'mpeg', 'url'],\r\n  videoAllowedProviders: ['.*'],\r\n  videoDefaultAlign: 'center',\r\n  videoDefaultDisplay: 'block',\r\n  videoDefaultWidth: 600,\r\n  videoEditButtons: ['videoReplace', 'videoRemove', 'videoDisplay', 'videoAlign', 'videoSize','autoplay'],\r\n  videoInsertButtons: ['videoBack', '|', 'videoByURL', 'videoEmbed', 'videoUpload'],\r\n  videoMaxSize: 50 * 1024 * 1024,\r\n  videoMove: true,\r\n  videoResize: true,\r\n  videoResponsive: false,\r\n  videoSizeButtons: ['videoBack', '|'],\r\n  videoSplitHTML: false,\r\n  videoTextNear: true,\r\n  videoUpload: true,\r\n  videoUploadMethod: 'POST',\r\n  videoUploadParam: 'file',\r\n  videoUploadParams: {},\r\n  videoUploadToS3: false,\r\n  videoUploadToAzure: false,\r\n  videoUploadURL: null\r\n}) \r\n\r\nFE.VIDEO_PROVIDERS = [\r\n  {\r\n    test_regex: /^.*((youtu.be)|(youtube.com))\\/((v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))?\\??v?=?([^#\\&\\?]*).*/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtube\\.com|youtu\\.be)\\/(?:watch\\?v=|embed\\/)?([0-9a-zA-Z_\\-]+)(.+)?/g,\r\n    url_text: 'https://www.youtube.com/embed/$1?$2',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}&wmode=opaque&rel=0\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'youtube'\r\n  },\r\n  {\r\n    test_regex: /^.*(?:vimeo.com)\\/(?:channels(\\/\\w+\\/)?|groups\\/*\\/videos\\/â€‹\\d+\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/(?:[^\\/]*)\\/videos\\/|album\\/(?:\\d+)\\/video\\/|video\\/|)(\\d+)(?:[a-zA-Z0-9_\\-]+)?(\\/[a-zA-Z0-9_\\-]+)?/i,\r\n    url_text: 'https://player.vimeo.com/video/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'vimeo'\r\n  },\r\n  {\r\n    test_regex: /^.+(dailymotion.com|dai.ly)\\/(video|hub)?\\/?([^_]+)[^#]*(#video=([^_&]+))?/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.)?(?:dailymotion\\.com|dai\\.ly)\\/(?:video|hub)?\\/?(.+)/g,\r\n    url_text: 'https://www.dailymotion.com/embed/video/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'dailymotion'\r\n  },\r\n  {\r\n    test_regex: /^.+(screen.yahoo.com)\\/[^_&]+/,\r\n    url_regex: '',\r\n    url_text: '',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}?format=embed\" frameborder=\"0\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\" allowtransparency=\"true\"></iframe>',\r\n    provider: 'yahoo'\r\n  },\r\n  {\r\n    test_regex: /^.+(rutube.ru)\\/[^_&]+/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.)?(?:rutube\\.ru)\\/(?:video)?\\/?(.+)/g,\r\n    url_text: 'https://rutube.ru/play/embed/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\" allowtransparency=\"true\"></iframe>',\r\n    provider: 'rutube'\r\n  },\r\n  {\r\n    test_regex: /^(?:.+)vidyard.com\\/(?:watch)?\\/?([^.&/]+)\\/?(?:[^_.&]+)?/,\r\n    url_regex: /^(?:.+)vidyard.com\\/(?:watch)?\\/?([^.&/]+)\\/?(?:[^_.&]+)?/g,\r\n    url_text: 'https://play.vidyard.com/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'vidyard'\r\n  }\r\n] \r\n\r\nFE.VIDEO_EMBED_REGEX = /^\\W*((<iframe(.|\\n)*>(\\s|\\n)*<\\/iframe>)|(<embed(.|\\n)*>))\\W*$/i \r\n\r\nFE.PLUGINS.video = function (editor) {\r\n  const { $ } = editor;\r\n  const DEFAULT_VIDEO_UPLOAD_URL = 'https://i.froala.com/upload'\r\n\r\n  let $overlay \r\n  let $handler \r\n  let $video_resizer \r\n  let $current_video \r\n\r\n  const BAD_LINK = 1 \r\n  const MISSING_LINK = 2 \r\n  const ERROR_DURING_UPLOAD = 3 \r\n  const BAD_RESPONSE = 4 \r\n  const MAX_SIZE_EXCEEDED = 5 \r\n  const BAD_FILE_TYPE = 6 \r\n  const NO_CORS_IE = 7 \r\n\r\n  const error_messages = {} \r\n  error_messages[BAD_LINK] = 'Video cannot be loaded from the passed link.',\r\n  error_messages[MISSING_LINK] = 'No link in upload response.',\r\n  error_messages[ERROR_DURING_UPLOAD] = 'Error during file upload.',\r\n  error_messages[BAD_RESPONSE] = 'Parsing response failed.',\r\n  error_messages[MAX_SIZE_EXCEEDED] = 'File is too large.',\r\n  error_messages[BAD_FILE_TYPE] = 'Video file type is invalid.',\r\n  error_messages[NO_CORS_IE] = 'Files can be uploaded only to same domain in IE 8 and IE 9.'\r\n\r\n  /**\r\n   * Refresh the video insert popup.\r\n   */\r\n  function _refreshInsertPopup() {\r\n    const $popup = editor.popups.get('video.insert') \r\n    const $url_input = $popup.find('.fr-video-by-url-layer input') \r\n    $url_input.val('').trigger('change') \r\n\r\n    let $embed_area = $popup.find('.fr-video-embed-layer textarea') \r\n    $embed_area.val('').trigger('change') \r\n\r\n    $embed_area = $popup.find('.fr-video-upload-layer input') \r\n    $embed_area.val('').trigger('change') \r\n  }\r\n\r\n  /**\r\n   * Show the video insert popup.\r\n   */\r\n  function showInsertPopup() {\r\n    const $btn = editor.$tb.find('.fr-command[data-cmd=\"insertVideo\"]') \r\n    let $popup = editor.popups.get('video.insert') \r\n\r\n    if (!$popup) $popup = _initInsertPopup() \r\n\r\n    hideProgressBar() \r\n\r\n    if (!$popup.hasClass('fr-active')) {\r\n      editor.popups.refresh('video.insert') \r\n      editor.popups.setContainer('video.insert', editor.$tb) \r\n\r\n      if ($btn.isVisible()) {\r\n        const { left, top } = editor.button.getPosition($btn)\r\n        editor.popups.show('video.insert', left, top, $btn.outerHeight()) \r\n      }\r\n      else {\r\n        editor.position.forSelection($popup) \r\n        editor.popups.show('video.insert') \r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the video edit popup.\r\n   */\r\n  function _showEditPopup() {\r\n    let $popup = editor.popups.get('video.edit') \r\n\r\n    if (!$popup) $popup = _initEditPopup() \r\n\r\n    if ($popup) {\r\n      editor.popups.setContainer('video.edit', editor.$sc) \r\n      editor.popups.refresh('video.edit') \r\n\r\n      const $video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`)\r\n      \r\n      const left = $video_obj.offset().left + $video_obj.outerWidth() / 2\r\n      const top = $video_obj.offset().top + $video_obj.outerHeight()\r\n      let iframeURL =  $video_obj.get(0).src ?  $video_obj.get(0).src : null\r\n      iframeURL = iframeURL.split('.')\r\n      iframeURL = iframeURL[iframeURL.length-1]\r\n      let isFile = (iframeURL.includes('pdf') || iframeURL.includes('txt')) ? true : false\r\n      if($video_obj.hasClass('fr-file') || isFile || $current_video.find(`audio`).get(0))\r\n      {        \r\n        if(document.getElementById(`autoplay-${editor.id}`))\r\n          document.getElementById(`autoplay-${editor.id}`).style.display = 'none'\r\n        if(document.getElementById(`videoReplace-${editor.id}`))\r\n          document.getElementById(`videoReplace-${editor.id}`).style.display = 'none'\r\n      } else{\r\n        document.getElementById(`autoplay-${editor.id}`).style.display = ''\r\n        document.getElementById(`videoReplace-${editor.id}`).style.display = ''\r\n      }\r\n      editor.popups.show('video.edit', left, top, $video_obj.outerHeight(), true) \r\n    }\r\n  }\r\n\r\n  function _initInsertPopup(delayed) {\r\n    if (delayed) {\r\n      editor.popups.onRefresh('video.insert', _refreshInsertPopup) \r\n      editor.popups.onHide('video.insert', _hideInsertPopup) \r\n\r\n      return true \r\n    }\r\n\r\n    // Video buttons.\r\n    let video_buttons = '' \r\n\r\n    if (!editor.opts.videoUpload  && editor.opts.videoInsertButtons.indexOf('videoUpload') !== -1) {\r\n      editor.opts.videoInsertButtons.splice(editor.opts.videoInsertButtons.indexOf('videoUpload'), 1) \r\n    }\r\n\r\n    const buttonList = editor.button.buildList(editor.opts.videoInsertButtons);\r\n\r\n    if (buttonList !== '') {\r\n      video_buttons = '<div class=\"fr-buttons\">' + buttonList + '</div>';\r\n    }\r\n\r\n    // Video by url layer.\r\n    let by_url_layer = '' \r\n\r\n    const uploadIndex = editor.opts.videoInsertButtons.indexOf('videoUpload') \r\n    const urlIndex = editor.opts.videoInsertButtons.indexOf('videoByURL') \r\n    const embedIndex = editor.opts.videoInsertButtons.indexOf('videoEmbed') \r\n\r\n    let active \r\n\r\n    if (urlIndex >= 0) {\r\n      active = ' fr-active' \r\n\r\n      if ((urlIndex > uploadIndex && uploadIndex >= 0) || (urlIndex > embedIndex && embedIndex >= 0)) {\r\n        active = ''\r\n      }\r\n      const checkmark = '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"10\" height=\"10\" viewBox=\"0 0 32 32\"><path d=\"M27 4l-15 15-7-7-5 5 12 12 20-20z\" fill=\"#FFF\"></path></svg>' \r\n\r\n      by_url_layer = `<div class=\"fr-video-by-url-layer fr-layer${active}\" id=\"fr-video-by-url-layer-${editor.id}\"><div class=\"fr-input-line\"><input id=\"fr-video-by-url-layer-text-${editor.id}\" type=\"text\" placeholder=\"${editor.language.translate('Paste in a video URL')}\" tabIndex=\"1\" aria-required=\"true\"></div><div class=\"fr-action-buttons\"><span style='float:left'><div class=\"fr-checkbox-line fr-autoplay-margin\"><span class=\"fr-checkbox\"> <input id='videoPluginAutoplay' data-checked=\"_blank\" type=\"checkbox\"> <span>${checkmark}</span></span> <label id=\"fr-label-target-${editor.id}\">Autoplay</label></div> </span><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"videoInsertByURL\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Insert')}</button></div></div>`\r\n    }\r\n\r\n    // Video embed layer.\r\n    let embed_layer = '' \r\n\r\n    if (embedIndex >= 0) {\r\n      active = ' fr-active' \r\n\r\n      if ((embedIndex > uploadIndex && uploadIndex >= 0) || (embedIndex > urlIndex && urlIndex >= 0)) {\r\n        active = ''\r\n      }\r\n\r\n      embed_layer = `<div class=\"fr-video-embed-layer fr-layer${active}\" id=\"fr-video-embed-layer-${editor.id}\"><div class=\"fr-input-line\"><textarea id=\"fr-video-embed-layer-text${editor.id}\" type=\"text\" placeholder=\"${editor.language.translate('Embedded Code')}\" tabIndex=\"1\" aria-required=\"true\" rows=\"5\"></textarea></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"videoInsertEmbed\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Insert')}</button></div></div>`\r\n    }\r\n\r\n    // Video upload layer.\r\n    let upload_layer = '' \r\n\r\n    if (uploadIndex >= 0) {\r\n      active = ' fr-active' \r\n\r\n      if ((uploadIndex > embedIndex && embedIndex >= 0) || (uploadIndex > urlIndex && urlIndex >= 0)) {\r\n        active = ''\r\n      }\r\n\r\n      upload_layer = `<div class=\"fr-video-upload-layer fr-layer${active}\" id=\"fr-video-upload-layer-${editor.id}\"><strong>${editor.language.translate('Drop video')}</strong><br>(${editor.language.translate('or click')})<div class=\"fr-form\"><input type=\"file\" accept=\"video/${editor.opts.videoAllowedTypes.join(', video/').toLowerCase()}\" tabIndex=\"-1\" aria-labelledby=\"fr-video-upload-layer-${editor.id}\" role=\"button\"></div></div>`\r\n    }\r\n\r\n    // Progress bar.\r\n    const progress_bar_layer = `<div class=\"fr-video-progress-bar-layer fr-layer\"><h3 tabIndex=\"-1\" class=\"fr-message\">Uploading</h3><div class=\"fr-loader\"><span class=\"fr-progress\"></span></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-dismiss\" data-cmd=\"videoDismissError\" tabIndex=\"2\" role=\"button\">OK</button></div></div>`\r\n\r\n\r\n    const template = {\r\n      buttons: video_buttons,\r\n      by_url_layer: by_url_layer,\r\n      embed_layer: embed_layer,\r\n      upload_layer: upload_layer,\r\n      progress_bar: progress_bar_layer\r\n    }\r\n\r\n    // Set the template in the popup.\r\n    const $popup = editor.popups.create('video.insert', template) \r\n\r\n    _bindInsertEvents($popup) \r\n\r\n    return $popup \r\n  }\r\n\r\n  /**\r\n   * Show the video upload layer.\r\n   */\r\n  function showLayer(name) {\r\n    const $popup = editor.popups.get('video.insert') \r\n\r\n    let left \r\n    let top \r\n\r\n    if (!$current_video && !editor.opts.toolbarInline) {\r\n      const $btn = editor.$tb.find('.fr-command[data-cmd=\"insertVideo\"]') \r\n      left = $btn.offset().left \r\n      top = $btn.offset().top + (editor.opts.toolbarBottom ? 10 : $btn.outerHeight() - 10) \r\n    }\r\n\r\n    if (editor.opts.toolbarInline) {\r\n\r\n      // Set top to the popup top.\r\n      top = $popup.offset().top - editor.helpers.getPX($popup.css('margin-top')) \r\n\r\n      // If the popup is above apply height correction.\r\n      if ($popup.hasClass('fr-above')) {\r\n        top += $popup.outerHeight() \r\n      }\r\n    }\r\n\r\n    // Show the new layer.\r\n    $popup.find('.fr-layer').removeClass('fr-active') \r\n    $popup.find(`.fr-${name}-layer`).addClass('fr-active') \r\n    editor.popups.show('video.insert', left, top, 0) \r\n    editor.accessibility.focusPopup($popup) \r\n  }\r\n\r\n  /**\r\n   * Refresh the insert by url button.\r\n   */\r\n  function refreshByURLButton($btn) {\r\n    const $popup = editor.popups.get('video.insert') \r\n    if ($popup && $popup.find('.fr-video-by-url-layer').hasClass('fr-active')) {\r\n      $btn.addClass('fr-active').attr('aria-pressed', true) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the insert embed button.\r\n   */\r\n  function refreshEmbedButton($btn) {\r\n    const $popup = editor.popups.get('video.insert') \r\n    if ($popup && $popup.find('.fr-video-embed-layer').hasClass('fr-active')) {\r\n      $btn.addClass('fr-active').attr('aria-pressed', true) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the insert upload button.\r\n   */\r\n  function refreshUploadButton($btn) {\r\n    const $popup = editor.popups.get('video.insert') \r\n    if ($popup && $popup.find('.fr-video-upload-layer').hasClass('fr-active')) {\r\n      $btn.addClass('fr-active').attr('aria-pressed', true) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Insert video embedded object.\r\n   */\r\n  function insert(embedded_code) {\r\n\r\n    // Make sure we have focus.\r\n    editor.events.focus(true) \r\n    editor.selection.restore() \r\n\r\n    // Flag to tell if the video is replaced.\r\n    let replaced = false \r\n\r\n    // If current video found we have to replace it.\r\n    if ($current_video) {\r\n\r\n      // Remove the old video.\r\n      remove() \r\n\r\n      // Mark that the video is replaced.\r\n      replaced = true \r\n    }\r\n\r\n    editor.html.insert(`<span contenteditable=\"false\" draggable=\"true\" class=\"fr-jiv fr-video fr-deletable\">${embedded_code}</span>`, false, editor.opts.videoSplitHTML) \r\n\r\n    editor.popups.hide('video.insert') \r\n\r\n    const $video = editor.$el.find('.fr-jiv') \r\n    $video.removeClass('fr-jiv') \r\n    $video.toggleClass('fr-rv', editor.opts.videoResponsive) \r\n\r\n    _setStyle($video, editor.opts.videoDefaultDisplay, editor.opts.videoDefaultAlign) \r\n\r\n    $video.toggleClass('fr-draggable', editor.opts.videoMove) \r\n\r\n    editor.events.trigger(replaced ? 'video.replaced' : 'video.inserted', [$video]) \r\n  }\r\n\r\n  function _loadedCallback() {\r\n    const $video = $(this) \r\n\r\n    editor.popups.hide('video.insert') \r\n\r\n    $video.removeClass('fr-uploading') \r\n\r\n    // Select the video.\r\n    if ($video.parent().next().is('br')) {\r\n      $video.parent().next().remove() \r\n    }\r\n\r\n    _editVideo($video.parent()) \r\n\r\n    editor.events.trigger('video.loaded', [$video.parent()]) \r\n  }\r\n\r\n  /**\r\n   * Insert html video into the editor.\r\n   */\r\n\r\n  function insertHtmlVideo(link, sanitize, data, $existing_video, response) {\r\n    editor.edit.off() \r\n    _setProgressMessage('Loading video') \r\n\r\n    if (sanitize) link = editor.helpers.sanitizeURL(link) \r\n\r\n    const _add = function () {\r\n      let $video \r\n      let attr \r\n\r\n      if ($existing_video) {\r\n        if (!editor.undo.canDo() && !$existing_video.find('video').hasClass('fr-uploading')) editor.undo.saveStep() \r\n\r\n        const old_src = $existing_video.find('video').data('fr-old-src') \r\n\r\n        const replaced = $existing_video.data('fr-replaced') \r\n        $existing_video.data('fr-replaced', false) \r\n\r\n        if (editor.$wp) {\r\n\r\n          // Clone existing video.\r\n          $video = $existing_video.clone(true) \r\n          $video.find('video').removeData('fr-old-src').removeClass('fr-uploading') \r\n\r\n          // Remove load event.\r\n          $video.find('video').off('canplay') \r\n\r\n          // Set new SRC.\r\n          if (old_src) $existing_video.find('video').attr('src', old_src) \r\n\r\n          // Replace existing video with its clone.\r\n          $existing_video.replaceWith($video) \r\n        }\r\n        else {\r\n          $video = $existing_video \r\n        }\r\n\r\n        // Remove old data.\r\n        const atts = $video.find('video').get(0).attributes \r\n\r\n        for (let i = 0; i < atts.length; i++) {\r\n          const att = atts[i] \r\n\r\n          if (att.nodeName.indexOf('data-') === 0) {\r\n            $video.find('video').removeAttr(att.nodeName) \r\n          }\r\n        }\r\n\r\n        // Set new data.\r\n        if (typeof data != 'undefined') {\r\n          for (attr in data) {\r\n            if (data.hasOwnProperty(attr)) {\r\n              if (attr != 'link') {\r\n                $video.find('video').attr(`data-${attr}`, data[attr]) \r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        $video.find('video').on('canplay', _loadedCallback) \r\n        $video.find('video').attr('src', link) \r\n        editor.edit.on() \r\n        _syncVideos() \r\n        editor.undo.saveStep() \r\n\r\n        // Cursor will not appear if we don't make blur.\r\n        editor.$el.blur() \r\n\r\n        editor.events.trigger(replaced ? 'video.replaced' : 'video.inserted', [$video, response]) \r\n      }\r\n      else {\r\n        $video = _addVideo(link, data, _loadedCallback) \r\n        _syncVideos() \r\n        editor.undo.saveStep() \r\n        editor.events.trigger('video.inserted', [$video, response]) \r\n      }\r\n    }\r\n\r\n    showProgressBar('Loading video') \r\n\r\n    _add() \r\n  }\r\n\r\n  /**\r\n   * Show progress bar.\r\n   */\r\n\r\n  function showProgressBar(no_message) {\r\n    let $popup = editor.popups.get('video.insert') \r\n\r\n    if (!$popup) $popup = _initInsertPopup() \r\n\r\n    $popup.find('.fr-layer.fr-active').removeClass('fr-active').addClass('fr-pactive') \r\n    $popup.find('.fr-video-progress-bar-layer').addClass('fr-active') \r\n    $popup.find('.fr-buttons').hide() \r\n\r\n    if ($current_video) {\r\n      const $current_video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`)\r\n      editor.popups.setContainer('video.insert', editor.$sc) \r\n      const left = $current_video_obj.offset().left\r\n      const top = $current_video_obj.offset().top + $current_video_obj.height()\r\n\r\n      editor.popups.show('video.insert', left, top, $current_video_obj.outerHeight()) \r\n    }\r\n\r\n    if (typeof no_message == 'undefined') {\r\n      _setProgressMessage(editor.language.translate('Uploading'), 0) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Hide progress bar.\r\n   */\r\n  function hideProgressBar(dismiss) {\r\n    const $popup = editor.popups.get('video.insert') \r\n\r\n    if ($popup) {\r\n      $popup.find('.fr-layer.fr-pactive').addClass('fr-active').removeClass('fr-pactive') \r\n      $popup.find('.fr-video-progress-bar-layer').removeClass('fr-active') \r\n      $popup.find('.fr-buttons').show() \r\n\r\n      // Dismiss error message.\r\n      if (dismiss || editor.$el.find('video.fr-error').length) {\r\n        editor.events.focus() \r\n\r\n        if (editor.$el.find('video.fr-error').length) {\r\n          editor.$el.find('video.fr-error').parent().remove() \r\n          editor.undo.saveStep() \r\n          editor.undo.run() \r\n          editor.undo.dropRedo() \r\n        }\r\n\r\n        if (!editor.$wp && $current_video) {\r\n          const $video = $current_video \r\n          _exitEdit(true) \r\n          editor.selection.setAfter($video.find('video').get(0)) \r\n          editor.selection.restore() \r\n        }\r\n        editor.popups.hide('video.insert') \r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set a progress message.\r\n   */\r\n\r\n  function _setProgressMessage(message, progress) {\r\n    const $popup = editor.popups.get('video.insert') \r\n\r\n    if ($popup) {\r\n      const $layer = $popup.find('.fr-video-progress-bar-layer') \r\n      $layer.find('h3').text(message + (progress ? ` ${progress}%` : '')) \r\n\r\n      $layer.removeClass('fr-error') \r\n\r\n      if (progress) {\r\n        $layer.find('div').removeClass('fr-indeterminate') \r\n        $layer.find('div > span').css('width', `${progress}%`) \r\n      }\r\n      else {\r\n        $layer.find('div').addClass('fr-indeterminate') \r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show error message to the user.\r\n   */\r\n\r\n  function _showErrorMessage(message) {\r\n    showProgressBar() \r\n    const $popup = editor.popups.get('video.insert') \r\n    const $layer = $popup.find('.fr-video-progress-bar-layer') \r\n    $layer.addClass('fr-error') \r\n    const $message_header = $layer.find('h3') \r\n    $message_header.text(message) \r\n    editor.events.disableBlur() \r\n    $message_header.focus() \r\n  }\r\n\r\n  /**\r\n   * Insert video by URL.\r\n   */\r\n  function insertByURL(link) {   \r\n    let autoPlayFlag = document.getElementById('videoPluginAutoplay') ? document.getElementById('videoPluginAutoplay').checked : false\r\n    if (typeof link == 'undefined') {\r\n      const $popup = editor.popups.get('video.insert') \r\n      link = ($popup.find('.fr-video-by-url-layer input[type=\"text\"]').val() || '').trim() \r\n    }\r\n\r\n    let video = null \r\n\r\n    if (!/^http/.test(link)) {\r\n      link = `https://${link}` \r\n    }\r\n\r\n    if (editor.helpers.isURL(link)) {\r\n      for (let i = 0; i < FE.VIDEO_PROVIDERS.length; i++) {\r\n        let vp = FE.VIDEO_PROVIDERS[i] \r\n        const addAutoplay = \"autoplay=1\";\r\n        if (vp.html.includes('autoplay=1') && (document.getElementById('videoPluginAutoplay').checked)){\r\n          vp.html=vp.html\r\n          document.getElementById('videoPluginAutoplay').checked=false       \r\n        }\r\n       else if(autoPlayFlag){\r\n          let indexofAutoplay=vp.html.indexOf('{url}') + 5\r\n           vp.html = [vp.html.slice(0, indexofAutoplay), addAutoplay, vp.html.slice(indexofAutoplay)].join('');        \r\n            autoPlayFlag=false\r\n           document.getElementById('videoPluginAutoplay').checked=false\r\n          }\r\n          else{\r\n            vp = FE.VIDEO_PROVIDERS[i] \r\n            vp.html= vp.html.replace(addAutoplay,'')\r\n          }\r\n        // Check if video provider is allowed.\r\n        if (vp.test_regex.test(link) && (new RegExp(editor.opts.videoAllowedProviders.join('|'))).test(vp.provider)) {\r\n          video = link.replace(vp.url_regex, vp.url_text) \r\n          video = vp.html.replace(/\\{url\\}/, video) \r\n          break \r\n        }\r\n      }\r\n    }\r\n\r\n    if (video) {\r\n      insert(video) \r\n    }\r\n    else {\r\n      _showErrorMessage(editor.language.translate('Something went wrong. Please try again.'));\r\n      editor.events.trigger('video.linkError', [link]) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Insert embedded video.\r\n   */\r\n  function insertEmbed(code) {\r\n    if (typeof code == 'undefined') {\r\n      const $popup = editor.popups.get('video.insert') \r\n      code = $popup.find('.fr-video-embed-layer textarea').val() || '' \r\n    }\r\n\r\n    if (code.length === 0 || !FE.VIDEO_EMBED_REGEX.test(code)) {\r\n      _showErrorMessage(editor.language.translate('Something went wrong. Please try again.'));\r\n      editor.events.trigger('video.codeError', [code]) \r\n    }\r\n    else {\r\n      insert(code) \r\n    }\r\n  }\r\n\r\n  function _editVideo($video) {\r\n    _edit.call($video.get(0)) \r\n  }\r\n\r\n  /**\r\n   * Parse video response.\r\n   */\r\n\r\n  function _parseResponse(response) {\r\n    try {\r\n      if (editor.events.trigger('video.uploaded', [response], true) === false) {\r\n        editor.edit.on() \r\n\r\n        return false \r\n      }\r\n\r\n      const resp = JSON.parse(response) \r\n\r\n      if (resp.link) {\r\n\r\n        return resp \r\n      }\r\n      else {\r\n\r\n        // No link in upload request.\r\n        _throwError(MISSING_LINK, response) \r\n\r\n        return false \r\n      }\r\n    }\r\n    catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response) \r\n\r\n      return false \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Parse video response.\r\n   */\r\n\r\n  function _parseXMLResponse(response) {\r\n    try {\r\n      const link = $(response).find('Location').text() \r\n      const key = $(response).find('Key').text() \r\n\r\n      if (editor.events.trigger('video.uploadedToS3', [link, key, response], true) === false) {\r\n        editor.edit.on() \r\n\r\n        return false \r\n      }\r\n\r\n      return link \r\n    }\r\n    catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response) \r\n\r\n      return false \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Video was uploaded to the server and we have a response.\r\n   */\r\n\r\n  function _videoUploaded($video, url, key) {\r\n    _setProgressMessage('Loading video') \r\n\r\n    const { status } = this\r\n    const { response } = this \r\n    const { responseXML } = this \r\n    const { responseText } = this \r\n\r\n    try {\r\n      if (editor.opts.videoUploadToS3 || editor.opts.videoUploadToAzure) {\r\n        if (status == 201) {\r\n          let link\r\n          if(editor.opts.videoUploadToAzure) {\r\n            if (editor.events.trigger('video.uploadedToAzure', [this.responseURL, key, response], true) === false) {\r\n              editor.edit.on()\r\n              return false\r\n            }\r\n            link = url\r\n          } else {\r\n            link = _parseXMLResponse(responseXML)\r\n          } \r\n\r\n          if (link) {\r\n            insertHtmlVideo(link, false, [], $video, response || responseXML) \r\n          }\r\n        }\r\n        else {\r\n          _throwError(BAD_RESPONSE, response || responseXML) \r\n        }\r\n      }\r\n      else {\r\n        if (status >= 200 && status < 300) {\r\n          const resp = _parseResponse(responseText) \r\n\r\n          if (resp) {\r\n            insertHtmlVideo(resp.link, false, resp, $video, response || responseText) \r\n          }\r\n        }\r\n        else {\r\n          _throwError(ERROR_DURING_UPLOAD, response || responseText) \r\n        }\r\n      }\r\n    }\r\n    catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response || responseText) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Video upload error.\r\n   */\r\n\r\n  function _videoUploadError() {\r\n    _throwError(BAD_RESPONSE, this.response || this.responseText || this.responseXML) \r\n  }\r\n\r\n  /**\r\n   * Video upload progress.\r\n   */\r\n\r\n  function _videoUploadProgress(e) {\r\n    if (e.lengthComputable) {\r\n      const complete = (e.loaded / e.total * 100 | 0) \r\n      _setProgressMessage(editor.language.translate('Uploading'), complete) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Video upload aborted.\r\n   */\r\n  function _videoUploadAborted() {\r\n    editor.edit.on() \r\n    hideProgressBar(true) \r\n  }\r\n\r\n  function _addVideo(link, data, loadCallback) {\r\n\r\n    // Build video data string.\r\n    let data_str = '' \r\n    let attr \r\n\r\n    if (data && typeof data != 'undefined') {\r\n      for (attr in data) {\r\n        if (data.hasOwnProperty(attr)) {\r\n          if (attr != 'link') {\r\n            data_str += ` data-${attr}=\"${data[attr]}\"`\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    let { videoDefaultWidth : width } = editor.opts \r\n\r\n    if (width && width != 'auto') {\r\n      width = `${width}px` \r\n    }\r\n\r\n    // Create video object and set the load event.\r\n    const $video = $(document.createElement('span')).attr('contenteditable', 'false').attr('draggable', 'true').attr('class', 'fr-video fr-dv' + (editor.opts.videoDefaultDisplay[0]) + (editor.opts.videoDefaultAlign != 'center' ? ' fr-fv' + editor.opts.videoDefaultAlign[0] : '')).html('<video src=\"' + link + '\" ' + data_str + (width ? ' style=\"width: ' + width + ';\" ' : '') + ' controls>' + editor.language.translate('Your browser does not support HTML5 video.') + '</video>')\r\n    $video.toggleClass('fr-draggable', editor.opts.videoMove) \r\n\r\n    // Make sure we have focus.\r\n    // Call the event.\r\n    editor.edit.on() \r\n    editor.events.focus(true) \r\n    editor.selection.restore() \r\n\r\n    editor.undo.saveStep() \r\n\r\n    // Insert marker and then replace it with the video.\r\n    if (editor.opts.videoSplitHTML) {\r\n      editor.markers.split() \r\n    }\r\n    else {\r\n      editor.markers.insert() \r\n    }\r\n\r\n    editor.html.wrap() \r\n    const $marker = editor.$el.find('.fr-marker') \r\n\r\n    // Do not insert video inside emoticon.\r\n    if (editor.node.isLastSibling($marker) && $marker.parent().hasClass('fr-deletable')) {\r\n\r\n      $marker.insertAfter($marker.parent()) \r\n    }\r\n\r\n    $marker.replaceWith($video) \r\n\r\n    editor.selection.clear() \r\n\r\n    if ($video.find('video').get(0).readyState > $video.find('video').get(0).HAVE_FUTURE_DATA || editor.helpers.isIOS()) {\r\n      loadCallback.call($video.find('video').get(0)) \r\n    }\r\n    else {\r\n      $video.find('video').on('canplaythrough load', loadCallback) \r\n    }\r\n\r\n    return $video \r\n  }\r\n\r\n  /**\r\n   * Mouse down to start resize.\r\n   */\r\n  function _handlerMousedown(e) {\r\n\r\n    // Check if resizer belongs to current instance.\r\n    if (!editor.core.sameInstance($video_resizer)) return true \r\n\r\n    e.preventDefault() \r\n    e.stopPropagation() \r\n\r\n    let c_x = e.pageX || (e.originalEvent.touches ? e.originalEvent.touches[0].pageX : null) \r\n    let c_y = e.pageY || (e.originalEvent.touches ? e.originalEvent.touches[0].pageY : null) \r\n\r\n    if (!c_x || !c_y) {\r\n\r\n      return false \r\n    }\r\n\r\n    // Only on mousedown. This function could be called from keydown on accessibility.\r\n    if (e.type == 'mousedown') {\r\n\r\n      // See if the entire editor is inside iframe to adjust starting offsets.\r\n      const oel = editor.$oel.get(0) \r\n      const { ownerDocument : doc } = oel \r\n      const win = doc.defaultView || doc.parentWindow \r\n      let editor_inside_iframe = false \r\n\r\n      try {\r\n        editor_inside_iframe = (win.location != win.parent.location && !(win.$ && win.$.FE)) \r\n      }\r\n      catch (ex) {\r\n      }\r\n\r\n      if (editor_inside_iframe && win.frameElement) {\r\n        c_x += editor.helpers.getPX($(win.frameElement).offset().left) + win.frameElement.clientLeft \r\n\r\n        // Override c_y with clientY attribute.\r\n        c_y = e.clientY + editor.helpers.getPX($(win.frameElement).offset().top) + win.frameElement.clientTop \r\n      }\r\n    }\r\n\r\n    if (!editor.undo.canDo()) editor.undo.saveStep() \r\n\r\n    $handler = $(this) \r\n    $handler.data('start-x', c_x) \r\n    $handler.data('start-y', c_y) \r\n    $overlay.show() \r\n    editor.popups.hideAll() \r\n\r\n    _unmarkExit() \r\n  }\r\n\r\n  /**\r\n   * Do resize.\r\n   */\r\n  function _handlerMousemove(e) {\r\n\r\n    // Check if resizer belongs to current instance.\r\n    if (!editor.core.sameInstance($video_resizer)) return true \r\n\r\n    if ($handler) {\r\n      e.preventDefault()\r\n\r\n      const c_x = e.pageX || (e.originalEvent.touches ? e.originalEvent.touches[0].pageX : null) \r\n      const c_y = e.pageY || (e.originalEvent.touches ? e.originalEvent.touches[0].pageY : null) \r\n\r\n      if (!c_x || !c_y) {\r\n\r\n        return false \r\n      }\r\n\r\n      const s_x = $handler.data('start-x') \r\n      const s_y = $handler.data('start-y') \r\n\r\n      $handler.data('start-x', c_x) \r\n      $handler.data('start-y', c_y) \r\n\r\n      let diff_x = c_x - s_x \r\n      let diff_y = c_y - s_y \r\n\r\n      const $video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`)\r\n      \r\n      const width = $video_obj.width() \r\n      const height = $video_obj.height() \r\n\r\n      if ($handler.hasClass('fr-hnw') || $handler.hasClass('fr-hsw')) {\r\n        diff_x = 0 - diff_x \r\n      }\r\n\r\n      if ($handler.hasClass('fr-hnw') || $handler.hasClass('fr-hne')) {\r\n        diff_y = 0 - diff_y \r\n      }\r\n\r\n      $video_obj.css('width', width + diff_x) \r\n      $video_obj.css('height', height + diff_y) \r\n      $video_obj.removeAttr('width') \r\n      $video_obj.removeAttr('height') \r\n\r\n      _repositionResizer() \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Stop resize.\r\n   */\r\n  function _handlerMouseup(e) {\r\n\r\n    // Check if resizer belongs to current instance.\r\n    if (!editor.core.sameInstance($video_resizer)) return true \r\n\r\n    if ($handler && $current_video) {\r\n      if (e) e.stopPropagation() \r\n      $handler = null \r\n      $overlay.hide() \r\n      _repositionResizer() \r\n      _showEditPopup() \r\n\r\n      editor.undo.saveStep() \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create resize handler.\r\n   */\r\n  function _getHandler(pos) {\r\n\r\n    return `<div class=\"fr-handler fr-h${pos}\"></div>` \r\n  }\r\n\r\n  function _resizeVideo(e, initPageX, direction, step) {\r\n    e.pageX = initPageX \r\n    e.pageY = initPageX \r\n    _handlerMousedown.call(this, e) \r\n    e.pageX = e.pageX + direction * Math.floor(Math.pow(1.1, step)) \r\n    e.pageY = e.pageY + direction * Math.floor(Math.pow(1.1, step)) \r\n    _handlerMousemove.call(this, e) \r\n    _handlerMouseup.call(this, e) \r\n\r\n    return ++step \r\n  }\r\n\r\n  /**\r\n   * Init video resizer.\r\n   */\r\n  function _initResizer() {\r\n    let doc \r\n\r\n    // No shared video resizer.\r\n    if (!editor.shared.$video_resizer) {\r\n\r\n      // Create shared video resizer.\r\n      editor.shared.$video_resizer = $(document.createElement('div')).attr('class', 'fr-video-resizer')\r\n      $video_resizer = editor.shared.$video_resizer \r\n\r\n      // Bind mousedown event shared.\r\n      editor.events.$on($video_resizer, 'mousedown', function (e) {\r\n        e.stopPropagation() \r\n      }, true) \r\n\r\n      // video resize is enabled.\r\n      if (editor.opts.videoResize) {\r\n        $video_resizer.append(_getHandler('nw') + _getHandler('ne') + _getHandler('sw') + _getHandler('se')) \r\n\r\n        // Add video resizer overlay and set it.\r\n        editor.shared.$vid_overlay = $(document.createElement('div')).attr('class', 'fr-video-overlay')\r\n        $overlay = editor.shared.$vid_overlay \r\n        doc = $video_resizer.get(0).ownerDocument \r\n        $(doc).find('body').first().append($overlay) \r\n      }\r\n    }\r\n    else {\r\n      $video_resizer = editor.shared.$video_resizer \r\n      $overlay = editor.shared.$vid_overlay \r\n\r\n      editor.events.on('destroy', function () {\r\n        $('body').first().append($video_resizer.removeClass('fr-active'))\r\n      }, true) \r\n    }\r\n\r\n    // Shared destroy.\r\n    editor.events.on('shared.destroy', function () {\r\n      $video_resizer.html('').removeData().remove() \r\n      $video_resizer = null \r\n\r\n      if (editor.opts.videoResize) {\r\n        $overlay.remove() \r\n        $overlay = null \r\n      }\r\n    }, true) \r\n\r\n    // Window resize. Exit from edit.\r\n    if (!editor.helpers.isMobile()) {\r\n      editor.events.$on($(editor.o_win), 'resize.video', function () {\r\n        _exitEdit(true) \r\n      }) \r\n    }\r\n\r\n    // video resize is enabled.\r\n    if (editor.opts.videoResize) {\r\n      doc = $video_resizer.get(0).ownerDocument \r\n\r\n      editor.events.$on($video_resizer, editor._mousedown, '.fr-handler', _handlerMousedown) \r\n      editor.events.$on($(doc), editor._mousemove, _handlerMousemove) \r\n      editor.events.$on($(doc.defaultView || doc.parentWindow), editor._mouseup, _handlerMouseup) \r\n\r\n      editor.events.$on($overlay, 'mouseleave', _handlerMouseup) \r\n\r\n\r\n      // Accessibility.\r\n\r\n      // Used for keys holing.\r\n      let step = 1 \r\n      let prevKey = null \r\n      let prevTimestamp = 0 \r\n\r\n      // Keydown event.\r\n      editor.events.on('keydown', function (e) {\r\n        if ($current_video) {\r\n          const ctrlKey = navigator.userAgent.indexOf('Mac OS X') != -1 ? e.metaKey : e.ctrlKey \r\n          const keycode = e.which \r\n\r\n          if (keycode !== prevKey || e.timeStamp - prevTimestamp > 200) {\r\n            step = 1 \r\n\r\n            // Reset step. Known browser issue: Keyup does not trigger when ctrl is pressed.\r\n          }\r\n\r\n          // Increase video size.\r\n          if ((keycode == FE.KEYCODE.EQUALS || (editor.browser.mozilla && keycode == FE.KEYCODE.FF_EQUALS)) && ctrlKey && !e.altKey) {\r\n            step = _resizeVideo.call(this, e, 1, 1, step) \r\n          }\r\n\r\n          // Decrease video size.\r\n          else if ((keycode == FE.KEYCODE.HYPHEN || (editor.browser.mozilla && keycode == FE.KEYCODE.FF_HYPHEN)) && ctrlKey && !e.altKey) {\r\n            step = _resizeVideo.call(this, e, 2, -1, step) \r\n          }\r\n\r\n          // Save key code.\r\n          prevKey = keycode \r\n\r\n          // Save timestamp.\r\n          prevTimestamp = e.timeStamp \r\n        }\r\n      }) \r\n\r\n      // Reset the step on key up event.\r\n      editor.events.on('keyup', function () {\r\n        step = 1 \r\n      }) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Keep videos in sync when content changed.\r\n   */\r\n  let videos \r\n\r\n  function _syncVideos() {\r\n\r\n    // Get current videos.\r\n    const c_videos = Array.prototype.slice.call(editor.el.querySelectorAll('video, .fr-video > *')) \r\n\r\n    // Current videos src.\r\n    const video_srcs = [] \r\n    let i \r\n\r\n    for (i = 0; i < c_videos.length; i++) {\r\n      video_srcs.push(c_videos[i].getAttribute('src')) \r\n\r\n      $(c_videos[i]).toggleClass('fr-draggable', editor.opts.videoMove) \r\n\r\n      if (c_videos[i].getAttribute('class') === '') c_videos[i].removeAttribute('class') \r\n\r\n      if (c_videos[i].getAttribute('style') === '') c_videos[i].removeAttribute('style') \r\n    }\r\n\r\n    // Loop previous videos and check their src.\r\n    if (videos) {\r\n      for (i = 0; i < videos.length; i++) {\r\n        if (video_srcs.indexOf(videos[i].getAttribute('src')) < 0) {\r\n          editor.events.trigger('video.removed', [$(videos[i])]) \r\n        }\r\n      }\r\n    }\r\n\r\n    // Current videos are the old ones.\r\n    videos = c_videos \r\n  }\r\n\r\n  /**\r\n   * Reposition resizer.\r\n   */\r\n  function _repositionResizer() {\r\n    if (!$video_resizer) _initResizer(); \r\n\r\n    (editor.$wp || editor.$sc).append($video_resizer) \r\n    $video_resizer.data('instance', editor) \r\n    const $video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`) \r\n   \r\n\r\n    let iframePaddingLeft = 0\r\n    let iframePaddingTop = 0\r\n    if (editor.opts.iframe) {\r\n      iframePaddingTop = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-top'))\r\n      iframePaddingLeft = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-left'))\r\n    }\r\n\r\n    $video_resizer\r\n      .css('top', (editor.opts.iframe ? $video_obj.offset().top + iframePaddingTop - 1 : $video_obj.offset().top - editor.$wp.offset().top - 1) + editor.$wp.scrollTop())\r\n      .css('left', (editor.opts.iframe ? $video_obj.offset().left + iframePaddingLeft - 1 : $video_obj.offset().left - editor.$wp.offset().left - 1) + editor.$wp.scrollLeft())\r\n      .css('width', $video_obj.get(0).getBoundingClientRect().width)\r\n      .css('height', $video_obj.get(0).getBoundingClientRect().height)\r\n      .addClass('fr-active') \r\n  }\r\n\r\n  /**\r\n   * Edit video.\r\n   */\r\n  let touchScroll \r\n\r\n  function _edit(e) {\r\n    if (e && e.type == 'touchend' && touchScroll) {\r\n\r\n      return true \r\n    }\r\n\r\n    if (e && editor.edit.isDisabled()) {\r\n      e.stopPropagation() \r\n      e.preventDefault() \r\n\r\n      return false \r\n    }\r\n\r\n    if (editor.edit.isDisabled()) {\r\n\r\n      return false \r\n    }\r\n\r\n    // Hide resizer for other instances.\r\n    for (let i = 0; i < FE.INSTANCES.length; i++) {\r\n      if (FE.INSTANCES[i] != editor) {\r\n        FE.INSTANCES[i].events.trigger('video.hideResizer') \r\n      }\r\n    }\r\n\r\n    editor.toolbar.disable() \r\n\r\n    // Hide keyboard.\r\n    if (editor.helpers.isMobile()) {\r\n      editor.events.disableBlur() \r\n      editor.$el.blur() \r\n      editor.events.enableBlur() \r\n    }\r\n\r\n    // Unselect all other videos.\r\n    editor.$el.find('.fr-video.fr-active').removeClass('fr-active') \r\n\r\n    $current_video = $(this) \r\n    $current_video.addClass('fr-active') \r\n\r\n    if (editor.opts.iframe) {\r\n      editor.size.syncIframe() \r\n    }\r\n\r\n    _selectVideo()\r\n    _repositionResizer() \r\n    _showEditPopup() \r\n\r\n    editor.selection.clear() \r\n    editor.button.bulkRefresh() \r\n\r\n    editor.events.trigger('image.hideResizer') \r\n  }\r\n\r\n  /**\r\n   * Exit edit.\r\n   */\r\n  function _exitEdit(force_exit) {\r\n    if ($current_video && (_canExit() || force_exit === true)) {\r\n      $video_resizer.removeClass('fr-active') \r\n\r\n      editor.toolbar.enable() \r\n\r\n      $current_video.removeClass('fr-active') \r\n      $current_video = null \r\n\r\n      _unmarkExit() \r\n    }\r\n  }\r\n\r\n  editor.shared.vid_exit_flag = false \r\n\r\n  function _markExit() {\r\n    editor.shared.vid_exit_flag = true \r\n  }\r\n\r\n  function _unmarkExit() {\r\n    editor.shared.vid_exit_flag = false \r\n  }\r\n\r\n  function _canExit() {\r\n\r\n    return editor.shared.vid_exit_flag \r\n  }\r\n\r\n  function _drop(e) {\r\n\r\n    // Check if we are dropping files.\r\n    const { dataTransfer : dt } = e.originalEvent \r\n\r\n    if (dt && dt.files && dt.files.length) {\r\n      const vid = dt.files[0] \r\n\r\n      if (vid && vid.type && vid.type.indexOf('video') !== -1) {\r\n        if (!editor.opts.videoUpload) {\r\n          e.preventDefault() \r\n          e.stopPropagation() \r\n\r\n          return false \r\n        }\r\n\r\n\r\n        editor.markers.remove() \r\n        editor.markers.insertAtPoint(e.originalEvent) \r\n        editor.$el.find('.fr-marker').replaceWith(FE.MARKERS) \r\n\r\n        // Hide popups.\r\n        editor.popups.hideAll() \r\n\r\n        // Show the video insert popup.\r\n        let $popup = editor.popups.get('video.insert') \r\n\r\n        if (!$popup) $popup = _initInsertPopup() \r\n        editor.popups.setContainer('video.insert', editor.$sc) \r\n        editor.popups.show('video.insert', e.originalEvent.pageX, e.originalEvent.pageY) \r\n        showProgressBar() \r\n\r\n        // Dropped file is an video that we allow.\r\n        if (editor.opts.videoAllowedTypes.indexOf(vid.type.replace(/video\\//g, '')) >= 0) {\r\n\r\n          // Upload videos.\r\n          upload(dt.files) \r\n        }\r\n        else {\r\n          _throwError(BAD_FILE_TYPE) \r\n        }\r\n\r\n        // Cancel anything else.\r\n        e.preventDefault() \r\n        e.stopPropagation() \r\n\r\n        return false \r\n      }\r\n    }\r\n  }\r\n\r\n  function _browserUpload(video) {\r\n\r\n    // if current video is embedded video,remove it.\r\n    if ($current_video && $current_video.find('iframe') && $current_video.find('iframe').length) {\r\n      remove() \r\n    }\r\n    const reader = new FileReader() \r\n\r\n    reader.onload = function () {\r\n      let { result : link } = reader \r\n\r\n      // Convert image to local blob.\r\n      const binary = atob(reader.result.split(',')[1]) \r\n      const array = [] \r\n\r\n      for (let i = 0; i < binary.length; i++) {\r\n        array.push(binary.charCodeAt(i)) \r\n      }\r\n\r\n      // Get local image link.\r\n      link = window.URL.createObjectURL(new Blob([new Uint8Array(array)], {\r\n        type: video.type\r\n      })) \r\n\r\n      insertHtmlVideo(link, false, null, $current_video) \r\n    } \r\n\r\n    showProgressBar() \r\n\r\n    reader.readAsDataURL(video)\r\n  }\r\n\r\n  /**\r\n   * Do video upload.\r\n   */\r\n  function upload(videos) {\r\n\r\n    // Make sure we have what to upload.\r\n    if (typeof videos != 'undefined' && videos.length > 0) {\r\n\r\n      // Check if we should cancel the video upload.\r\n      if (editor.events.trigger('video.beforeUpload', [videos]) === false) {\r\n\r\n        return false \r\n      }\r\n\r\n      const video = videos[0] \r\n\r\n      // Upload as blob for testing purposes.\r\n      if ((editor.opts.videoUploadURL === null || editor.opts.videoUploadURL == DEFAULT_VIDEO_UPLOAD_URL) && !editor.opts.videoUploadToS3 && !editor.opts.videoUploadToAzure) {\r\n        _browserUpload(video)\r\n\r\n        return false \r\n      }\r\n\r\n      // Check video max size.\r\n      if (video.size > editor.opts.videoMaxSize) {\r\n        _throwError(MAX_SIZE_EXCEEDED) \r\n\r\n        return false \r\n      }\r\n\r\n      // Check video types.\r\n      if (editor.opts.videoAllowedTypes.indexOf(video.type.replace(/video\\//g, '')) < 0) {\r\n        _throwError(BAD_FILE_TYPE) \r\n\r\n        return false \r\n      }\r\n\r\n      // Create form Data.\r\n      let form_data \r\n\r\n      if (editor.drag_support.formdata) {\r\n        form_data = editor.drag_support.formdata ? new FormData() : null \r\n      }\r\n\r\n      // Prepare form data for request.\r\n      if (form_data) {\r\n        let key \r\n\r\n        // Upload to S3.\r\n        if (editor.opts.videoUploadToS3 !== false) {\r\n          form_data.append('key', editor.opts.videoUploadToS3.keyStart + (new Date()).getTime() + '-' + (video.name || 'untitled')) \r\n          form_data.append('success_action_status', '201') \r\n          form_data.append('X-Requested-With', 'xhr') \r\n          form_data.append('Content-Type', video.type) \r\n\r\n          for (key in editor.opts.videoUploadToS3.params) {\r\n            if (editor.opts.videoUploadToS3.params.hasOwnProperty(key)) {\r\n              form_data.append(key, editor.opts.videoUploadToS3.params[key]) \r\n            }\r\n          }\r\n        }\r\n\r\n        // Add upload params.\r\n        for (key in editor.opts.videoUploadParams) {\r\n          if (editor.opts.videoUploadParams.hasOwnProperty(key)) {\r\n            form_data.append(key, editor.opts.videoUploadParams[key]) \r\n          }\r\n        }\r\n\r\n        // Set the video in the request.\r\n        form_data.append(editor.opts.videoUploadParam, video) \r\n\r\n        // Create XHR request.\r\n        let { videoUploadURL : url } = editor.opts \r\n\r\n        if (editor.opts.videoUploadToS3) {\r\n          if (editor.opts.videoUploadToS3.uploadURL) {\r\n            ({ uploadURL : url } = editor.opts.videoUploadToS3 );\r\n          }\r\n          else {\r\n            url = `https://${editor.opts.videoUploadToS3.region}.amazonaws.com/${editor.opts.videoUploadToS3.bucket}` \r\n          }\r\n        }\r\n        let videoURL\r\n        let azureKey\r\n        let videoUploadMethod = editor.opts.videoUploadMethod\r\n        if (editor.opts.videoUploadToAzure) {\r\n          if (editor.opts.videoUploadToAzure.uploadURL) {\r\n            url = `${editor.opts.videoUploadToAzure.uploadURL}/${video.name}`\r\n          } else {\r\n            url = encodeURI(`https://${editor.opts.videoUploadToAzure.account}.blob.core.windows.net/${editor.opts.videoUploadToAzure.container}/${video.name}`)\r\n          }\r\n          videoURL = url\r\n          if (editor.opts.videoUploadToAzure.SASToken) {\r\n            url +=  editor.opts.videoUploadToAzure.SASToken\r\n          }\r\n          videoUploadMethod = 'PUT'\r\n        }\r\n\r\n        const xhr = editor.core.getXHR(url, videoUploadMethod) \r\n\r\n        if (editor.opts.videoUploadToAzure) {\r\n          let uploadDate = new Date().toUTCString()\r\n          if (!editor.opts.videoUploadToAzure.SASToken && editor.opts.videoUploadToAzure.accessKey) {\r\n            let azureAccount = editor.opts.videoUploadToAzure.account\r\n            let azureContainer = editor.opts.videoUploadToAzure.container\r\n            if(editor.opts.videoUploadToAzure.uploadURL) {\r\n              let urls = editor.opts.videoUploadToAzure.uploadURL.split('/')\r\n              azureContainer = urls.pop()\r\n              azureAccount = urls.pop().split('.')[0]\r\n            }\r\n            let headerResource = `x-ms-blob-type:BlockBlob\\nx-ms-date:${uploadDate}\\nx-ms-version:2019-07-07`\r\n            let urlResource = encodeURI('/' + azureAccount + '/' + azureContainer + '/' + video.name)\r\n            let stringToSign = videoUploadMethod + '\\n\\n\\n' + video.size + '\\n\\n' + video.type + '\\n\\n\\n\\n\\n\\n\\n' + headerResource + '\\n' + urlResource\r\n            let signatureBytes = editor.cryptoJSPlugin.cryptoJS.HmacSHA256(stringToSign, editor.cryptoJSPlugin.cryptoJS.enc.Base64.parse(editor.opts.videoUploadToAzure.accessKey))\r\n            let signature = signatureBytes.toString(editor.cryptoJSPlugin.cryptoJS.enc.Base64)\r\n            let authHeader = 'SharedKey ' + azureAccount + ':' + signature\r\n            azureKey = signature\r\n            xhr.setRequestHeader(\"Authorization\", authHeader)\r\n          }\r\n          xhr.setRequestHeader(\"x-ms-version\", \"2019-07-07\")\r\n          xhr.setRequestHeader(\"x-ms-date\", uploadDate)\r\n          xhr.setRequestHeader(\"Content-Type\", video.type)\r\n          xhr.setRequestHeader(\"x-ms-blob-type\", \"BlockBlob\")\r\n          for (key in editor.opts.videoUploadParams) {\r\n            if (editor.opts.videoUploadParams.hasOwnProperty(key)) {\r\n              xhr.setRequestHeader(key, editor.opts.videoUploadParams[key])\r\n            }\r\n          }\r\n          for (key in editor.opts.videoUploadToAzure.params) {\r\n            if (editor.opts.videoUploadToAzure.params.hasOwnProperty(key)) {\r\n              xhr.setRequestHeader(key, editor.opts.videoUploadToAzure.params[key])\r\n            }\r\n          }\r\n        }\r\n        // Set upload events.\r\n        xhr.onload = function () {\r\n          _videoUploaded.call(xhr, $current_video, videoURL, azureKey) \r\n        } \r\n        xhr.onerror = _videoUploadError \r\n        xhr.upload.onprogress = _videoUploadProgress \r\n        xhr.onabort = _videoUploadAborted \r\n\r\n        showProgressBar() \r\n        editor.events.disableBlur() \r\n        editor.edit.off() \r\n        editor.events.enableBlur() \r\n\r\n        const $popup = editor.popups.get('video.insert') \r\n\r\n        if ($popup) {\r\n          $($popup.off('abortUpload')).on('abortUpload', function () {\r\n            if (xhr.readyState != 4) {\r\n              xhr.abort() \r\n            }\r\n          })\r\n        }\r\n\r\n        // Send data.\r\n        xhr.send(editor.opts.videoUploadToAzure ? video : form_data)\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Video drop inside the upload zone.\r\n   */\r\n\r\n  function _bindInsertEvents($popup) {\r\n\r\n    // Drag over the dropable area.\r\n    editor.events.$on($popup, 'dragover dragenter', '.fr-video-upload-layer', function () {\r\n      $(this).addClass('fr-drop') \r\n\r\n      return false \r\n    }, true) \r\n\r\n    // Drag end.\r\n    editor.events.$on($popup, 'dragleave dragend', '.fr-video-upload-layer', function () {\r\n      $(this).removeClass('fr-drop') \r\n\r\n      return false \r\n    }, true) \r\n\r\n    // Drop.\r\n    editor.events.$on($popup, 'drop', '.fr-video-upload-layer', function (e) {\r\n      e.preventDefault() \r\n      e.stopPropagation() \r\n\r\n      $(this).removeClass('fr-drop') \r\n\r\n      const { dataTransfer : dt } = e.originalEvent \r\n\r\n      if (dt && dt.files) {\r\n        const inst = $popup.data('instance') || editor \r\n        inst.events.disableBlur() \r\n        inst.video.upload(dt.files) \r\n        inst.events.enableBlur() \r\n      }\r\n    }, true) \r\n\r\n    if (editor.helpers.isIOS()) {\r\n      editor.events.$on($popup, 'touchstart', '.fr-video-upload-layer input[type=\"file\"]', function () {\r\n        $(this).trigger('click') \r\n      }, true) \r\n    }\r\n\r\n    editor.events.$on($popup, 'change', '.fr-video-upload-layer input[type=\"file\"]', function () {\r\n      if (this.files) {\r\n        const inst = $popup.data('instance') || editor \r\n        inst.events.disableBlur() \r\n        $popup.find('input:focus').blur() \r\n        inst.events.enableBlur() \r\n        inst.video.upload(this.files) \r\n      }\r\n\r\n      // Else IE 9 case.\r\n      // Chrome fix.\r\n      $(this).val('') \r\n    }, true) \r\n  }\r\n\r\n  /**\r\n   * Init the video events.\r\n   */\r\n  function _initEvents() {\r\n\r\n    // Drop inside the editor.\r\n    editor.events.on('drop', _drop, true) \r\n\r\n    editor.events.on('mousedown window.mousedown', _markExit) \r\n    editor.events.on('window.touchmove', _unmarkExit) \r\n    editor.events.on('mouseup window.mouseup', _exitEdit) \r\n\r\n    editor.events.on('commands.mousedown', function ($btn) {\r\n      if ($btn.parents('.fr-toolbar').length > 0) {\r\n        _exitEdit() \r\n      }\r\n    }) \r\n\r\n    editor.events.on('video.hideResizer commands.undo commands.redo element.dropped', function () {\r\n      _exitEdit(true) \r\n    }) \r\n  }\r\n\r\n  /**\r\n   * Throw a video error.\r\n   */\r\n\r\n  function _throwError(code, response) {\r\n    editor.edit.on() \r\n\r\n    if ($current_video) $current_video.find('video').addClass('fr-error') \r\n    _showErrorMessage(editor.language.translate('Something went wrong. Please try again.')) \r\n\r\n    editor.events.trigger('video.error', [{\r\n      code: code,\r\n      message: error_messages[code]\r\n    },\r\n    response\r\n    ]) \r\n  }\r\n\r\n  /**\r\n   * Init the video edit popup.\r\n   */\r\n  function _initEditPopup() {\r\n\r\n    // Video buttons.\r\n    let video_buttons = '' \r\n\r\n    if (editor.opts.videoEditButtons.length > 0) {\r\n      if (editor.opts.videoResponsive) {\r\n        if (editor.opts.videoEditButtons.indexOf('videoSize') > -1) {\r\n          editor.opts.videoEditButtons.splice(editor.opts.videoEditButtons.indexOf('videoSize'), 1)\r\n        }\r\n        if (editor.opts.videoEditButtons.indexOf('videoDisplay') > -1) {\r\n          editor.opts.videoEditButtons.splice(editor.opts.videoEditButtons.indexOf('videoDisplay'), 1) \r\n        }\r\n        if (editor.opts.videoEditButtons.indexOf('videoAlign') > -1) {\r\n          editor.opts.videoEditButtons.splice(editor.opts.videoEditButtons.indexOf('videoAlign'), 1) \r\n        }\r\n      }\r\n\r\n      video_buttons += `<div class=\"fr-buttons\"> \r\n      ${editor.button.buildList(editor.opts.videoEditButtons)} \r\n      </div>` \r\n\r\n      const template = {\r\n        buttons: video_buttons\r\n      }\r\n\r\n      const $popup = editor.popups.create('video.edit', template) \r\n\r\n      editor.events.$on(editor.$wp, 'scroll.video-edit', function () {\r\n        if ($current_video && editor.popups.isVisible('video.edit')) {\r\n\r\n          editor.events.disableBlur() \r\n          _editVideo($current_video) \r\n        }\r\n      }) \r\n\r\n      return $popup \r\n    }\r\n\r\n    return false \r\n  }\r\n\r\n  /**\r\n   * Refresh the size popup.\r\n   */\r\n  function _refreshSizePopup() {\r\n    if ($current_video) {\r\n      const $popup = editor.popups.get('video.size') \r\n      const $video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`)\r\n       \r\n      $popup.find('input[name=\"width\"]').val($video_obj.get(0).style.width || $video_obj.attr('width')).trigger('change') \r\n      $popup.find('input[name=\"height\"]').val($video_obj.get(0).style.height || $video_obj.attr('height')).trigger('change') \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the size popup.\r\n   */\r\n  function showSizePopup() {\r\n    let $popup = editor.popups.get('video.size') \r\n\r\n    if (!$popup) $popup = _initSizePopup() \r\n    hideProgressBar() \r\n    editor.popups.refresh('video.size') \r\n    editor.popups.setContainer('video.size', editor.$sc)\r\n    const $video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`)\r\n      \r\n    const left = $video_obj.offset().left + $video_obj.outerWidth() / 2\r\n    const top = $video_obj.offset().top + $video_obj.height()\r\n  \r\n    editor.popups.show('video.size', left, top, $video_obj.height(), true)\r\n  }\r\n\r\n  /**\r\n   * Init the video upload popup.\r\n   */\r\n  function _initSizePopup(delayed) {\r\n    if (delayed) {\r\n      editor.popups.onRefresh('video.size', _refreshSizePopup) \r\n\r\n      return true \r\n    }\r\n\r\n    // Video buttons.\r\n    let video_buttons = '' \r\n    video_buttons = `<div class=\"fr-buttons fr-tabs\">${editor.button.buildList(editor.opts.videoSizeButtons)}</div>` \r\n\r\n    // Size layer.\r\n    let size_layer = '' \r\n    size_layer = `<div class=\"fr-video-size-layer fr-layer fr-active\" id=\"fr-video-size-layer-${editor.id}\"><div class=\"fr-video-group\"><div class=\"fr-input-line\"><input id=\"fr-video-size-layer-width-${editor.id}\" type=\"text\" name=\"width\" placeholder=\"${editor.language.translate('Width')}\" tabIndex=\"1\"></div><div class=\"fr-input-line\"><input id=\"fr-video-size-layer-height-${editor.id}\" type=\"text\" name=\"height\" placeholder=\"${editor.language.translate('Height')}\" tabIndex=\"1\"></div></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"videoSetSize\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Update')}</button></div></div>`\r\n\r\n    const template = {\r\n      buttons: video_buttons,\r\n      size_layer: size_layer\r\n    }\r\n\r\n    // Set the template in the popup.\r\n    const $popup = editor.popups.create('video.size', template) \r\n\r\n    editor.events.$on(editor.$wp, 'scroll', function () {\r\n      if ($current_video && editor.popups.isVisible('video.size')) {\r\n\r\n        editor.events.disableBlur() \r\n        _editVideo($current_video) \r\n      }\r\n    }) \r\n\r\n    return $popup \r\n  }\r\n\r\n  /**\r\n   * Get video alignment.\r\n   */\r\n  function getAlign($video) {\r\n    if (typeof $video == 'undefined') $video = $current_video \r\n\r\n    if ($video) {\r\n\r\n      // Video has left class.\r\n      if ($video.hasClass('fr-fvl')) {\r\n\r\n        return 'left' \r\n      }\r\n\r\n      // Video has right class.\r\n      else if ($video.hasClass('fr-fvr')) {\r\n\r\n        return 'right' \r\n      }\r\n\r\n      // Video has display class set.\r\n      else if ($video.hasClass('fr-dvb') || $video.hasClass('fr-dvi')) {\r\n\r\n        return 'center' \r\n      }\r\n      else {\r\n\r\n        // Video has display block.\r\n        if ($video.css('display') == 'block') {\r\n\r\n          // Margin left is 0.\r\n          // Margin right is auto.\r\n          if ($video.css('text-algin') == 'left') {\r\n            return 'left' \r\n          }\r\n\r\n          // Margin left is auto.\r\n          // Margin right is 0.\r\n          else if ($video.css('text-align') == 'right') {\r\n            return 'right' \r\n          }\r\n        }\r\n\r\n        // Display inline.\r\n        else {\r\n\r\n          // Float left.\r\n          if ($video.css('float') == 'left') {\r\n            return 'left' \r\n          }\r\n\r\n          // Float right.\r\n          else if ($video.css('float') == 'right') {\r\n            return 'right' \r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return 'center' \r\n  }\r\n\r\n  /**\r\n   * Align video.\r\n   */\r\n  function align(val) {\r\n    $current_video.removeClass('fr-fvr fr-fvl') \r\n\r\n    // Easy case. Use classes.\r\n    if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n      if (val == 'left') {\r\n        $current_video.addClass('fr-fvl') \r\n      }\r\n      else if (val == 'right') {\r\n        $current_video.addClass('fr-fvr') \r\n      }\r\n    }\r\n    else {\r\n      _setStyle($current_video, getDisplay(), val) \r\n    }\r\n\r\n    _selectVideo()\r\n    _repositionResizer() \r\n    _showEditPopup() \r\n    editor.selection.clear() \r\n  }\r\n\r\n  /**\r\n   * Refresh the align icon.\r\n   */\r\n  function refreshAlign($btn) {\r\n    if (!$current_video) return false \r\n\r\n    $btn.find('>*').first().replaceWith(editor.icon.create(`video-align-${getAlign()}`)) \r\n  }\r\n\r\n  /**\r\n   * Refresh the align option from the dropdown.\r\n   */\r\n  function refreshAlignOnShow($btn, $dropdown) {\r\n    if ($current_video) {\r\n      $dropdown.find(`.fr-command[data-param1=\"${getAlign()}\"]`).addClass('fr-active').attr('aria-selected', true) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get video display.\r\n   */\r\n  function getDisplay($video) {\r\n    if (typeof $video == 'undefined') $video = $current_video \r\n\r\n    // Set float to none.\r\n    const flt = $video.css('float') \r\n    $video.css('float', 'none') \r\n\r\n    // Video has display block.\r\n    if ($video.css('display') == 'block') {\r\n\r\n      // Set float to the initial value.\r\n      $video.css('float', '') \r\n\r\n      if ($video.css('float') != flt) $video.css('float', flt) \r\n\r\n      return 'block' \r\n    }\r\n\r\n    // Display inline.\r\n    else {\r\n\r\n      // Set float.\r\n      $video.css('float', '') \r\n\r\n      if ($video.css('float') != flt) $video.css('float', flt) \r\n\r\n      return 'inline' \r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n   * Set video display.\r\n   */\r\n  function display(val) {\r\n    $current_video.removeClass('fr-dvi fr-dvb') \r\n\r\n    // Easy case. Use classes.\r\n    if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n      if (val == 'inline') {\r\n        $current_video.addClass('fr-dvi') \r\n      }\r\n      else if (val == 'block') {\r\n        $current_video.addClass('fr-dvb') \r\n      }\r\n    }\r\n    else {\r\n      _setStyle($current_video, val, getAlign()) \r\n    }\r\n\r\n    _selectVideo()\r\n    _repositionResizer() \r\n    _showEditPopup() \r\n    editor.selection.clear() \r\n  }\r\n\r\n  /**\r\n   * Refresh the video display selected option.\r\n   */\r\n  function refreshDisplayOnShow($btn, $dropdown) {\r\n    if ($current_video) {\r\n      $dropdown.find(`.fr-command[data-param1=\"${getDisplay()}\"]`).addClass('fr-active').attr('aria-selected', true) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the replace popup.\r\n   */\r\n\r\n  function replace() {\r\n    let $popup = editor.popups.get('video.insert') \r\n\r\n    if (!$popup) $popup = _initInsertPopup() \r\n\r\n    if (!editor.popups.isVisible('video.insert')) {\r\n      hideProgressBar() \r\n      editor.popups.refresh('video.insert') \r\n      editor.popups.setContainer('video.insert', editor.$sc) \r\n    }\r\n\r\n    const left = $current_video.offset().left + ($current_video.outerWidth()) / 2\r\n    const top = $current_video.offset().top + $current_video.height()\r\n   \r\n    editor.popups.show('video.insert', left, top, $current_video.outerHeight(), true)\r\n  }\r\n\r\n  /**\r\n   * Remove current selected video.\r\n   */\r\n  function remove() {\r\n    if ($current_video) {\r\n      if (editor.events.trigger('video.beforeRemove', [$current_video]) !== false) {\r\n        const $video = $current_video \r\n        editor.popups.hideAll() \r\n        _exitEdit(true) \r\n\r\n        editor.selection.setBefore($video.get(0)) || editor.selection.setAfter($video.get(0)) \r\n        $video.remove() \r\n        editor.selection.restore() \r\n\r\n        editor.html.fillEmptyBlocks() \r\n\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Hide image upload popup.\r\n   */\r\n\r\n  function _hideInsertPopup() {\r\n    hideProgressBar() \r\n  }\r\n\r\n  function _setStyle($video, _display, _align) {\r\n    if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n      $video.removeClass('fr-fvl fr-fvr fr-dvb fr-dvi') \r\n      $video.addClass(`fr-fv${_align[0]} fr-dv${_display[0]}`) \r\n    }\r\n    else {\r\n      if (_display == 'inline') {\r\n        $video.css({\r\n          display: 'inline-block'\r\n        })\r\n\r\n        if (_align == 'center') {\r\n          $video.css({\r\n            'float': 'none'\r\n          })\r\n        }\r\n        else if (_align == 'left') {\r\n          $video.css({\r\n            'float': 'left'\r\n          })\r\n        }\r\n        else {\r\n          $video.css({\r\n            'float': 'right'\r\n          })\r\n        }\r\n      }\r\n      else {\r\n        $video.css({\r\n          display: 'block',\r\n          clear: 'both'\r\n        })\r\n\r\n        if (_align == 'left') {\r\n          $video.css({\r\n            textAlign: 'left'\r\n          })\r\n        }\r\n        else if (_align == 'right') {\r\n          $video.css({\r\n            textAlign: 'right'\r\n          })\r\n        }\r\n        else {\r\n          $video.css({\r\n            textAlign: 'center'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Convert style to classes.\r\n   */\r\n  function _convertStyleToClasses($video) {\r\n    if (!$video.hasClass('fr-dvi') && !$video.hasClass('fr-dvb')) {\r\n      $video.addClass(`fr-fv${getAlign($video)[0]}`) \r\n      $video.addClass(`fr-dv${getDisplay($video)[0]}`) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Convert classes to style.\r\n   */\r\n  function _convertClassesToStyle($video) {\r\n    const d = $video.hasClass('fr-dvb') ? 'block' : $video.hasClass('fr-dvi') ? 'inline' : null \r\n    const a = $video.hasClass('fr-fvl') ? 'left' : $video.hasClass('fr-fvr') ? 'right' : getAlign($video) \r\n\r\n    _setStyle($video, d, a) \r\n\r\n    $video.removeClass('fr-dvb fr-dvi fr-fvr fr-fvl') \r\n  }\r\n\r\n  /**\r\n   * Refresh video list.\r\n   */\r\n  function _refreshVideoList() {\r\n\r\n    // Find possible candidates that are not wrapped.\r\n    const candidates = editor.$el.find('video').filter(function () {\r\n\r\n      return $(this).parents('span.fr-video').length === 0 \r\n    })\r\n    \r\n    if(candidates.length == 0){\r\n      return\r\n    }\r\n\r\n    candidates.wrap($(document.createElement('span')).attr('class', 'fr-video fr-deletable').attr('contenteditable', 'false')) \r\n\r\n    editor.$el.find('embed, iframe').filter(function () {\r\n      if (editor.browser.safari && this.getAttribute('src')) {\r\n        this.setAttribute('src', this.src) \r\n      }\r\n\r\n      if ($(this).parents('span.fr-video').length > 0) return false \r\n\r\n      const link = $(this).attr('src') \r\n\r\n      for (let i = 0; i < FE.VIDEO_PROVIDERS.length; i++) {\r\n        const vp = FE.VIDEO_PROVIDERS[i] \r\n\r\n        // Check if video provider is allowed.\r\n        if (vp.test_regex.test(link) && (new RegExp(editor.opts.videoAllowedProviders.join('|'))).test(vp.provider)) {\r\n\r\n          return true \r\n        }\r\n      }\r\n\r\n      return false \r\n    }).map(function () {\r\n      return $(this).parents('object').length === 0 ? this : $(this).parents('object').get(0) \r\n    }).wrap($(document.createElement('span')).attr('class', 'fr-video').attr('contenteditable','false')) \r\n\r\n    const videos = editor.$el.find('span.fr-video, video') \r\n\r\n    for (let i = 0; i < videos.length; i++) {\r\n      const $video = $(videos[i]) \r\n\r\n      if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n        _convertStyleToClasses($video) \r\n\r\n        if (!editor.opts.videoTextNear) {\r\n          $video.removeClass('fr-dvi').addClass('fr-dvb') \r\n        }\r\n      }\r\n      else if (!editor.opts.htmlUntouched && !editor.opts.useClasses) {\r\n        _convertClassesToStyle($video) \r\n      }\r\n    }\r\n\r\n    videos.toggleClass('fr-draggable', editor.opts.videoMove) \r\n  }\r\n\r\n  function _init() {\r\n    if (editor.opts.videoResponsive) {\r\n      editor.opts.videoResize = false \r\n    }\r\n\r\n    _initEvents() \r\n\r\n    if (editor.helpers.isMobile()) {\r\n      editor.events.$on(editor.$el, 'touchstart', 'span.fr-video', function () {\r\n        touchScroll = false \r\n      })\r\n\r\n      editor.events.$on(editor.$el, 'touchmove', function () {\r\n        touchScroll = true \r\n      }) \r\n    }\r\n\r\n    editor.events.on('html.set', _refreshVideoList) \r\n    _refreshVideoList() \r\n\r\n    editor.events.$on(editor.$el, 'mousedown', 'span.fr-video', function (e) {\r\n      e.stopPropagation() \r\n\r\n      // initialize drag and drop on blocks for traditional browsers\r\n      if (editor.browser.msie || editor.browser.edge) {\r\n        // https://github.com/froala/wysiwyg-editor/issues/3608\r\n        if (!e.target.innerText) {\r\n          e.target.dragDrop()\r\n          _edit.call(this, e)\r\n        }\r\n      }\r\n    })\r\n    editor.events.$on(editor.$el, 'click touchend', 'span.fr-video', function (e) {\r\n      // https://github.com/froala/wysiwyg-editor/issues/3608\r\n      // When contenteditable attribute is not allowed, user will be able press enter,\r\n      // which will copy fr-video class within p tag causes #3608\r\n      if (e.target.innerText.length || $(this).parents('[contenteditable]').not('.fr-element').not('.fr-img-caption').not('body').first().attr('contenteditable') == 'false') return true\r\n\r\n      _edit.call(this, e)\r\n    }) \r\n\r\n    editor.events.on('keydown', function (e) {\r\n      const key_code = e.which \r\n\r\n      if ($current_video && (key_code == FE.KEYCODE.BACKSPACE || key_code == FE.KEYCODE.DELETE)) {\r\n        e.preventDefault() \r\n        remove() \r\n        editor.undo.saveStep() \r\n\r\n        return false \r\n      }\r\n\r\n      if ($current_video && key_code == FE.KEYCODE.ESC) {\r\n        _exitEdit(true) \r\n        e.preventDefault() \r\n\r\n        return false \r\n      }\r\n\r\n      if ($current_video && key_code != FE.KEYCODE.F10 && !editor.keys.isBrowserAction(e)) {\r\n        e.preventDefault() \r\n\r\n        return false \r\n      }\r\n    }, true) \r\n\r\n    // ESC from accessibility.\r\n    editor.events.on('toolbar.esc', function () {\r\n      if ($current_video) {\r\n        editor.events.disableBlur() \r\n        editor.events.focus() \r\n\r\n        return false \r\n      }\r\n    }, true) \r\n\r\n    // focusEditor from accessibility.\r\n    editor.events.on('toolbar.focusEditor', function () {\r\n      if ($current_video) {\r\n\r\n        return false \r\n      }\r\n    }, true) \r\n\r\n    // Make sure we don't leave empty tags.\r\n    editor.events.on('keydown', function () {\r\n      editor.$el.find('span.fr-video:empty').remove() \r\n    })\r\n\r\n    if (editor.$wp) {\r\n      _syncVideos() \r\n      editor.events.on('contentChanged', _syncVideos) \r\n    }\r\n\r\n    _initInsertPopup(true) \r\n    _initSizePopup(true) \r\n  }\r\n  function toggleAutoplayStyle(color){\r\n    document.getElementById(`autoplay-${editor.id}`).style.cssText=`background:${color}`\r\n\r\n  }\r\n  /**\r\n   * Autoplay video after insert\r\n   */\r\n  function setAutoplay(){\r\n    \r\n    let $video_obj\r\n    if ($current_video.find('iframe, embed, audio').get(0)) {\r\n      $video_obj = $current_video.find('iframe, embed, audio')\r\n      if($video_obj.get(0).src.includes('autoplay=1')){\r\n        toggleAutoplayStyle('#FFFFFF')\r\n        $video_obj.get(0).src= $video_obj.get(0).src.replace('&autoplay=1','')\r\n       }else{\r\n        toggleAutoplayStyle('#D6D6D6')\r\n        $video_obj.get(0).src=$video_obj.get(0).src + '&autoplay=1'\r\n       }\r\n    } \r\n    else {\r\n      const addAutoplay = \"autoplay\";\r\n      $video_obj = $current_video.find('iframe, embed, video')\r\n      if($video_obj.get(0).outerHTML.includes('autoplay')){\r\n        toggleAutoplayStyle('#FFFFFF')\r\n        $video_obj.get(0).outerHTML= $video_obj.get(0).outerHTML.replace('autoplay','')\r\n       }else{\r\n        toggleAutoplayStyle('#D6D6D6')\r\n          let indexofAutoplay=$video_obj.get(0).outerHTML.indexOf('class') -1\r\n          $video_obj.get(0).outerHTML = [$video_obj.get(0).outerHTML.slice(0, indexofAutoplay), addAutoplay, $video_obj.get(0).outerHTML.slice(indexofAutoplay)].join('');\r\n        }\r\n    }\r\n  }\r\n  /**\r\n   * Place selection around current video.\r\n   */\r\n  function _selectVideo() {\r\n    if ($current_video) {\r\n      editor.selection.clear() \r\n      const range = editor.doc.createRange() \r\n      range.selectNode($current_video.get(0)) \r\n      const selection = editor.selection.get() \r\n      selection.addRange(range) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get back to the video main popup.\r\n   */\r\n  function back() {\r\n    if ($current_video) {\r\n      editor.events.disableBlur() \r\n      $current_video[0].click() \r\n    }\r\n    else {\r\n      editor.events.disableBlur() \r\n      editor.selection.restore() \r\n      editor.events.enableBlur() \r\n\r\n      editor.popups.hide('video.insert') \r\n      editor.toolbar.showInline() \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set size based on the current video size.\r\n   */\r\n  function setSize(width, height) {\r\n    if ($current_video) {\r\n      const $popup = editor.popups.get('video.size') \r\n      const $video_obj = $current_video.find(`iframe, embed, ${$current_video.find('iframe, embed, audio').get(0) ? 'audio' : 'video'}`)\r\n      \r\n      $video_obj.css('width', width || $popup.find('input[name=\"width\"]').val()) \r\n      $video_obj.css('height', height || $popup.find('input[name=\"height\"]').val()) \r\n\r\n      if ($video_obj.get(0).style.width) $video_obj.removeAttr('width') \r\n\r\n      if ($video_obj.get(0).style.height) $video_obj.removeAttr('height') \r\n\r\n      $popup.find('input:focus').blur() \r\n      setTimeout(function () {\r\n        $current_video.trigger('click') \r\n      }, editor.helpers.isAndroid() ? 50 : 0) \r\n    }\r\n  }\r\n\r\n  function get() {\r\n\r\n    return $current_video \r\n  }\r\n\r\n  return {\r\n    _init: _init,\r\n    showInsertPopup: showInsertPopup,\r\n    showLayer: showLayer,\r\n    refreshByURLButton: refreshByURLButton,\r\n    refreshEmbedButton: refreshEmbedButton,\r\n    refreshUploadButton: refreshUploadButton,\r\n    upload: upload,\r\n    insertByURL: insertByURL,\r\n    insertEmbed: insertEmbed,\r\n    insert: insert,\r\n    align: align,\r\n    refreshAlign: refreshAlign,\r\n    refreshAlignOnShow: refreshAlignOnShow,\r\n    display: display,\r\n    refreshDisplayOnShow: refreshDisplayOnShow,\r\n    remove: remove,\r\n    hideProgressBar: hideProgressBar,\r\n    showSizePopup: showSizePopup,\r\n    replace: replace,\r\n    back: back,\r\n    setSize: setSize,\r\n    get: get,\r\n    showProgressBar: showProgressBar,\r\n    _editVideo: _editVideo,\r\n    setAutoplay:setAutoplay\r\n  }\r\n}\r\n\r\n// Register the font size command.\r\nFE.RegisterCommand('insertVideo', {\r\n  title: 'Insert Video',\r\n  undo: false,\r\n  focus: true,\r\n  refreshAfterCallback: false,\r\n  popup: true,\r\n  callback: function () {\r\n    if (!this.popups.isVisible('video.insert')) {\r\n      this.video.showInsertPopup() \r\n    }\r\n    else {\r\n      if (this.$el.find('.fr-marker').length) {\r\n        this.events.disableBlur() \r\n        this.selection.restore() \r\n      }\r\n      this.popups.hide('video.insert') \r\n    }\r\n  },\r\n  plugin: 'video'\r\n})\r\n\r\n// Add the font size icon.\r\nFE.DefineIcon('insertVideo', {\r\n  NAME: 'video-camera',\r\n  FA5NAME: 'camera',\r\n  SVG_KEY: 'insertVideo'\r\n})\r\n\r\n// Video by URL button inside the insert video popup.\r\nFE.DefineIcon('videoByURL', { NAME: 'link', SVG_KEY: 'insertLink' })\r\nFE.RegisterCommand('videoByURL', {\r\n  title: 'By URL',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.video.showLayer('video-by-url') \r\n  },\r\n  refresh: function ($btn) {\r\n    this.video.refreshByURLButton($btn) \r\n  }\r\n})\r\n\r\n// Video embed button inside the insert video popup.\r\nFE.DefineIcon('videoEmbed', { NAME: 'code', SVG_KEY: 'codeView' })\r\nFE.RegisterCommand('videoEmbed', {\r\n  title: 'Embedded Code',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.video.showLayer('video-embed') \r\n  },\r\n  refresh: function ($btn) {\r\n    this.video.refreshEmbedButton($btn) \r\n  }\r\n})\r\n\r\n// Video upload button inside the insert video popup.\r\nFE.DefineIcon('videoUpload', { NAME: 'upload', SVG_KEY: 'upload' })\r\nFE.RegisterCommand('videoUpload', {\r\n  title: 'Upload Video',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.video.showLayer('video-upload') \r\n  },\r\n  refresh: function ($btn) {\r\n    this.video.refreshUploadButton($btn) \r\n  }\r\n})\r\n\r\nFE.RegisterCommand('videoInsertByURL', {\r\n  undo: true,\r\n  focus: true,\r\n  callback: function () {\r\n    this.video.insertByURL() \r\n  }\r\n})\r\n\r\nFE.RegisterCommand('videoInsertEmbed', {\r\n  undo: true,\r\n  focus: true,\r\n  callback: function () {\r\n    this.video.insertEmbed() \r\n  }\r\n})\r\n\r\n// Video display.\r\nFE.DefineIcon('videoDisplay', { NAME: 'star', SVG_KEY: 'star' })\r\nFE.RegisterCommand('videoDisplay', {\r\n  title: 'Display',\r\n  type: 'dropdown',\r\n  options: {\r\n    inline: 'Inline',\r\n    block: 'Break Text'\r\n  },\r\n  callback: function (cmd, val) {\r\n    this.video.display(val) \r\n  },\r\n  refresh: function ($btn) {\r\n    if (!this.opts.videoTextNear) $btn.addClass('fr-hidden') \r\n  },\r\n  refreshOnShow: function ($btn, $dropdown) {\r\n    this.video.refreshDisplayOnShow($btn, $dropdown) \r\n  }\r\n})\r\n\r\n// Video align.\r\nFE.DefineIcon('video-align', { NAME: 'align-left', SVG_KEY: 'align Left' })\r\nFE.DefineIcon('video-align-left', { NAME: 'align-left', SVG_KEY: 'alignLeft' })\r\nFE.DefineIcon('video-align-right', { NAME: 'align-right', SVG_KEY: 'alignRight' })\r\nFE.DefineIcon('video-align-center', { NAME: 'align-justify', SVG_KEY: 'alignJustify' })\r\n\r\n// Video align.\r\nFE.DefineIcon('videoAlign', { NAME: 'align-center', SVG_KEY: 'alignCenter' })\r\nFE.RegisterCommand('videoAlign', {\r\n  type: 'dropdown',\r\n  title: 'Align',\r\n  options: {\r\n    left: 'Align Left',\r\n    center: 'None',\r\n    right: 'Align Right'\r\n  },\r\n  html: function () {\r\n    let c = '<ul class=\"fr-dropdown-list\" role=\"presentation\">' \r\n    const { options } = FE.COMMANDS.videoAlign \r\n\r\n    for (const val in options) {\r\n      if (options.hasOwnProperty(val)) {\r\n        c += `<li role=\"presentation\"><a class=\"fr-command fr-title\" tabIndex=\"-1\" role=\"option\" data-cmd=\"videoAlign\" data-param1=\"${val}\" title=\"${this.language.translate(options[val])}\">${this.icon.create(`video-align-${val}`)}<span class=\"fr-sr-only\">${this.language.translate(options[val])}</span></a></li>` \r\n      }\r\n    }\r\n    c += '</ul>' \r\n\r\n    return c \r\n  },\r\n  callback: function (cmd, val) {\r\n    this.video.align(val) \r\n  },\r\n  refresh: function ($btn) {\r\n    this.video.refreshAlign($btn) \r\n  },\r\n  refreshOnShow: function ($btn, $dropdown) {\r\n    this.video.refreshAlignOnShow($btn, $dropdown) \r\n  }\r\n})\r\n\r\n// Video replace.\r\nFE.DefineIcon('videoReplace', {\r\n  NAME: 'exchange',\r\n  FA5NAME: 'exchange-alt',\r\n  SVG_KEY: 'replaceImage'\r\n})\r\nFE.RegisterCommand('videoReplace', {\r\n  title: 'Replace',\r\n  undo: false,\r\n  focus: false,\r\n  popup: true,\r\n  refreshAfterCallback: false,\r\n  callback: function () {\r\n    this.video.replace() \r\n  }\r\n})\r\n\r\n// Video remove.\r\nFE.DefineIcon('videoRemove', { NAME: 'trash', SVG_KEY: 'remove' })\r\nFE.RegisterCommand('videoRemove', {\r\n  title: 'Remove',\r\n  callback: function () {\r\n    this.video.remove() \r\n  }\r\n})\r\nFE.DefineIcon('autoplay', { NAME: 'autoplay', SVG_KEY: 'autoplay' })\r\nFE.RegisterCommand('autoplay', {\r\n  undo: false,\r\n  focus: false,\r\n  popup: true,\r\n  title: 'Autoplay',\r\n  callback: function () {\r\n    this.video.setAutoplay()\r\n  } \r\n})\r\n// Video size.\r\nFE.DefineIcon('videoSize', { NAME: 'arrows-alt', SVG_KEY: 'imageSize' })\r\nFE.RegisterCommand('videoSize', {\r\n  undo: false,\r\n  focus: false,\r\n  popup: true,\r\n  title: 'Change Size',\r\n  callback: function () {\r\n    this.video.showSizePopup() \r\n  }\r\n}) \r\n\r\n// Video back.\r\nFE.DefineIcon('videoBack', { NAME: 'arrow-left', SVG_KEY: 'back' })\r\nFE.RegisterCommand('videoBack', {\r\n  title: 'Back',\r\n  undo: false,\r\n  focus: false,\r\n  back: true,\r\n  callback: function () {\r\n    this.video.back() \r\n  },\r\n  refresh: function ($btn) {\r\n    const $current_video = this.video.get() \r\n\r\n    if (!$current_video && !this.opts.toolbarInline) {\r\n      $btn.addClass('fr-hidden') \r\n      $btn.next('.fr-separator').addClass('fr-hidden') \r\n    }\r\n    else {\r\n      $btn.removeClass('fr-hidden') \r\n      $btn.next('.fr-separator').removeClass('fr-hidden') \r\n    }\r\n  }\r\n}) \r\n\r\nFE.RegisterCommand('videoDismissError', {\r\n  title: 'OK',\r\n  undo: false,\r\n  callback: function () {\r\n    this.video.hideProgressBar(true) \r\n  }\r\n})\r\n\r\nFE.RegisterCommand('videoSetSize', {\r\n  undo: true,\r\n  focus: false,\r\n  title: 'Update',\r\n  refreshAfterCallback: false,\r\n  callback: function () {\r\n    this.video.setSize() \r\n  }\r\n})\r\n"],"names":["Object","assign","FE","POPUP_TEMPLATES","DEFAULTS","videoAllowedTypes","videoAllowedProviders","videoDefaultAlign","videoDefaultDisplay","videoDefaultWidth","videoEditButtons","videoInsertButtons","videoMaxSize","videoMove","videoResize","videoResponsive","videoSizeButtons","videoSplitHTML","videoTextNear","videoUpload","videoUploadMethod","videoUploadParam","videoUploadParams","videoUploadToS3","videoUploadToAzure","videoUploadURL","VIDEO_PROVIDERS","test_regex","url_regex","url_text","html","provider","VIDEO_EMBED_REGEX","PLUGINS","video","editor","$","DEFAULT_VIDEO_UPLOAD_URL","$overlay","$handler","$video_resizer","$current_video","BAD_LINK","MISSING_LINK","ERROR_DURING_UPLOAD","BAD_RESPONSE","MAX_SIZE_EXCEEDED","BAD_FILE_TYPE","NO_CORS_IE","error_messages","_refreshInsertPopup","$popup","popups","get","$url_input","find","val","trigger","$embed_area","showInsertPopup","$btn","$tb","_initInsertPopup","hideProgressBar","hasClass","refresh","setContainer","isVisible","button","getPosition","left","top","show","outerHeight","position","forSelection","_showEditPopup","_initEditPopup","$sc","$video_obj","offset","outerWidth","iframeURL","src","split","length","isFile","includes","document","getElementById","id","style","display","delayed","onRefresh","onHide","_hideInsertPopup","video_buttons","opts","indexOf","splice","buttonList","buildList","by_url_layer","uploadIndex","urlIndex","embedIndex","active","checkmark","language","translate","embed_layer","upload_layer","join","toLowerCase","progress_bar_layer","template","buttons","progress_bar","create","_bindInsertEvents","showLayer","name","toolbarInline","toolbarBottom","helpers","getPX","css","removeClass","addClass","accessibility","focusPopup","refreshByURLButton","attr","refreshEmbedButton","refreshUploadButton","insert","embedded_code","events","focus","selection","restore","replaced","remove","hide","$video","$el","toggleClass","_setStyle","_loadedCallback","parent","next","is","_editVideo","insertHtmlVideo","link","sanitize","data","$existing_video","response","edit","off","_setProgressMessage","sanitizeURL","_add","undo","canDo","saveStep","old_src","$wp","clone","removeData","replaceWith","atts","attributes","i","att","nodeName","removeAttr","hasOwnProperty","on","_syncVideos","blur","_addVideo","showProgressBar","no_message","$current_video_obj","height","dismiss","run","dropRedo","_exitEdit","setAfter","message","progress","$layer","text","_showErrorMessage","$message_header","disableBlur","insertByURL","autoPlayFlag","checked","trim","test","isURL","vp","addAutoplay","indexofAutoplay","slice","replace","RegExp","insertEmbed","code","_edit","call","_parseResponse","resp","JSON","parse","_throwError","ex","_parseXMLResponse","key","_videoUploaded","url","status","responseXML","responseText","responseURL","_videoUploadError","_videoUploadProgress","e","lengthComputable","complete","loaded","total","_videoUploadAborted","loadCallback","data_str","width","createElement","markers","wrap","$marker","node","isLastSibling","insertAfter","clear","readyState","HAVE_FUTURE_DATA","isIOS","_handlerMousedown","core","sameInstance","preventDefault","stopPropagation","c_x","pageX","originalEvent","touches","c_y","pageY","type","oel","$oel","doc","ownerDocument","win","defaultView","parentWindow","editor_inside_iframe","location","frameElement","clientLeft","clientY","clientTop","hideAll","_unmarkExit","_handlerMousemove","s_x","s_y","diff_x","diff_y","_repositionResizer","_handlerMouseup","_getHandler","pos","_resizeVideo","initPageX","direction","step","Math","floor","pow","_initResizer","shared","$on","append","$vid_overlay","first","isMobile","o_win","_mousedown","_mousemove","_mouseup","prevKey","prevTimestamp","ctrlKey","navigator","userAgent","metaKey","keycode","which","timeStamp","KEYCODE","EQUALS","browser","mozilla","FF_EQUALS","altKey","HYPHEN","FF_HYPHEN","videos","c_videos","Array","prototype","el","querySelectorAll","video_srcs","push","getAttribute","removeAttribute","iframePaddingLeft","iframePaddingTop","iframe","scrollTop","scrollLeft","getBoundingClientRect","touchScroll","isDisabled","INSTANCES","toolbar","disable","enableBlur","size","syncIframe","_selectVideo","bulkRefresh","force_exit","_canExit","enable","vid_exit_flag","_markExit","_drop","dt","dataTransfer","files","vid","insertAtPoint","MARKERS","upload","_browserUpload","reader","FileReader","onload","result","binary","atob","array","charCodeAt","window","URL","createObjectURL","Blob","Uint8Array","readAsDataURL","form_data","drag_support","formdata","FormData","keyStart","Date","getTime","params","uploadURL","region","bucket","videoURL","azureKey","encodeURI","account","container","SASToken","xhr","getXHR","uploadDate","toUTCString","accessKey","azureAccount","azureContainer","urls","pop","headerResource","urlResource","stringToSign","signatureBytes","cryptoJSPlugin","cryptoJS","HmacSHA256","enc","Base64","signature","toString","authHeader","setRequestHeader","onerror","onprogress","onabort","abort","send","inst","_initEvents","parents","_refreshSizePopup","showSizePopup","_initSizePopup","size_layer","getAlign","align","htmlUntouched","useClasses","getDisplay","refreshAlign","icon","refreshAlignOnShow","$dropdown","flt","refreshDisplayOnShow","setBefore","fillEmptyBlocks","_display","_align","textAlign","_convertStyleToClasses","_convertClassesToStyle","d","a","_refreshVideoList","candidates","filter","safari","setAttribute","map","_init","msie","edge","target","innerText","dragDrop","not","key_code","BACKSPACE","DELETE","ESC","F10","keys","isBrowserAction","toggleAutoplayStyle","color","cssText","setAutoplay","outerHTML","range","createRange","selectNode","addRange","back","click","showInline","setSize","setTimeout","isAndroid","RegisterCommand","title","refreshAfterCallback","popup","callback","plugin","DefineIcon","NAME","FA5NAME","SVG_KEY","toggle","options","inline","block","cmd","refreshOnShow","center","right","c","COMMANDS","videoAlign"],"mappings":"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"}