/*!
 * froala_editor v3.2.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

{"version":3,"file":"files_manager.js","sources":["../../../src/js/plugins/files_manager.js"],"sourcesContent":["import FE from '../index.js'\r\n'use strict';\r\n\r\nObject.assign(FE.POPUP_TEMPLATES, {\r\n  'filesManager.insert': '[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_EMBED_LAYER_][_UPLOAD_PROGRESS_LAYER_][_PROGRESS_BAR_]',\r\n  'image.edit': '[_BUTTONS_]',\r\n  'image.alt': '[_BUTTONS_][_ALT_LAYER_]',\r\n  'image.size': '[_BUTTONS_][_SIZE_LAYER_]'\r\n})\r\n\r\nObject.assign(FE.DEFAULTS, {\r\n  filesInsertButtons: ['imageBack', '|', 'filesUpload', 'filesByURL', 'filesEmbed'],\r\n  filesInsertButtons2: ['deleteAll', 'insertAll', 'cancel', 'minimize'],\r\n  imageEditButtons: ['imageReplace', 'imageAlign', 'imageCaption', 'imageRemove', 'imageLink', 'linkOpen', 'linkEdit', 'linkRemove', '-', 'imageDisplay', 'imageStyle', 'imageAlt', 'imageSize'],\r\n  imageAltButtons: ['imageBack', '|'],\r\n  imageSizeButtons: ['imageBack', '|'],\r\n  imageUpload: true,\r\n  filesManagerUploadURL: null,\r\n  imageCORSProxy: 'https://cors-anywhere.froala.com',\r\n  imageUploadRemoteUrls: true,\r\n  filesManagerUploadParam: 'file',\r\n  filesManagerUploadParams: {},\r\n  googleOptions:{},\r\n  filesManagerUploadToS3: false,\r\n  filesManagerUploadToAzure: false,\r\n  filesManagerUploadMethod: 'POST',\r\n  filesManagerMaxSize: 10* 1024 * 1024,  \r\n  filesManagerAllowedTypes: ['*'],\r\n  imageResize: true,\r\n  imageResizeWithPercent: false,\r\n  imageRoundPercent: false,\r\n  imageDefaultWidth: 300,\r\n  imageDefaultAlign: 'center',\r\n  imageDefaultDisplay: 'block',\r\n  imageSplitHTML: false,\r\n  imageStyles: {\r\n    'fr-rounded': 'Rounded',\r\n    'fr-bordered': 'Bordered',\r\n    'fr-shadow': 'Shadow'\r\n  },\r\n  imageMove: true,\r\n  imageMultipleStyles: true,\r\n  imageTextNear: true,\r\n  imagePaste: true,\r\n  imagePasteProcess: false,\r\n  imageMinWidth: 16,\r\n  imageOutputSize: false,\r\n  imageDefaultMargin: 5,\r\n  imageAddNewLine: false\r\n})\r\n\r\nFE.VIDEO_PROVIDERS = [\r\n  {\r\n    test_regex: /^.*((youtu.be)|(youtube.com))\\/((v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))?\\??v?=?([^#\\&\\?]*).*/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.)?(?:m\\.)?(?:youtube\\.com|youtu\\.be)\\/(?:watch\\?v=|embed\\/)?([0-9a-zA-Z_\\-]+)(.+)?/g,\r\n    url_text: 'https://www.youtube.com/embed/$1?$2',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}&wmode=opaque\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'youtube'\r\n  },\r\n  {\r\n    test_regex: /^.*(?:vimeo.com)\\/(?:channels(\\/\\w+\\/)?|groups\\/*\\/videos\\/​\\d+\\/|video\\/|)(\\d+)(?:$|\\/|\\?)/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)?|groups\\/(?:[^\\/]*)\\/videos\\/|album\\/(?:\\d+)\\/video\\/|video\\/|)(\\d+)(?:[a-zA-Z0-9_\\-]+)?(\\/[a-zA-Z0-9_\\-]+)?/i,\r\n    url_text: 'https://player.vimeo.com/video/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'vimeo'\r\n  },\r\n  {\r\n    test_regex: /^.+(dailymotion.com|dai.ly)\\/(video|hub)?\\/?([^_]+)[^#]*(#video=([^_&]+))?/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.)?(?:dailymotion\\.com|dai\\.ly)\\/(?:video|hub)?\\/?(.+)/g,\r\n    url_text: 'https://www.dailymotion.com/embed/video/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'dailymotion'\r\n  },\r\n  {\r\n    test_regex: /^.+(screen.yahoo.com)\\/[^_&]+/,\r\n    url_regex: '',\r\n    url_text: '',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}?format=embed\" frameborder=\"0\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\" allowtransparency=\"true\"></iframe>',\r\n    provider: 'yahoo'\r\n  },\r\n  {\r\n    test_regex: /^.+(rutube.ru)\\/[^_&]+/,\r\n    url_regex: /(?:https?:\\/\\/)?(?:www\\.)?(?:rutube\\.ru)\\/(?:video)?\\/?(.+)/g,\r\n    url_text: 'https://rutube.ru/play/embed/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen=\"true\" mozallowfullscreen=\"true\" webkitallowfullscreen=\"true\" allowtransparency=\"true\"></iframe>',\r\n    provider: 'rutube'\r\n  },\r\n  {\r\n    test_regex: /^(?:.+)vidyard.com\\/(?:watch)?\\/?([^.&/]+)\\/?(?:[^_.&]+)?/,\r\n    url_regex: /^(?:.+)vidyard.com\\/(?:watch)?\\/?([^.&/]+)\\/?(?:[^_.&]+)?/g,\r\n    url_text: 'https://play.vidyard.com/$1',\r\n    html: '<iframe width=\"640\" height=\"360\" src=\"{url}\" frameborder=\"0\" allowfullscreen></iframe>',\r\n    provider: 'vidyard'\r\n  }\r\n] \r\n\r\nFE.VIDEO_EMBED_REGEX = /^\\W*((<iframe(.|\\n)*>(\\s|\\n)*<\\/iframe>)|(<embed(.|\\n)*>))\\W*$/i \r\nFE.IMAGE_EMBED_REGEX = /^\\W*((<img(.|\\n)*>(\\s|\\n)*))\\W*$/i\r\n\r\nFE.PLUGINS.filesManager = function (editor) {\r\n  const { $ } = editor\r\n  const DEFAULT_FILE_UPLOAD_URL = 'https://i.froala.com/upload'\r\n\r\n  let $current_image\r\n  let $current_image_index\r\n  let current_index\r\n  let $file_manager_dialog_open = false\r\n  let $child_window_open = false\r\n  let $image_resizer\r\n  let $handler\r\n  let $overlay\r\n  let disableEdit \r\n  let mousedown = false\r\n  let file_list = new Map();\r\n  let file_list_values = new Map();\r\n  let XMLHttpRequests = new Map()\r\n  let fileUploads = new Map()\r\n  let checked_files = new Map()\r\n  let failedUploadFiles = new Map()\r\n  let totalUploadPercent = 0\r\n  let completedUploads = 0\r\n  let fileKeys = []\r\n  let imageEditIndex = -1\r\n  let editImageValue\r\n  let autoplayCheckbox=[]\r\n  let fileListIndex = 0\r\n  const requiredPlugins = ['file', 'image','imageTUI', 'video']\r\n  const BAD_LINK = 1\r\n  const MISSING_LINK = 2\r\n  const ERROR_DURING_UPLOAD = 3\r\n  const BAD_RESPONSE = 4\r\n  const MAX_SIZE_EXCEEDED = 5\r\n  const BAD_FILE_TYPE = 6\r\n  const NO_CORS_IE = 7\r\n  const CORRUPTED_IMAGE = 8\r\n  const ERROR_LINK = 9\r\n  const UPLOAD_CANCEL = 10\r\n\r\n  const unsupported_file_types=['video/avi','video/mpeg','video/x-ms-wmv']\r\n  const error_messages = {}\r\n  error_messages[BAD_LINK] = 'File cannot be loaded from the passed link.',\r\n  error_messages[MISSING_LINK] = 'No link in upload response.',\r\n  error_messages[ERROR_DURING_UPLOAD] = 'Error during file upload.',\r\n  error_messages[BAD_RESPONSE] = 'Parsing response failed.',\r\n  error_messages[MAX_SIZE_EXCEEDED] = 'File is too large.',\r\n  error_messages[BAD_FILE_TYPE] = 'File type is invalid.',\r\n  error_messages[NO_CORS_IE] = 'Files can be uploaded only to same domain in IE 8 and IE 9.'\r\n  error_messages[CORRUPTED_IMAGE] = 'File is corrupted.'\r\n  error_messages[ERROR_LINK] = 'Error during file loading.'\r\n  error_messages[UPLOAD_CANCEL] = 'File upload cancelled'\r\n\r\n  var fileFormats = [\r\n    ['png', 'PNG', 'jpg', 'JPG', 'jpeg', 'JPEG', 'gif', 'GIF', 'webp', 'WEBP'],\r\n    ['docx', 'DOCX', 'xlsx'],\r\n    ['mp4', 'avi', 'mov', 'url']\r\n  ];\r\n\r\n  /**\r\n   * Refresh the image insert popup.\r\n   */\r\n    function _refreshInsertPopup() {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n\r\n    const $url_input = $popup.find('.fr-files-by-url-layer input')\r\n    $url_input.val('')\r\n\r\n    let $embed_area = $popup.find('.fr-files-embed-layer textarea')\r\n    $embed_area.val('').trigger('change')\r\n\r\n    $url_input.trigger('change')\r\n  }\r\n\r\n  /**\r\n   * Show the image upload popup.\r\n   */\r\n\r\n  function showInsertPopup(rerender) {\r\n    if(!editor.hasOwnProperty('imageTUI')){\r\n      if(isImage){\r\n        disableEdit = 'fr-disabled'\r\n       }\r\n    }\r\n    $file_manager_dialog_open = true\r\n    // removing all files with errors\r\n    failedUploadFiles.forEach(function(errorMessage, index) {\r\n      deleteFile(index)\r\n    })\r\n    let $popup\r\n    // check for required plugins\r\n    if(checkRequiredPlugins()){\r\n      $popup = editor.popups.get('filesManager.insert')\r\n      if (!$popup) $popup = _initInsertPopup()\r\n    }\r\n    else{\r\n      $popup = editor.popups.get('filesManager.insert')\r\n      if (!$popup) $popup = _initPluginErrorPopup()\r\n    }\r\n    const $btn = editor.$tb.find('.fr-command[data-cmd=\"insertFiles\"]')\r\n    hideProgressBar()   \r\n    if (rerender || !$popup.hasClass('fr-active')) {      \r\n      if(!rerender){\r\n        resetAllFilesCheckbox()\r\n      }\r\n      editor.popups.refresh('filesManager.insert')\r\n      editor.popups.setContainer('filesManager.insert', editor.$tb)     \r\n      \r\n\r\n      if ($btn.isVisible()) {\r\n        const { left, top } = editor.button.getPosition($btn, file_list.size)\r\n        editor.popups.show('filesManager.insert', left, top, $btn.outerHeight())\r\n      }\r\n      else {\r\n        editor.position.forSelection($popup)\r\n        editor.popups.show('filesManager.insert')        \r\n      }\r\n    }\r\n    editor.popups.setPopupDimensions($popup)\r\n    if(checkRequiredPlugins()){\r\n      editor.popups.setFileListHeight($popup)\r\n    }\r\n\r\n    if($popup.find('.fr-upload-progress') && file_list.size == 0)\r\n        $popup.find('.fr-upload-progress').addClass('fr-none')\r\n\r\n  }\r\n\r\n  function checkRequiredPlugins(){\r\n    let plugins = true\r\n    requiredPlugins.forEach(function(plugin){\r\n      if(editor.opts.pluginsEnabled.indexOf(plugin) < 0){\r\n        plugins = false\r\n      }\r\n    })\r\n    return plugins\r\n  }\r\n\r\n  function addPlugins(){\r\n    requiredPlugins.forEach(function(plugin){\r\n      if(editor.opts.pluginsEnabled.indexOf(plugin) < 0){\r\n        editor.opts.pluginsEnabled.push(plugin)\r\n      }\r\n    })\r\n  }\r\n\r\n  function loadPlugins(module_list){\r\n    for (const m_name in module_list) {\r\n      if(!editor[m_name]){\r\n        if(FE.PLUGINS[m_name] && editor.opts.pluginsEnabled.indexOf(m_name) < 0){\r\n          continue\r\n        }\r\n        editor[m_name] = new module_list[m_name](editor)\r\n        if (editor[m_name]._init) {\r\n          editor[m_name]._init()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Hide image upload popup.\r\n   */\r\n\r\n  function _hideInsertPopup() {\r\n      hideProgressBar()\r\n  }\r\n\r\n  /**\r\n   * Reposition resizer.\r\n   */\r\n\r\n  function _repositionResizer() {\r\n    if (!$image_resizer) _initImageResizer()\r\n\r\n    if (!$current_image) return false\r\n\r\n    const $container = editor.$wp || editor.$sc\r\n\r\n    $container.append($image_resizer)\r\n    $image_resizer.data('instance', editor)\r\n\r\n    let wrap_correction_top = $container.scrollTop() - (($container.css('position') != 'static' ? $container.offset().top : 0))\r\n    let wrap_correction_left = $container.scrollLeft() - (($container.css('position') != 'static' ? $container.offset().left : 0))\r\n\r\n    wrap_correction_left -= editor.helpers.getPX($container.css('border-left-width'))\r\n    wrap_correction_top -= editor.helpers.getPX($container.css('border-top-width'))\r\n\r\n    if (editor.$el.is('img') && editor.$sc.is('body')) {\r\n      wrap_correction_top = 0\r\n      wrap_correction_left = 0\r\n    }\r\n\r\n    let $el = getEl()\r\n\r\n    if (hasCaption()) {\r\n      $el = $el.find('.fr-img-wrap')\r\n    }\r\n\r\n    let iframePaddingTop = 0\r\n    let iframePaddingLeft = 0\r\n    if (editor.opts.iframe) {\r\n      iframePaddingTop = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-top'))\r\n      iframePaddingLeft = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-left'))\r\n    }\r\n\r\n    $image_resizer\r\n      .css('top', (editor.opts.iframe ? $el.offset().top + iframePaddingTop : $el.offset().top + wrap_correction_top) - 1)\r\n      .css('left', (editor.opts.iframe ? $el.offset().left + iframePaddingLeft : $el.offset().left + wrap_correction_left) - 1)\r\n      .css('width', $el.get(0).getBoundingClientRect().width)\r\n      .css('height', $el.get(0).getBoundingClientRect().height)\r\n      .addClass('fr-active')\r\n  }\r\n\r\n  /**\r\n   * Create resize handler.\r\n   */\r\n\r\n  function _getHandler(pos) {\r\n\r\n    return `<div class=\"fr-handler fr-h${pos}\"></div>`\r\n  }\r\n\r\n  /**\r\n   * Set the image with\r\n   */\r\n  function _setWidth(width) {\r\n    if (hasCaption()) {\r\n      $current_image.parents('.fr-img-caption').css('width', width)\r\n    }\r\n    else {\r\n      $current_image.css('width', width)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Mouse down to start resize.\r\n   */\r\n  function _handlerMousedown(e) {\r\n    // Check if resizer belongs to current instance.\r\n    if (!editor.core.sameInstance($image_resizer)) return true\r\n\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n\r\n    if (editor.$el.find('img.fr-error').left) return false\r\n\r\n    if (!editor.undo.canDo()) editor.undo.saveStep()\r\n\r\n    // Get offset.\r\n    let start_x = e.pageX || e.originalEvent.touches[0].pageX\r\n\r\n    // Only on mousedown. This function could be called from keydown on accessibility.\r\n    if (e.type == 'mousedown') {\r\n      // See if the entire editor is inside iframe to adjust starting offset.\r\n      const oel = editor.$oel.get(0)\r\n      const doc = oel.ownerDocument\r\n      const win = doc.defaultView || doc.parentWindow\r\n      let editor_inside_iframe = false\r\n\r\n      try {\r\n        editor_inside_iframe = (win.location != win.parent.location && !(win.$ && win.$.FE))\r\n      } catch (ex) { }\r\n\r\n      if (editor_inside_iframe && win.frameElement) {\r\n        start_x += editor.helpers.getPX($(win.frameElement).offset().left) + win.frameElement.clientLeft\r\n      }\r\n    }\r\n\r\n    $handler = $(this)\r\n    $handler.data('start-x', start_x)\r\n    $handler.data('start-width', $current_image.width())\r\n    $handler.data('start-height', $current_image.height())\r\n\r\n    // Set current width.\r\n    let width = $current_image.width()\r\n\r\n    // Update width value if resizing with percent.\r\n    if (editor.opts.imageResizeWithPercent) {\r\n      const p_node = $current_image.parentsUntil(editor.$el, editor.html.blockTagsQuery()).get(0) || editor.el\r\n      width = (width / $(p_node).outerWidth() * 100).toFixed(2) + '%'\r\n    }\r\n    // Set the image width.\r\n    _setWidth(width)\r\n    $overlay.show()\r\n    editor.popups.hideAll()\r\n    _unmarkExit()\r\n  }\r\n\r\n  function insertEmbed(code) {\r\n    if (typeof code == 'undefined') {\r\n      const $popup = editor.popups.get('filesManager.insert')\r\n      code = $popup.find('.fr-files-embed-layer textarea').val() || ''\r\n    }\r\n\r\n    if (code.length === 0 || !(FE.VIDEO_EMBED_REGEX.test(code)||FE.IMAGE_EMBED_REGEX.test(code))) {\r\n      _showErrorMessage(editor.language.translate('Something went wrong. Please try again.'));\r\n      if(FE.VIDEO_EMBED_REGEX.test(code))\r\n      {\r\n        editor.events.trigger('video.codeError', [code])\r\n      }\r\n    }\r\n    else {\r\n      insertEmbeddedFile(code)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Do resize.\r\n   */\r\n  function _handlerMousemove(e) {\r\n    // Check if resizer belongs to current instance.\r\n    if (!editor.core.sameInstance($image_resizer)) return true\r\n    let real_image_size\r\n\r\n    if ($handler && $current_image) {\r\n      e.preventDefault()\r\n\r\n      if (editor.$el.find('img.fr-error').left) return false\r\n\r\n      const c_x = e.pageX || (e.originalEvent.touches ? e.originalEvent.touches[0].pageX : null)\r\n\r\n      if (!c_x) return false\r\n\r\n      const s_x = $handler.data('start-x')\r\n      let diff_x = c_x - s_x\r\n      let width = $handler.data('start-width')\r\n\r\n      if ($handler.hasClass('fr-hnw') || $handler.hasClass('fr-hsw')) {\r\n        diff_x = 0 - diff_x\r\n      }\r\n\r\n      if (editor.opts.imageResizeWithPercent) {\r\n        const p_node = $current_image.parentsUntil(editor.$el, editor.html.blockTagsQuery()).get(0) || editor.el\r\n        width = ((width + diff_x) / $(p_node).outerWidth() * 100).toFixed(2)\r\n\r\n        if (editor.opts.imageRoundPercent) width = Math.round(width)\r\n\r\n        // Set the image width.\r\n        _setWidth(`${width}%`)\r\n\r\n        // Get the real image width after resize.\r\n        if (hasCaption()) {\r\n          real_image_size = (editor.helpers.getPX($current_image.parents('.fr-img-caption').css('width')) / $(p_node).outerWidth() * 100).toFixed(2)\r\n        }\r\n        else {\r\n          real_image_size = (editor.helpers.getPX($current_image.css('width')) / $(p_node).outerWidth() * 100).toFixed(2)\r\n        }\r\n\r\n        // If the width is not contained within editor use the real image size.\r\n        if (real_image_size !== width && !editor.opts.imageRoundPercent) {\r\n          _setWidth(`${real_image_size}%`)\r\n        }\r\n\r\n        $current_image.css('height', '').removeAttr('height')\r\n      }\r\n      else {\r\n        if (width + diff_x >= editor.opts.imageMinWidth) {\r\n          // Set width for image parent node as well.\r\n          _setWidth(width + diff_x)\r\n\r\n          // Get the real image width after resize.\r\n          if (hasCaption()) {\r\n            real_image_size = editor.helpers.getPX($current_image.parents('.fr-img-caption').css('width'))\r\n          }\r\n          else {\r\n            real_image_size = editor.helpers.getPX($current_image.css('width'))\r\n          }\r\n        }\r\n\r\n        // If the width is not contained within editor use the real image size.\r\n        if (real_image_size !== width + diff_x) {\r\n          _setWidth(real_image_size)\r\n        }\r\n\r\n        // https://github.com/froala/wysiwyg-editor/issues/1963.\r\n        if (($current_image.attr('style') || '').match(/(^height:)|(; *height:)/) || $current_image.attr('height')) {\r\n          $current_image.css('height', $handler.data('start-height') * $current_image.width() / $handler.data('start-width'))\r\n          $current_image.removeAttr('height')\r\n        }\r\n      }\r\n\r\n      _repositionResizer()\r\n\r\n      editor.events.trigger('image.resize', [get()])\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Stop resize.\r\n   */\r\n\r\n  function _handlerMouseup(e) {\r\n\r\n    // Check if resizer belongs to current instance.\r\n    if (!editor.core.sameInstance($image_resizer)) return true\r\n\r\n    if ($handler && $current_image) {\r\n      if (e) e.stopPropagation()\r\n\r\n      if (editor.$el.find('img.fr-error').left) return false\r\n\r\n      $handler = null\r\n      $overlay.hide()\r\n      _repositionResizer()\r\n\r\n      editor.undo.saveStep()\r\n\r\n      editor.events.trigger('image.resizeEnd', [get()])\r\n    }\r\n    else { //https://github.com/froala-labs/froala-editor-js-2/issues/1916\r\n      $image_resizer.removeClass('fr-active')\r\n    }\r\n  }\r\n\r\n  function _disableInsertCheckbox () {\r\n    failedUploadFiles.forEach(function(errorMessage, index) {\r\n      const $popup = editor.popups.get('filesManager.insert')\r\n      $popup.find('.fr-checkbox-file-'+index).get(0).disabled = true\r\n      if(document.getElementById('fr-file-autoplay-button-' + index)){\r\n        document.getElementById('fr-file-autoplay-button-' + index).disabled = true\r\n        document.getElementById('fr-file-autoplay-button-' + index).parentElement.classList.add('fr-checkbox-disabled')\r\n        document.getElementById('fr-file-autoplay-button-' + index).parentElement.classList.remove('fr-files-checkbox')\r\n      }\r\n            $popup.find('.fr-checkbox-'+index).get(0).classList.remove('fr-files-checkbox')\r\n      $popup.find('.fr-checkbox-'+index).get(0).classList.add('fr-checkbox-disabled')\r\n    })   \r\n  }\r\n\r\n  function _disableFileIcons () {\r\n    failedUploadFiles.forEach(function(errorMessage, index) {\r\n      const $popup = editor.popups.get('filesManager.insert')\r\n\r\n      if(document.getElementById(`fr-file-edit-button-${index}`)){\r\n        document.getElementById(`fr-file-edit-button-${index}`).classList.add('fr-disabled')\r\n        document.getElementById(`fr-file-view-button-${index}`).classList.add('fr-disabled')\r\n        document.getElementById(`fr-file-insert-button-${index}`).classList.add('fr-disabled')\r\n      }\r\n    })   \r\n  }\r\n\r\n  /**\r\n   * Throw an image error.\r\n   */\r\n\r\n  function _throwError(code, response, $img, index) {\r\n    editor.edit.on()\r\n    if ($current_image) $current_image.addClass('fr-error')\r\n    // https://github.com/froala/wysiwyg-editor/issues/3407\r\n    if (error_messages[code]) {\r\n       if(code == ERROR_DURING_UPLOAD || code == MISSING_LINK || code == BAD_RESPONSE){\r\n         updateFileUploadingProgress(100, index, true)\r\n       }\r\n       failedUploadFiles.set(index, error_messages[code])\r\n       _disableInsertCheckbox()\r\n       _disableFileIcons()\r\n      _showFileErrorMessage(editor.language.translate(error_messages[code]), index)\r\n    }\r\n    else {\r\n      _showFileErrorMessage(editor.language.translate('Something went wrong. Please try again.'), index)\r\n    }\r\n\r\n    // Remove image if it exists.\r\n    if (!$current_image && $img) remove($img)\r\n\r\n    editor.events.trigger('filesManager.error', [{\r\n      code: code,\r\n      message: error_messages[code]\r\n    },\r\n    response,\r\n    $img\r\n    ])\r\n  }\r\n\r\n  /**\r\n   * Init the image edit popup.\r\n   */\r\n\r\n  function _initEditPopup(delayed) {\r\n    if (delayed) {\r\n      if (editor.$wp) {\r\n        editor.events.$on(editor.$wp, 'scroll.image-edit', function () {\r\n          if ($current_image && editor.popups.isVisible('image.edit')) {\r\n            editor.events.disableBlur()\r\n          }\r\n        })\r\n      }\r\n\r\n      return true\r\n    }\r\n\r\n    // Image buttons.\r\n    let image_buttons = ''\r\n\r\n    if (editor.opts.imageEditButtons.length > 0) {\r\n\r\n      image_buttons += `<div class=\"fr-buttons\"> \r\n        ${editor.button.buildList(editor.opts.imageEditButtons)}\r\n        </div>`\r\n\r\n      const template = {\r\n        buttons: image_buttons\r\n      }\r\n\r\n      const $popup = editor.popups.create('image.edit', template)\r\n\r\n      return $popup\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n    /**\r\n   * Cancel File Insert.\r\n   */\r\n\r\n  function cancelFileInsert(){\r\n    this.file_manager_dialog_open = false\r\n    XMLHttpRequests.forEach(function(req, index){      \r\n      if(req.readyState != 4){\r\n        req.abort()\r\n        deleteFile(index)\r\n      }\r\n    })\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    $popup.find('.fr-progress-bar').removeClass('fr-display-block').addClass('fr-none')\r\n    $popup.find('.fr-command[data-cmd=\"filesUpload\"]').removeClass('fr-disabled')\r\n    $popup.find('.fr-command[data-cmd=\"filesByURL\"]').removeClass('fr-disabled')\r\n    $popup.find('.fr-command[data-cmd=\"filesEmbed\"]').removeClass('fr-disabled')\r\n    completedUploads = 0\r\n    XMLHttpRequests = new Map()\r\n    fileUploads = new Map()\r\n    resetAllFilesCheckbox()\r\n    editor.popups.hide('filesManager.insert')\r\n  }\r\n\r\n  /**\r\n   * Cancel File Upload.\r\n   */\r\n\r\n  function cancelFileUpload(index){\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    const right = $popup.find('.fr-file-item-right-'+index)\r\n    right.get(0).innerHTML = getFileActionButtons(index)\r\n    XMLHttpRequests.get(index).abort()\r\n    updateProgressBar(index, 100, true)\r\n    $popup.find('.fr-checkbox-file-'+index).get(0).disabled = true\r\n  }\r\n  \r\n  /**\r\n   * Delete File Upload.\r\n   */\r\n\r\n  function deleteFileUpload(index){\r\n    if(XMLHttpRequests.get(index).readyState != 0){\r\n      XMLHttpRequests.get(index).abort()\r\n      updateProgressBar(index, 100, true)\r\n      XMLHttpRequests.delete(index)\r\n    }\r\n    deleteFile(index)\r\n  }\r\n\r\n  /** \r\n   * \r\n   */\r\n\r\n  function checkInsertAllState() {\r\n    const $popup = editor.popups.get('filesManager.insert') \r\n    let $btnInsert = $popup.find('.fr-command[data-cmd=\"insertAll\"]'),\r\n      $btnDelete = $popup.find('.fr-command[data-cmd=\"deleteAll\"]'),\r\n      isDisabled = true\r\n\r\n    function addCheck(file, i, map) {\r\n      if (checked_files.get(i)) {\r\n        isDisabled = false\r\n      }\r\n    }\r\n    checked_files.forEach(addCheck)\r\n    isDisabled ? $btnInsert.addClass('fr-disabled') : $btnInsert.removeClass('fr-disabled')\r\n    isDisabled ? $btnDelete.addClass('fr-disabled') : $btnDelete.removeClass('fr-disabled')\r\n   }\r\n\r\n  /**\r\n   * Delete File.\r\n   */\r\n\r\n  function deleteFile(index){\r\n    if(file_list_values.get(index) && file_list_values.get(index).link)\r\n      editor.events.trigger('filesManager.removed', [file_list_values.get(index).link])\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    // https://github.com/froala-labs/froala-editor-js-2/issues/2848\r\n    if ($popup.find('.fr-file-' + index).get(0) !== undefined) {\r\n      $popup.find('.fr-file-' + index).get(0).outerHTML = \"\"\r\n    }\r\n    file_list_values.delete(index)\r\n    file_list.delete(index)\r\n    checked_files.delete(index)\r\n    checkInsertAllState()\r\n    if (file_list.size == 0) {\r\n      fileListIndex = 0\r\n    }\r\n    failedUploadFiles.delete(index)\r\n    editor.popups.setPopupDimensions($popup, true)\r\n    if(editor.opts.toolbarBottom) \r\n      showInsertPopup(true)\r\n    else\r\n      editor.popups.setPopupDimensions($popup)\r\n\r\n    if($popup.find('.fr-upload-progress') && file_list.size == 0)\r\n        $popup.find('.fr-upload-progress').addClass('fr-none')\r\n\r\n  }\r\n\r\n  /**\r\n   * Minimize popup.\r\n   */\r\n\r\n  function minimizePopup(current_index) {\r\n    this.file_manager_dialog_open = false\r\n    editor.popups.hide(\"filesManager.insert\");\r\n    resetAllFilesCheckbox(current_index)\r\n    \r\n  }\r\n\r\n/**\r\n   * Reset checkbox of all files.\r\n   */\r\n\r\n  function resetAllFilesCheckbox() {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    let checked = $popup.find('.fr-insert-checkbox')\r\n    for(let i = 0 ; i < checked.length ; i++){\r\n      checked.get(i).children['target'].checked = false\r\n      $popup.find('.fr-file-' + checked.get(i).id.split('-').pop()).get(0).classList.add('fr-unchecked')\r\n    }\r\n    if(current_index){\r\n      if(document.getElementById(`fr-file-autoplay-button-${current_index}`))\r\n        document.getElementById(`fr-file-autoplay-button-${current_index}`).checked=false\r\n      autoplayCheckbox=autoplayCheckbox.filter(function(i){\r\n        return i!=current_index\r\n      })\r\n    }else{\r\n      let autoplay = $popup.find('.fr-file-autoplay-button')\r\n      for(let i = 0 ; i < autoplay.length ; i++){\r\n        autoplay.get(i).checked = false\r\n      }\r\n      autoplayCheckbox = []\r\n    }\r\n    checked_files = new Map()\r\n    checkInsertAllState()\r\n  }\r\n\r\n  /**\r\n   * Show progress bar.\r\n   */\r\n\r\n  function showProgressBar(no_message) {\r\n    let $popup = editor.popups.get('filesManager.insert')\r\n\r\n    if (!$popup) $popup = _initInsertPopup()\r\n\r\n    $popup.find('.fr-layer.fr-active').removeClass('fr-active').addClass('fr-pactive')\r\n    $popup.find('.fr-files-progress-bar-layer').addClass('fr-active')\r\n    $popup.find('.fr-buttons').hide()\r\n\r\n    if ($current_image) {\r\n      const $el = getEl()\r\n\r\n      editor.popups.setContainer('filesManager.insert', editor.$sc)\r\n      const left = $el.offset().left\r\n      const top = $el.offset().top + $el.height()\r\n\r\n      editor.popups.show('filesManager.insert', left, top, $el.outerHeight())\r\n    }\r\n\r\n    if (typeof no_message == 'undefined') {\r\n      _setProgressMessage(editor.language.translate('Uploading'), 0)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Hide progress bar.\r\n   */\r\n  function hideProgressBar(dismiss) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n\r\n    if ($popup) {\r\n      $popup.find('.fr-layer.fr-pactive').addClass('fr-active').removeClass('fr-pactive')\r\n      $popup.find('.fr-files-progress-bar-layer').removeClass('fr-active')\r\n      $popup.find('.fr-buttons').show()\r\n\r\n      // Dismiss error message.\r\n      if (dismiss || editor.$el.find('img.fr-error').length) {\r\n        editor.events.focus()\r\n\r\n        if (editor.$el.find('img.fr-error').length) {\r\n          editor.$el.find('img.fr-error').remove()\r\n          editor.undo.saveStep()\r\n          editor.undo.run()\r\n          editor.undo.dropRedo()\r\n        }\r\n\r\n        if (!editor.$wp && $current_image) {\r\n          const $img = $current_image\r\n          _exitEdit(true)\r\n          editor.selection.setAfter($img.get(0))\r\n          editor.selection.restore()\r\n        }\r\n        editor.popups.hide('filesManager.insert')\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set a progress message.\r\n   */\r\n\r\n  function _setProgressMessage(message, progress) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n\r\n    if ($popup) {\r\n      const $layer = $popup.find('.fr-files-progress-bar-layer')\r\n      $layer.find('h3').text(message + (progress ? ` ${progress}%` : ''))\r\n\r\n      $layer.removeClass('fr-error')\r\n\r\n      if (progress) {\r\n        $layer.find('div').removeClass('fr-indeterminate')\r\n        $layer.find('div > span').css('width', `${progress}%`)\r\n      }\r\n      else {\r\n        $layer.find('div').addClass('fr-indeterminate')\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show error message to the user.\r\n   */\r\n\r\n  function _showErrorMessage(message) {\r\n    showProgressBar()\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    const $layer = $popup.find('.fr-files-progress-bar-layer')\r\n    $layer.addClass('fr-error')\r\n    const $message_header = $layer.find('h3')\r\n    $message_header.text(message)\r\n    editor.events.disableBlur()\r\n    $message_header.focus()\r\n  }\r\n\r\n\r\n  /**\r\n   * Show error message to the  user for file upload.\r\n   */\r\n\r\n  function _showFileErrorMessage(message, index) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    const $layer = $popup.find('.fr-upload-progress-layer')\r\n    const $row = $popup.find(`.fr-file-${index}`)\r\n    $layer.addClass('fr-error')\r\n    const $message_header = $row.find('h5')\r\n    $message_header.text(message)\r\n  }\r\n\r\n  /*\r\n   * Drag and Drop Functions\r\n   */\r\n\r\n  let globalListClass = '',\r\n    sortableLists,\r\n    globalX, globalY\r\n\r\n  function enableDragSort(listClass) {\r\n    globalListClass = listClass;\r\n    sortableLists = document.getElementsByClassName(listClass);\r\n    Array.prototype.map.call(sortableLists, (list) => {\r\n      enableDragItem(list)\r\n    });\r\n  }\r\n\r\n  function enableDragItem(item) {\r\n    item.addEventListener(\"dragover\", function (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      globalX = event.pageX\r\n      globalY = event.pageY\r\n      let el = document.getElementById('filesList')\r\n      if (globalY + 20 > el.getBoundingClientRect().bottom)\r\n        scrollBy(el, 0, 10)\r\n      if (globalY - 20 < el.getBoundingClientRect().top)\r\n        scrollBy(el, 0, -10)\r\n    }, false);\r\n\r\n    if(editor.helpers.isMobile()){\r\n    let el = item.getElementsByClassName('dot')\r\n    el[0].addEventListener(\"touchmove\", function (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      let sourceElement = event.target\r\n      while (sourceElement && !sourceElement.classList.contains(globalListClass)) {\r\n        sourceElement = sourceElement.parentElement\r\n      }  \r\n\r\n      let hoveredItem = document.elementFromPoint(event.targetTouches[0].clientX, event.targetTouches[0].clientY)\r\n      while (hoveredItem && !hoveredItem.classList.contains(globalListClass)) {\r\n        hoveredItem = hoveredItem.parentElement\r\n      }     \r\n\r\n      let elementsWithHoverClass = document.getElementsByClassName('fr-hovered-over-file')\r\n      Array.prototype.forEach.call(elementsWithHoverClass, function(element) {\r\n        element.classList.remove('fr-hovered-over-file')\r\n    });\r\n \r\n    if(hoveredItem && !sourceElement.classList.contains('fr-unchecked'))   \r\n        hoveredItem.classList.add('fr-hovered-over-file')\r\n\r\n      let el = document.getElementById('filesList')\r\n        if (event.targetTouches[0].clientY + 5 > el.getBoundingClientRect().bottom)\r\n          {\r\n            scrollBy(el, 0, 5)\r\n          }\r\n        if (event.targetTouches[0].clientY - 5 < el.getBoundingClientRect().top)\r\n          {\r\n            scrollBy(el, 0, -5)\r\n          }\r\n    }, false);\r\n  }\r\n\r\n    item.ondrag = handleDrag;\r\n    item.ondragend = handleDrop;\r\n    if (editor.helpers.isMobile()) {  \r\n      let el = item.getElementsByClassName('dot')\r\n      el[0].addEventListener('touchmove', handleDrag, false);\r\n      el[0].addEventListener('touchend', handleDrop, false);\r\n    }\r\n  }\r\n\r\n\r\n  let selectedItem,\r\n   selectedLocX,\r\n   selectedLocY\r\n\r\n   function scrollBy(el, x, y) {\r\n    el.scrollLeft += x;\r\n    el.scrollTop += y;\r\n  }\r\n\r\n  function handleDrag(item) {\r\n    if (editor.helpers.isMobile()) {\r\n      selectedLocX = event.touches[0].clientX\r\n      selectedLocY = event.touches[0].clientY\r\n    }\r\n    selectedItem = item.target\r\n    while (!selectedItem.classList.contains(globalListClass)) {\r\n      selectedItem = selectedItem.parentElement\r\n    }\r\n\r\n    if(!selectedItem.classList.contains(globalListClass) || selectedItem.classList.contains('fr-unchecked')) {\r\n      selectedItem = undefined\r\n      return\r\n    }\r\n    if(editor.helpers.isMobile())\r\n      selectedItem.classList.add('drag-sort-active')\r\n\r\n    return\r\n  }\r\n\r\n  function handleDrop(item) {\r\n    let droppedItem\r\n    if (selectedItem === undefined) {\r\n      return\r\n    }\r\n\r\n    let x, y\r\n\r\n    if (editor.helpers.isMobile()) {\r\n      x = selectedLocX\r\n      y = selectedLocY\r\n      droppedItem = event.target\r\n      while (!droppedItem.classList.contains(globalListClass)) {\r\n        droppedItem = droppedItem.parentElement\r\n      }\r\n    } else {\r\n      x = event.clientX\r\n      y = event.clientY\r\n    }\r\n    //Condition for Firefox and Safari MAC\r\n    if ( !editor.helpers.isMobile() && ( editor.browser.safari || editor.browser.mozilla)) {\r\n      x = globalX\r\n      y = globalY\r\n    }\r\n\r\n    let swapItem = document.elementFromPoint(x, y)\r\n\r\n    while (swapItem && !swapItem.classList.contains(globalListClass)) {\r\n      swapItem = swapItem.parentElement\r\n    }\r\n\r\n    if(swapItem && !swapItem.classList.contains(globalListClass)) {\r\n      swapItem = undefined\r\n    }\r\n    else if (swapItem && selectedItem !== swapItem) {\r\n      swapNodes(selectedItem, swapItem)\r\n    }\r\n    \r\n    if(editor.helpers.isMobile()) {   \r\n      droppedItem.classList.remove('fr-hovered-over-file')\r\n      swapItem.classList.remove('fr-hovered-over-file')\r\n    }\r\n\r\n\r\n  }\r\n\r\n  function swapNodes(n1, n2) {\r\n    var p1 = n1.parentNode;\r\n    var p2 = n2.parentNode;\r\n    var i1, i2;\r\n\r\n    if ( !p1 || !p2 || p1.isEqualNode(n2) || p2.isEqualNode(n1) ) return;\r\n\r\n    for (var i = 0; i < p1.children.length; i++) {\r\n        if (p1.children[i].isEqualNode(n1)) {\r\n            i1 = i;\r\n        }\r\n    }\r\n    for (var i = 0; i < p2.children.length; i++) {\r\n        if (p2.children[i].isEqualNode(n2)) {\r\n            i2 = i;\r\n        }\r\n    }\r\n\r\n    if ( p1.isEqualNode(p2) && i1 < i2 ) {\r\n        i2++;\r\n    }\r\n    p1.insertBefore(n2, p1.children[i1]);\r\n    p2.insertBefore(n1, p2.children[i2]);\r\n}\r\n\r\n  function showFileUploadProgressLayer(i) { \r\n      let $popup = editor.popups.get('filesManager.insert')    \r\n      if(!$popup.find('.fr-upload-progress-layer').hasClass('fr-active')){\r\n        $popup.find('.fr-upload-progress-layer').addClass('fr-active')\r\n      }\r\n\r\n      $popup.find('.fr-upload-progress').removeClass('fr-none')\r\n\r\n      let file = file_list.get(i)\r\n      let description = getFileDescription(new Date())\r\n      let checkedClass = checked_files.get(i) ? '' : 'fr-unchecked '  \r\n      const checkmark = '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"10\" height=\"10\" viewBox=\"0 0 32 32\"><path d=\"M27 4l-15 15-7-7-5 5 12 12 20-20z\" fill=\"#FFF\"></path></svg>'       \r\n      let upload_progress_layer = `\r\n        <div id='fr-file-${i}' class='fr-file-list-item fr-file-${i} ${checkedClass}' draggable = \"${checkedClass ? false : true}\" >\r\n        <div class='fr-file-item-left' >\r\n\r\n    \r\n            <div class=\"fr-file-item-insert-checkbox fr-files-checkbox-line\">\r\n            ${editor.helpers.isMobile() ? `<div id='fr-pick-${i}}' class='dot'>\r\n            </div>`:``}\r\n            <div id=\"checkbox-key-${i}\" class=\"fr-files-checkbox fr-insert-checkbox  fr-checkbox-${i}\">\r\n            <input name=\"target\" class=\"fr-insert-attr fr-checkbox-file-${i} fr-file-insert-check\" data-cmd=\"fileInsertCheckbox\"\r\n             data-checked=\"_blank\" type=\"checkbox\" id=\"fr-link-target-${editor.id}\" tabIndex=\"0\" />\r\n            <span>${checkmark}\r\n            </span>\r\n        </div>\r\n                <label id=\"fr-label-target-${editor.id}\"></label>\r\n            </div>\r\n    \r\n            <div class='fr-file-item-icon fr-file-item-icon-${i}' >\r\n                <img src='https://secure.webtoolhub.com/static/resources/icons/set112/f2afb6f7.png' alt='Image preview' class='thumbnail-padding' height='36px' width='36px' />\r\n            </div>\r\n\r\n            <div class='fr-file-item-description' >\r\n                <div class='fr-file-name fr-files-manager-tooltip'>\r\n                   ${text_truncate(file.name,20)}\r\n                      <span class=\"${ file.name.length > 20 ? 'tooltiptext':'fr-none'}\">${file.name}\r\n                      </span>\r\n                 </div>\r\n                 <div class='fr-file-details'>\r\n                 <div class='fr-file-date'>${description}\r\n                 </div>\r\n \r\n                 <div class='fr-file-size'>\r\n                     ${getFileSize(file.size)}\r\n                 </div>\r\n                 </div>\r\n\r\n                  <div class='fr-file-error'>\r\n                    <h5 class='fr-file-error-h5'></h5>\r\n                 </div>\r\n             </div>\r\n    \r\n        </div>\r\n\r\n        <div class='fr-file-item-right fr-file-item-right-${i}'>` + getFileActionButtons(i) + `</div>\r\n    </div>`;\r\n\r\n    $popup.find('.fr-upload-progress-layer')[0].innerHTML = upload_progress_layer + $popup.find('.fr-upload-progress-layer')[0].innerHTML;\r\n    // adding checked to already checked files\r\n    function addCheck(file, i, map) {\r\n      if (checked_files.get(i)) {\r\n        $popup.find(`input.fr-insert-attr.fr-checkbox-file-${i}`)[0].setAttribute('checked', null)\r\n      }\r\n    }\r\n    file_list.forEach(addCheck)\r\n    autoplayCheckbox.forEach(function(index){\r\n      document.getElementById('fr-file-autoplay-button-' + index).checked = true\r\n    })\r\n    getFileThumbnail(i, file)\r\n    hideProgressBar()\r\n    if(editor.opts.toolbarBottom) \r\n      showInsertPopup(true)\r\n    else\r\n      editor.popups.setPopupDimensions($popup)\r\n      enableDragSort('fr-file-list-item')\r\n\r\n  }\r\n\r\n  function text_truncate(str, length, ending) {\r\n    if (length == null) {\r\n      length = 100;\r\n    }\r\n    if (ending == null) {\r\n      ending = '...';\r\n    }\r\n    if (str.length > length) {\r\n      return str.substring(0, length - ending.length) + ending;\r\n    } else {\r\n      return str;\r\n    }\r\n  }\r\n  \r\n\r\nfunction getFileThumbnailSrc(type){  \r\n  switch (type){ \r\n\r\n    case 'application/msword': \r\n      return editor.icon.getFileIcon('docIcon')\r\n    case 'application/vnd.openxmlformats-officedocument.wordprocessingml.document': \r\n      return editor.icon.getFileIcon('docxIcon')\r\n    case 'image/gif': \r\n      return editor.icon.getFileIcon('gifIcon')\r\n    case 'image/jpeg': \r\n      return editor.icon.getFileIcon('jpegIcon')\r\n    case 'image/jpeg': \r\n      return editor.icon.getFileIcon('jpgIcon')\r\n    case 'type/text': \r\n      return editor.icon.getFileIcon('logIcon')\r\n    case 'video/quicktime': \r\n      return editor.icon.getFileIcon('movIcon') \r\n    case 'audio/mp3': \r\n    case 'audio/mpeg':\r\n      return editor.icon.getFileIcon('mp3Icon')\r\n    case 'video/mp4': \r\n      return editor.icon.getFileIcon('mp4Icon')\r\n    case 'audio/ogg': \r\n      return editor.icon.getFileIcon('oggIcon') \r\n    case 'video/ogg': \r\n      return editor.icon.getFileIcon('ogvIcon')\r\n    case 'application/pdf': \r\n      return editor.icon.getFileIcon('pdfIcon')\r\n    case 'image/png': \r\n      return editor.icon.getFileIcon('pngIcon') \r\n    case 'text/plain': \r\n      return editor.icon.getFileIcon('txtIcon')\r\n    case 'video/webm': \r\n      return editor.icon.getFileIcon('webmIcon')\r\n    case 'image/webp': \r\n      return editor.icon.getFileIcon('webpIcon')\r\n    case 'video/x-ms-wmv': \r\n      return editor.icon.getFileIcon('wmvIcon')\r\n    case 'application/vnd.ms-excel': \r\n      return editor.icon.getFileIcon('xlsIcon')\r\n    case 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': \r\n      return editor.icon.getFileIcon('xlsxIcon')\r\n    case 'application/x-zip-compressed': \r\n    case 'application/zip': \r\n      return editor.icon.getFileIcon('zipIcon')\r\n\r\n    default:\r\n     return editor.icon.getFileIcon('defaultIcon')\r\n   }  \r\n}\r\nfunction getFileThumbnail(index, file, update){\r\n    let $popup = editor.popups.get('filesManager.insert')\r\n    let thumbnail = $popup.find('.fr-file-item-icon-' + index).get(0)\r\n    if (isImage(_getFileType(file)) && _getFileType(file) != 'image/gif' && _getFileType(file) != 'image/webp') {\r\n      if (thumbnail.children[0].localName != 'a') {\r\n        thumbnail.innerHTML = `<a target='_blank' href=''>` + thumbnail.innerHTML + `</a>`\r\n      }\r\n      let thumbnailLink = $popup.find('.fr-file-item-icon-' + index).get(0).children[0]\r\n      let thumbnailImage = thumbnailLink.children[0]\r\n      let reader = new FileReader()\r\n      if (update != null && update) {\r\n        let oldImage = file_list.get(index)\r\n        file.name = oldImage.name\r\n        file_list.set(index, file)\r\n      }\r\n      reader.onloadend = function () {\r\n        $popup.find('.fr-file-item-icon-' + index).get(0).children[0].children[0].src = reader.result\r\n        const binary = atob(reader.result.split(',')[1])\r\n        const array = []\r\n        for (let i = 0; i < binary.length; i++) {\r\n          array.push(binary.charCodeAt(i))\r\n        }\r\n        $popup.find('.fr-file-item-icon-' + index).get(0).children[0].href = window.URL.createObjectURL(new Blob([new Uint8Array(array)], {\r\n          type: _getFileType(file)\r\n        }))\r\n        $popup.find('.fr-file-item-icon-' + index).get(0).classList.add('file-item-thumbnail-hover')\r\n      }\r\n\r\n      if (file) {\r\n        reader.readAsDataURL(file);\r\n      } else {\r\n        let x = getFileThumbnailSrc(_getFileType(file))\r\n        thumbnail.innerHTML = `<svg height=\"40px\" width=\"40px\" viewBox=\"0 0 55 5\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\r\n        ${x.path}\r\n        </svg>`\r\n      }\r\n    } else {\r\n      let x = getFileThumbnailSrc(_getFileType(file))\r\n      thumbnail.innerHTML = `<svg height=\"40px\" width=\"40px\" viewBox=\"0 0 55 55\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\r\n      ${x.path}\r\n      </svg>`\r\n    }\r\n}\r\n\r\n\r\n  function getFileActionButtons(i) {\r\n    let fileActionButtons = ''\r\n\r\n    if(isVideo(_getFileType(file_list.get(i)))){\r\n      let disableAutoplay = 'fr-files-checkbox'\r\n      let disableAutoplayCheckBox = ''\r\n      if(!isFormatSupported(_getFileType(file_list.get(i)))) {\r\n        disableAutoplay = 'fr-checkbox-disabled'\r\n        disableAutoplayCheckBox = 'disabled'\r\n\r\n      }\r\n      const checkmark = '<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"10\" height=\"10\" viewBox=\"0 0 32 32\"><path d=\"M27 4l-15 15-7-7-5 5 12 12 20-20z\" fill=\"#FFF\"></path></svg>'  \r\n      fileActionButtons = `\r\n      <div class=\"fr-files-checkbox-line align-autoplay\">\r\n      <div id=\"checkbox-key-${i}\" class=\"${disableAutoplay} fr-autoplay-checkbox  fr-checkbox-${i}\">  \r\n                   \r\n      <input type=\"checkbox\" id=\"fr-file-autoplay-button-${i}\" class=\"fr-file-button-${i} fr-file-autoplay-button\" data-title=\"Edit\" data-param1=\"${i}\" role=\"button\" ${disableAutoplayCheckBox}/>\r\n\r\n      <span>${checkmark} </span>\r\n      </div>      \r\n      <label  class='fr-autoplay-checkbox-label'>Autoplay </label>\r\n      </div>`\r\n    }\r\n\r\n    let pdf = 'application/pdf'\r\n    let txt = 'text/plain'\r\n    let doc = 'application/msword'\r\n    let docx = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n    let xlsx = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\r\n    let xls = 'application/vnd.ms-excel'\r\n    let log = 'type/text'\r\n\r\n   let disbleView = ''\r\n\r\n   \r\n   if(isAudio(_getFileType(file_list.get(i))) || !isFormatSupported(_getFileType(file_list.get(i)))){\r\n    disableEdit = 'fr-disabled'\r\n   }\r\n    \r\n   if(isVideo(_getFileType(file_list.get(i)))){\r\n    disableEdit = 'fr-disabled'\r\n   }\r\n   \r\n \r\n   if(isFile(_getFileType(file_list.get(i))))\r\n\r\n   {\r\n     disableEdit = 'fr-disabled'\r\n    if(_getFileType(file_list.get(i)) == doc ||  _getFileType(file_list.get(i)) == docx )\r\n    {\r\n      if(editor.opts.googleOptions && !editor.helpers.isMobile())\r\n\r\n        {\r\n          if( editor.opts.googleOptions.API_KEY && editor.opts.googleOptions.CLIENT_ID ){\r\n          disableEdit = ''\r\n          }\r\n        }\r\n    } \r\n    \r\n    if(_getFileType(file_list.get(i)) == txt ||  _getFileType(file_list.get(i)) == doc || _getFileType(file_list.get(i)) == pdf || _getFileType(file_list.get(i)) == docx || _getFileType(file_list.get(i)) == xlsx || _getFileType(file_list.get(i)) == xls || _getFileType(file_list.get(i)) == log)\r\n\r\n    {\r\n     disbleView = ''\r\n    }\r\n   }\r\n   if (_getFileType(file_list.get(i)) === 'video/url') { \r\n     disableEdit = 'fr-disabled' \r\n   }\r\n    fileActionButtons += `<div class='fr-file-item-action-buttons' >\r\n                <button type=\"button\" id=\"fr-file-insert-button-${i}\" class=\" fr-doc-edit-${i} fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \r\n                fr-file-button-${i} fr-file-insert-button-${i} fr-file-insert-button\" data-cmd=\"imageInsertByUpload\" data-title=\"Insert\" data-param1=\"${i}\" tabIndex=\"2\" role=\"button\">\r\n                <svg style='margin:0px !important; opacity:0.9' class = \"fr-svg\" focusable=\"false\" width=\"16px\" height=\"16px\" viewBox = \"-5 0 28 28\" xlmns = \"http://w3.org/200/svg\"><path d = 'M 9.25 12 L 6.75 12 C 6.335938 12 6 11.664062 6 11.25 L 6 6 L 3.257812 6 C 2.703125 6 2.425781 5.328125 2.820312 4.933594 L 7.570312 0.179688 C 7.804688 -0.0546875 8.191406 -0.0546875 8.425781 0.179688 L 13.179688 4.933594 C 13.574219 5.328125 13.296875 6 12.742188 6 L 10 6 L 10 11.25 C 10 11.664062 9.664062 12 9.25 12 Z M 16 11.75 L 16 15.25 C 16 15.664062 15.664062 16 15.25 16 L 0.75 16 C 0.335938 16 0 15.664062 0 15.25 L 0 11.75 C 0 11.335938 0.335938 11 0.75 11 L 5 11 L 5 11.25 C 5 12.214844 5.785156 13 6.75 13 L 9.25 13 C 10.214844 13 11 12.214844 11 11.25 L 11 11 L 15.25 11 C 15.664062 11 16 11.335938 16 11.75 Z M 12.125 14.5 C 12.125 14.15625 11.84375 13.875 11.5 13.875 C 11.15625 13.875 10.875 14.15625 10.875 14.5 C 10.875 14.84375 11.15625 15.125 11.5 15.125 C 11.84375 15.125 12.125 14.84375 12.125 14.5 Z M 14.125 14.5 C 14.125 14.15625 13.84375 13.875 13.5 13.875 C 13.15625 13.875 12.875 14.15625 12.875 14.5 C 12.875 14.84375 13.15625 15.125 13.5 15.125 C 13.84375 15.125 14.125 14.84375 14.125 14.5 Z M 14.125 14.5 '></path></svg>\r\n                </button>\r\n\r\n                <button type=\"button\" id=\"fr-file-edit-button-${i}\" class=\" fr-doc-edit-${i} ${disableEdit} fr-img-icon fr-btn fr-command fr-submit \r\n                fr-file-action-icons fr-file-edit-button-${i} fr-file-button-${i} fr-file-edit-button\" data-cmd=\"editImage\" data-title=\"Edit\" data-param1=\"${i}\" role=\"button\">\r\n                <svg style='margin:0px !important; opacity:0.9' class = \"fr-svg\" focusable=\"false\" width=\"16px\" height=\"16px\" viewBox = \"0 4 25 25\" xlmns = \"http://w3.org/200/svg\"><path d = 'M17,11.2L12.8,7L5,14.8V19h4.2L17,11.2z M7,16.8v-1.5l5.6-5.6l1.4,1.5l-5.6,5.6H7z M13.5,6.3l0.7-0.7c0.8-0.8,2.1-0.8,2.8,0  c0,0,0,0,0,0L18.4,7c0.8,0.8,0.8,2,0,2.8l-0.7,0.7L13.5,6.3z'></path></svg>\r\n                </button>\r\n                \r\n                <span class=\"fr-file-view-${i}\"><button type=\"button\" id=\"fr-file-view-button-${i}\" class=\" fr-doc-edit-${i} ${disbleView} fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \r\n                fr-file-view-button-${i} fr-file-view-button\" data-cmd=\"viewImage\" data-title=\"View\" data-param1=\"${i}\" tabIndex=\"2\" role=\"button\">\r\n                <svg style='margin:0px !important; opacity:0.9' class = \"fr-svg\" focusable=\"false\" width=\"16px\" height=\"16px\" viewBox = \"15 19 21 21\" xlmns = \"http://w3.org/200/svg\"> <path style=\"fill:none;stroke-width:0.9077;stroke-linecap:round;stroke-linejoin:round;stroke:rgb(0%,0%,0%);stroke-opacity:1;stroke-miterlimit:10;\" d=\"M 19.086094 16.541466 C 16.185625 16.541466 14.318281 19.447115 14.318281 19.447115 L 14.318281 19.555288 C 14.318281 19.555288 16.176719 22.475962 19.077187 22.475962 C 21.977656 22.475962 23.847969 19.576322 23.847969 19.576322 L 23.847969 19.465144 C 23.847969 19.465144 21.989531 16.541466 19.086094 16.541466 Z M 19.07125 21.024639 C 18.248906 21.024639 17.583906 20.357572 17.583906 19.53726 C 17.583906 18.716947 18.248906 18.04988 19.07125 18.04988 C 19.890625 18.04988 20.555625 18.716947 20.555625 19.53726 C 20.555625 20.357572 19.890625 21.024639 19.07125 21.024639 Z M 19.07125 21.024639 \" transform=\"matrix(1.315789,0,0,1.3,0,0)\"/></svg></button></span>\r\n\r\n                <button type=\"button\" id=\"fr-file-delete-button-${i}\" class=\" fr-doc-edit-${i} fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons\r\n                fr-file-button-${i} fr-file-delete-button\" data-cmd=\"deleteImage\" data-title=\"Delete\" data-param1=\"${i}\" role=\"button\">\r\n                <svg style='margin:0px !important; opacity:0.9' class = \"fr-svg\" focusable=\"false\" width=\"16px\" height=\"16px\" viewBox = \"-2 3 30 30\" xlmns = \"http://w3.org/200/svg\"><path d = 'M15,10v8H9v-8H15 M14,4H9.9l-1,1H6v2h12V5h-3L14,4z M17,8H7v10c0,1.1,0.9,2,2,2h6c1.1,0,2-0.9,2-2V8z'></path></svg>\r\n                </button>\r\n                 \r\n            </div>\r\n            <div id=\"user_area-${i}\" style=\"display: none;\">\r\n            \r\n              <div id=\"file_container\"></div>\r\n\r\n              <div style='display:block;text-align: center; margin-left:50%; id='edit-file-loader' class='fr-file-loader'></div>\r\n\r\n          </div> \r\n            `\r\n  \r\n    return fileActionButtons\r\n  }\r\n \r\n  function updateFileUploadingProgress(percent, index, loaded){\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    if(!loaded && percent <= 100){\r\n      $popup.find('.fr-checkbox-file-'+index).get(0).disabled = true\r\n      $popup.find('.fr-checkbox-'+index).get(0).classList.remove('fr-files-checkbox')\r\n      $popup.find('.fr-checkbox-'+index).get(0).classList.add('fr-checkbox-disabled')\r\n      const row = $popup.find('.fr-file-progress-circle-'+index)\r\n      const progressCircle = $popup.find('.fr-file-upload-percent-'+index)\r\n      if (percent > 50) {\r\n        row.get(0).setAttribute('class', 'fr-file-progress-circle-'+index + ' progress-circle p' + Math.floor(percent) + ' over50');\r\n        progressCircle.get(0).innerHTML = Math.floor(percent) + '%';\r\n      } else {\r\n        row.get(0).setAttribute('class', 'fr-file-progress-circle-'+index + ' progress-circle p' + Math.floor(percent));\r\n        progressCircle.get(0).innerHTML = Math.floor(percent) + '%';\r\n      }\r\n      updateProgressBar(index, percent, loaded)\r\n      return\r\n    }\r\n    if(loaded){\r\n      $popup.find('.fr-checkbox-file-'+index).get(0).disabled = false\r\n      $popup.find('.fr-checkbox-'+index).get(0).classList.remove('fr-checkbox-disabled')\r\n      $popup.find('.fr-checkbox-'+index).get(0).classList.add('fr-files-checkbox')\r\n      const right = $popup.find('.fr-file-item-right-'+index)\r\n      right.get(0).innerHTML = getFileActionButtons(index)\r\n      updateProgressBar(index, 100, loaded)\r\n    }\r\n  }\r\n\r\n  function initialFileUploadStatus(index){\r\n    if (isNaN(index)) {\r\n      return\r\n    }\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    const row = $popup.find('.fr-file-item-right-'+index)\r\n    row.get(0).innerHTML = `<div class='fr-file-item-action-buttons' >\r\n    <button type=\"button\" id=\"fr-file-cancel-upload-button-${index}\" class=\"fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \r\n    fr-file-button-${index} fr-file-cancel-upload-button\" data-cmd=\"cancelUpload\" data-title=\"Cancel\" data-param1=\"${index}\" role=\"button\">\r\n    <svg style='margin:0px !important; opacity:0.9' class = \"fr-svg\" focusable=\"false\" width=\"16px\" height=\"16px\" viewBox = \"-2 3 30 30\" xlmns = \"http://w3.org/200/svg\"><path d = 'M13.4,12l5.6,5.6L17.6,19L12,13.4L6.4,19L5,17.6l5.6-5.6L5,6.4L6.4,5l5.6,5.6L17.6,5L19,6.4L13.4,12z'></path></svg>\r\n    </button>\r\n\r\n    <button type=\"button\" id=\"fr-upload-delete-button-${index}\" class=\"fr-img-icon fr-btn fr-command fr-submit fr-file-action-icons \r\n    fr-file-button-${index} fr-upload-delete-button\" data-cmd=\"deleteUpload\" data-title=\"Delete\" data-param1=\"${index}\" role=\"button\">\r\n    <svg style='margin:0px !important; opacity:0.9' class = \"fr-svg\" focusable=\"false\" width=\"16px\" height=\"16px\" viewBox = \"-2 3 30 30\" xlmns = \"http://w3.org/200/svg\"><path d = 'M15,10v8H9v-8H15 M14,4H9.9l-1,1H6v2h12V5h-3L14,4z M17,8H7v10c0,1.1,0.9,2,2,2h6c1.1,0,2-0.9,2-2V8z'></path></svg>\r\n    </button>\r\n\r\n    <div class='progress-circle p0 fr-file-progress-circle-${index}'>\r\n                  <span class='fr-file-upload-percent-${index} fr-file-upload-percent'>0%</span>\r\n                  <div class='left-half-clipper'>\r\n                    <div class='first50-bar'></div>\r\n                    <div class='value-bar'></div>\r\n                  </div>\r\n                </div>\r\n            </div>`\r\n    \r\n    fileUploads.set(index,0)\r\n  }\r\n\r\n  function updateProgressBar(index, percent, loaded){\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n\r\n    $popup.find('.fr-progress-bar').removeClass('fr-none').addClass('fr-display-block')\r\n\r\n    if($popup.find('.fr-upload-progress').hasClass('fr-height-set'))\r\n      editor.popups.setFileListHeight($popup)\r\n    \r\n    let totalUploadPercent = 0;\r\n    fileUploads.set(index, percent)\r\n    fileUploads.forEach(function(value, index){\r\n      totalUploadPercent += value\r\n    })\r\n    totalUploadPercent = totalUploadPercent/fileUploads.size\r\n    if(percent == 100 && loaded){\r\n      completedUploads++;\r\n    }\r\n    $popup.find('.fr-command[data-cmd=\"filesUpload\"]').addClass('fr-disabled')\r\n    $popup.find('.fr-command[data-cmd=\"filesByURL\"]').addClass('fr-disabled')\r\n    $popup.find('.fr-command[data-cmd=\"filesEmbed\"]').addClass('fr-disabled')\r\n    $popup.find('.fr-progress-bar').get(0).style.width = totalUploadPercent+'%'\r\n    if(completedUploads == fileUploads.size){\r\n      $popup.find('.fr-progress-bar').removeClass('fr-display-block').addClass('fr-none') \r\n      fileUploads = new Map()\r\n      completedUploads = 0\r\n      $popup.find('.fr-command[data-cmd=\"filesUpload\"]').removeClass('fr-disabled')\r\n      $popup.find('.fr-command[data-cmd=\"filesByURL\"]').removeClass('fr-disabled')\r\n      $popup.find('.fr-command[data-cmd=\"filesEmbed\"]').removeClass('fr-disabled')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Insert image using URL callback.\r\n   */\r\n  function validURL(str) {\r\n    var pattern = new RegExp('^(https?:\\\\/\\\\/)?'+ // protocol\r\n      '((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|'+ // domain name\r\n      '((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))'+ // OR ip (v4) address\r\n      '(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*'+ // port and path\r\n      '(\\\\?[;&a-z\\\\d%_.~+=-]*)?'+ // query string\r\n      '(\\\\#[-a-z\\\\d_]*)?$','i'); // fragment locator\r\n    return !!pattern.test(str);\r\n  }\r\n  function insertByURL() {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    const $input = $popup.find('.fr-files-by-url-layer input')\r\n    let urls = $input.val().trim().split(/[ ,]+/)\r\n    let $urls =[]\r\n    let j=0\r\n    for( let i=0; i<urls.length;i++)\r\n    {\r\n      \r\n      if(validURL(urls[i]))\r\n      {\r\n        $urls[j]=urls[i]\r\n        j++\r\n      }\r\n    }\r\n    if($urls.length == 0)\r\n    {\r\n      _showErrorMessage(editor.language.translate('Url entered is invalid. Please try again.'));\r\n      return\r\n    }\r\n    if ($input.val().trim().length > 0 && $urls.length > 0) {\r\n      var files = []\r\n      var files_index = []\r\n      var initial_index = fileListIndex\r\n      var validUrls = $urls.length\r\n      $urls.forEach(function (url, index) {\r\n        if (url.trim().length == 0){\r\n          --validUrls\r\n          if (fileListIndex == initial_index + validUrls) {\r\n            addFilesToList(files, files_index)\r\n          }\r\n        }\r\n        else {\r\n          hideProgressBar()\r\n          showProgressBar()\r\n          _setProgressMessage(editor.language.translate('Loading file(s)'))\r\n\r\n          const file_url = url.trim()\r\n\r\n          // check if URL is a video\r\n          let video = getVideoByURL(file_url)\r\n          if (video) {\r\n            let obj = {\r\n              link: file_url,\r\n              name: file_url,\r\n              type: 'video/url',\r\n              size: 2,\r\n              video: video\r\n            }\r\n            file_list.set(initial_index + index, obj)\r\n            showFileUploadProgressLayer(initial_index + index)\r\n            hideProgressBar()\r\n            showProgressBar()\r\n            _setProgressMessage(editor.language.translate('Loading file(s)'))\r\n            file_list_values.set(initial_index + index, obj)\r\n            ++fileListIndex\r\n            if (fileListIndex == initial_index + validUrls) {\r\n              addFilesToList(files, files_index)\r\n            }\r\n          } else {\r\n            const xhr = new XMLHttpRequest()\r\n            xhr.onload = function () {\r\n\r\n              if (this.status == 200) {\r\n                let file = new Blob([this.response], {\r\n                  type: this.response.type || ''\r\n                })\r\n                file.name = getUrlFileName(file_url)\r\n                file.link = file_url\r\n                if (isImage(this.response.type)) {\r\n                  file.sanitize = true\r\n                  file.existing_image = $current_image\r\n                } else if (isFile(this.response.type)) {\r\n                  file.text = getUrlFileName(file_url)\r\n                }\r\n                files.push(file)\r\n                files_index.push(initial_index + index)\r\n                file_list.set(initial_index + index, file)\r\n                showFileUploadProgressLayer(initial_index + index)\r\n                if(unsupported_file_types.indexOf(_getFileType(file)) > -1 || !_getFileType(file)){\r\n                  _throwError(BAD_FILE_TYPE, null, null, initial_index + index)\r\n                }\r\n              } else {\r\n                let file = new Blob([this.response], {\r\n                  type: this.response.type || ' '\r\n                })\r\n                file.name = getUrlFileName(file_url)\r\n                file.link = file_url\r\n                file_list.set(initial_index + index, file)\r\n                showFileUploadProgressLayer(initial_index + index)\r\n                _throwError(BAD_LINK, this.response, $current_image, initial_index + index)\r\n              }\r\n              hideProgressBar()\r\n              showProgressBar()\r\n              _setProgressMessage(editor.language.translate('Loading file(s)'))\r\n              ++fileListIndex\r\n              if (fileListIndex == initial_index + validUrls) {\r\n                addFilesToList(files, files_index)\r\n              }\r\n            }\r\n\r\n            // If file couldn't be uploaded, insert as it is.\r\n            xhr.onerror = function () {\r\n              let obj = {\r\n                link: file_url,\r\n                name: getUrlFileName(file_url),\r\n                size: 0,\r\n                type: ''\r\n              }\r\n              _throwError(ERROR_LINK, this.response, $current_image, initial_index + index)\r\n              let file_index = fileListIndex\r\n              file_list.set(file_index, obj)\r\n              showFileUploadProgressLayer(file_index)\r\n              hideProgressBar()\r\n              showProgressBar()\r\n              _setProgressMessage(editor.language.translate('Loading file(s)'))\r\n              ++fileListIndex\r\n              if (fileListIndex == initial_index + validUrls) {\r\n                addFilesToList(files, files_index)\r\n              }\r\n            }\r\n\r\n            xhr.open('GET', `${editor.opts.imageCORSProxy}/${file_url}`, true)\r\n            xhr.responseType = 'blob'\r\n\r\n            xhr.send()\r\n          }\r\n        }\r\n      });\r\n      $input.val('')\r\n      $input.blur()\r\n    }\r\n  }\r\n    \r\n  function addFilesToList(files, files_index) {\r\n    hideProgressBar()\r\n    let $popup = editor.popups.get('filesManager.insert')\r\n    $popup.find('.fr-upload-progress-layer').addClass('fr-active')\r\n    files.forEach(function (file, i) {\r\n      // If image needs to be uploaded\r\n      if (isImage(_getFileType(file)) && editor.opts.imageUploadRemoteUrls && editor.opts.imageCORSProxy && editor.opts.imageUpload) {\r\n        upload(file, files, $current_image, files_index[i])\r\n      } else {\r\n        file_list_values.set(files_index[i], file)\r\n      }\r\n    })\r\n  }\r\n\r\n  function getVideoByURL(link) {\r\n    if (typeof link == 'undefined') {\r\n      return link\r\n    }\r\n\r\n    let video = null\r\n\r\n    if (!/^http/.test(link)) {\r\n      link = `https://${link}`\r\n    }\r\n\r\n    if (editor.helpers.isURL(link)) {\r\n      for (let i = 0; i < FE.VIDEO_PROVIDERS.length; i++) {\r\n        const vp = FE.VIDEO_PROVIDERS[i]\r\n\r\n        // Check if video provider is allowed.\r\n        if (vp.test_regex.test(link) && (new RegExp(editor.opts.videoAllowedProviders.join('|'))).test(vp.provider)) {\r\n          video = link.replace(vp.url_regex, vp.url_text)\r\n          video = vp.html.replace(/\\{url\\}/, video)\r\n          break\r\n        }\r\n      }\r\n    }\r\n    return video\r\n  }\r\n\r\n  function _editImg($img) {\r\n    if ($img && $img.get) {\r\n      _edit.call($img.get(0))\r\n    }\r\n  }\r\n\r\n  function viewImage(index) {\r\n    if(!isFormatSupported(_getFileType(file_list_values.get(index)))){\r\n      let link = file_list_values.get(index).link\r\n      let text = file_list_values.get(index).link\r\n      if(file_list.get(index) && file_list.get(index).name){\r\n        text = file_list.get(index).name\r\n      } else if(file_list_values.get(index).text){\r\n        text = file_list_values.get(index).text\r\n      }\r\n      if(link.indexOf('blob:') === 0 && editor.browser.msie && window.navigator && window.navigator.msSaveBlob){\r\n        window.navigator.msSaveBlob(file_list.get(index), text);\r\n      }\r\n      else{\r\n        let el = document.createElement('a');\r\n        el.href = link;\r\n        el.download = text;\r\n        el.click()\r\n      }\r\n      return false\r\n    }\r\n    let $popup = editor.popups.get('filesManager.insert')\r\n    if ($popup.find('.fr-file-view-image-' + index).length > 0) {\r\n      $popup.find('.fr-file-view-image-' + index)[0].remove()\r\n    } else {\r\n      const viewImages = $popup.find('.fr-file-view')\r\n      for (let i = 0; i < viewImages.length; i++) {\r\n        viewImages.get(i).remove()\r\n      }\r\n      let imageView = $popup.find('.fr-file-view-' + index)\r\n\r\n      if (isImage(_getFileType(file_list_values.get(index)))) {\r\n\r\n        let image = `<div class=\"fr-file-view-modal\">\r\n              <div class=\"fr-file-view-modal-content\">\r\n              <div class=\"fr-file-view-close\">&times;</div> \r\n                <img src=\"` + file_list_values.get(index).link + `\" class ='fr-file-view-image'/>\r\n                </div>\r\n              </div>`\r\n        imageView[0].innerHTML = image + imageView[0].innerHTML\r\n\r\n      } else if (isVideo(_getFileType(file_list_values.get(index)))) {\r\n\r\n        let image\r\n        if (file_list_values.get(index).hasOwnProperty('video')) {\r\n          let videoIframe = file_list_values.get(index).video.substring(file_list_values.get(index).video.indexOf('src') + 3)\r\n          let url = videoIframe.substring(videoIframe.indexOf('\"') + 1)\r\n          url = url.substring(0, url.indexOf('\"'))\r\n          let autoplayURL = url + '&autoplay=1'\r\n          image = `<div class=\"fr-file-view-modal\">\r\n        <div class=\"fr-file-view-modal-content \">\r\n          <div class=\"fr-file-view-close\">&times;</div> \r\n          <iframe width=\"640\" height=\"360\" src=\"${autoplayURL}\" frameborder=\"0\" class = \"fr-file-view-image\"></iframe>\r\n        </div>\r\n      </div>`\r\n        } else {\r\n          image = `<div class=\"fr-file-view-modal\">\r\n          <div class=\"fr-file-view-modal-content \">\r\n            <div class=\"fr-file-view-close\">&times;</div> \r\n            <video controls src=\"` + file_list_values.get(index).link + `\"  class ='fr-file-view-image' autoplay></video>\r\n          </div>\r\n        </div>`\r\n        }\r\n        imageView[0].innerHTML = image + imageView[0].innerHTML\r\n\r\n      } else if (isAudio(_getFileType(file_list_values.get(index)))) {\r\n\r\n        let image = `<div class=\"fr-file-view-modal\">\r\n        <div class=\"fr-file-view-modal-content \">\r\n          <div  class=\"fr-file-view-close\">&times;</div> \r\n          <audio controls=\"controls\"  class ='fr-file-view-image' autoplay>\r\n\r\n          <source src=\"${file_list_values.get(index).link}\" type=\"${_getFileType(file_list_values.get(index))}\" />\r\n\r\n            Your browser does not support the audio element.\r\n          </audio>\r\n        </div>\r\n      </div>`\r\n        imageView[0].innerHTML = image + imageView[0].innerHTML\r\n\r\n      } else if (isFile(_getFileType(file_list_values.get(index)))) {\r\n\r\n        let link = file_list_values.get(index).link\r\n        let text = file_list_values.get(index).text\r\n        if (link.endsWith('.pdf') || link.endsWith('.txt')) {\r\n          let image = `<div class=\"fr-file-view-modal\">\t\r\n              <div class=\"fr-file-view-modal-content \" >\t\r\n              <div class=\"fr-file-view-close\">&times;</div> \t\r\n              <iframe src=\"${link}\" style='background-color: white;' height='50%' width='50%' title=\"${text}\" class=\"fr-file fr-file-view-image\"></iframe>\t\r\n            </div>\t\r\n            </div>`\r\n          imageView[0].innerHTML = image + imageView[0].innerHTML\r\n        } else {\r\n          if(link.indexOf('blob:') === 0 && editor.browser.msie && window.navigator && window.navigator.msSaveBlob){\r\n            window.navigator.msSaveBlob(file_list.get(index), text);\r\n          }\r\n          else{\r\n            let el = document.createElement('a');\r\n            el.href = link;\r\n            el.download = text;\r\n            el.click()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function _loadedCallback() {\r\n    const $img = $(this)\r\n\r\n    $img.removeClass('fr-uploading')\r\n\r\n    // Select the image.\r\n    if ($img.next().is('br')) {\r\n      $img.next().remove()\r\n    }\r\n\r\n    if(fileKeys.length == 0 || (fileKeys.length > 0 && fileKeys.length == imageEditIndex)){\r\n      editImageValue = $img\r\n    }\r\n    if($img.get(0).tagName == 'VIDEO' || $img.get(0).tagName == 'AUDIO') {\r\n      editor.selection.setAfter($img.parent())\r\n    }\r\n    else {\r\n      editor.selection.setAfter($img)\r\n    }\r\n\r\n    editor.undo.saveStep()\r\n    editor.events.trigger('filesManager.loaded', [$img])\r\n    insertFiles(fileKeys)\r\n  }\r\n\r\n   /**\r\n   * Keep videos in sync when content changed.\r\n   */\r\n  let videos \r\n\r\n  function _syncVideos() {\r\n\r\n    // Get current videos.\r\n    const c_videos = Array.prototype.slice.call(editor.el.querySelectorAll('video, .fr-video > *')) \r\n\r\n    // Current videos src.\r\n    const video_srcs = [] \r\n    let i \r\n\r\n    for (i = 0; i < c_videos.length; i++) {\r\n      video_srcs.push(c_videos[i].getAttribute('src')) \r\n\r\n      $(c_videos[i]).toggleClass('fr-draggable', editor.opts.videoMove) \r\n\r\n      if (c_videos[i].getAttribute('class') === '') c_videos[i].removeAttribute('class') \r\n\r\n      if (c_videos[i].getAttribute('style') === '') c_videos[i].removeAttribute('style') \r\n    }\r\n\r\n    // Loop previous videos and check their src.\r\n    if (videos) {\r\n      for (i = 0; i < videos.length; i++) {\r\n        if (video_srcs.indexOf(videos[i].getAttribute('src')) < 0) {\r\n          editor.events.trigger('video.removed', [$(videos[i])]) \r\n        }\r\n      }\r\n    }\r\n\r\n    // Current videos are the old ones.\r\n    videos = c_videos \r\n  }\r\n\r\n\r\n  let files\r\n\r\n  function _syncFiles() {\r\n\r\n    // Get current files.\r\n    const c_files = Array.prototype.slice.call(editor.el.querySelectorAll('a.fr-file'))\r\n\r\n    // Current files src.\r\n    const file_srcs = []\r\n    let i\r\n\r\n    for (i = 0; i < c_files.length; i++) {\r\n      file_srcs.push(c_files[i].getAttribute('href'))\r\n    }\r\n\r\n    // Loop previous files and check their src.\r\n    if (files) {\r\n      for (i = 0; i < files.length; i++) {\r\n        if (file_srcs.indexOf(files[i].getAttribute('href')) < 0) {\r\n          editor.events.trigger('file.unlink', [files[i]])\r\n        }\r\n      }\r\n    }\r\n\r\n    // Current files are the old ones.\r\n    files = c_files\r\n  }\r\n\r\n  /**\r\n   * Insert all files into the editor.\r\n   */\r\n\r\n   function insertAllFiles()\r\n   {\r\n    fileKeys = []\r\n    const $popup = editor.popups.get('filesManager.insert')  \r\n    function insertMapElements(el, index, map) {      \r\n      if(el.children['target'].checked)\r\n        {\r\n          fileKeys.push(parseInt(el.id.split('-').pop()))\r\n          if(isImage(file_list_values.get(parseInt(el.id.split('-').pop())).type) && imageEditIndex == -1){\r\n            imageEditIndex = index\r\n          }\r\n        }\r\n     }\r\n     imageEditIndex = -1\r\n     editImageValue = null\r\n     $popup.find('.fr-insert-checkbox').toArray().forEach(insertMapElements)\r\n     insertFiles(fileKeys)\r\n    checkInsertAllState()\r\n  }\r\n\r\n   /**\r\n   * Delete all files.\r\n   */\r\n\r\n  function deleteAllFiles()\r\n  {\r\n   const $popup = editor.popups.get('filesManager.insert')  \r\n   function deleteMapElements(el, index, map) {\r\n     if(el.children['target'].checked)\r\n       {\r\n         let fileIndex = parseInt(el.id.split('-').pop())\r\n         if(XMLHttpRequests.has(fileIndex)){\r\n          XMLHttpRequests.delete(fileIndex)\r\n         }\r\n         deleteFile(fileIndex)\r\n       }\r\n    }\r\n    $popup.find('.fr-insert-checkbox').toArray().forEach(deleteMapElements)\r\n    checkInsertAllState()\r\n  }\r\n\r\n   function insertFiles(fileKeys){\r\n     if(fileKeys != null){\r\n     if(fileKeys.length == 0){\r\n       if(editImageValue != null){\r\n         if(editImageValue.get(0).tagName == 'VIDEO'){\r\n           editor.video._editVideo(editImageValue.parent())\r\n         }\r\n         else if(editImageValue.get(0).tagName == 'IMG'){\r\n          editor.image.edit(editImageValue)\r\n         }\r\n         else{\r\n           editImageValue.trigger('click')\r\n         }\r\n         editor.toolbar.disable()\r\n        } \r\n        return\r\n      }\r\n        let index = fileKeys.shift()\r\n        insert(index, fileKeys)\r\n      }\r\n    }\r\n    \r\n  function isChildWindowOpen() {\r\n    return $child_window_open\r\n  }\r\n\r\n  function setChildWindowState(childWindowState) {\r\n    if(childWindowState !== undefined) {\r\n      $child_window_open = childWindowState\r\n    }    \r\n  }\r\n // file edit task starts\r\n\r\n var docEditor;  \r\n\r\n function loadScripts(array,callback){\r\n   var loader = function(src,handler){\r\n       var script = document.createElement(\"script\");\r\n       script.src = src;\r\n       script.onload = function() { \r\n         this.onload=function(){};docEditor.handleClientLoad();\r\n       }\r\n       script.onreadystatechange = function(){\r\n         if (this.readyState === 'complete') this.onload();\r\n       }\r\n       var head = document.getElementsByTagName(\"head\")[0];\r\n       (head || document.body).appendChild( script );\r\n   };\r\n   (function run(){\r\n       if(array.length!=0){\r\n           loader(array.shift(), run);\r\n       }else{\r\n           callback && callback();\r\n       }\r\n   })();\r\n}\r\n\r\n  /**\r\n   * Edit Image\r\n   */\r\n  function editImage(index) {\r\n    let isChildWindowTriggered = false\r\n\r\n    if (isVideo(_getFileType(file_list_values.get(index)))) {\r\n      editor.trimVideoPlugin.trimVideo(file_list.get(index), index,file_list);\r\n      isChildWindowTriggered = true\r\n    }else if(isImage(_getFileType(file_list_values.get(index)))){\r\n\r\n      let src = file_list_values.get(index).link;\r\n      const image = editor.o_doc.createElement('img');\r\n      image.src = src;\r\n      $current_image = image;\r\n      $current_image_index = index;\r\n      editor.imageTUI.launch(editor, false, index);\r\n      isChildWindowTriggered = true\r\n\r\n    }else if(isFile(_getFileType(file_list_values.get(index)))){\r\n\r\n      \r\n    var options={\r\n      apiKey: editor.opts.googleOptions.API_KEY, // google developer console API Key\r\n      clientId:editor.opts.googleOptions.CLIENT_ID, // google developer client ID\r\n      authorizeButton: `authorize_button-${index}`, // authorize in Google button element ID\r\n      signoutButton: 'signout_button', // sign out button element ID\r\n      userArea: `user_area-${index}`, // authorized user HTML container element ID \r\n      fileInput: 'file_input', // file upload input ID\r\n      fileIndex: index, // created\r\n      file: file_list.get(index), // created//, type=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"),\r\n      fileContainer: 'file_container', // HTML container ID for file editor \r\n      loadingText: 'File is being uploaded...', // text that shown while file is loaded\r\n      events: {\r\n        onInvalidFile: function(text){console.log(text);}, // fired if file is not uploaded or not supported (supported files are .DOC and .DOCX)\r\n        onError: function(error){console.log(error);} // fired in case of any other errors\r\n      }\r\n   }   \r\n    docEditor = googleDocEditor(options);\r\n         loadScripts([\r\n        \"https://apis.google.com/js/api.js\"\r\n     ],function(){\r\n         console.log('All things are loaded');\r\n     });\r\n    }\r\n    if (isChildWindowTriggered) {\r\n      $child_window_open = true\r\n    } \r\n  }\r\n\r\n  /**GoogleDocEdit Code */\r\n  function googleDocEditor(options){\r\n\r\n    // Array of API discovery doc URLs for APIs used by the quickstart\r\n    var DISCOVERY_DOCS = [\"https://www.googleapis.com/discovery/v1/apis/drive/v2/rest\"];\r\n    // Authorization scopes required by the API; multiple scopes can be\r\n    // included, separated by spaces.\r\n    var SCOPES = 'https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.appdata';\r\n    var DEFAULT_FIELDS = 'id,title,mimeType,userPermission,editable,copyable,shared,fileSize';\r\n    var BOUNDARY = '-------314159265358979323846';\r\n    var DELIMITER = \"\\r\\n--\" + BOUNDARY + \"\\r\\n\";\r\n    var CLOSE_DELIMITER = \"\\r\\n--\" + BOUNDARY + \"--\";\r\n    var ALLOWED_FILES = ['doc', 'docx'];\r\n    var authorizeButton = document.getElementById(options.authorizeButton);\r\n    var userArea = document.getElementById(options.userArea);\r\n    var fileIndex = fileIndex; //created\r\n    var responseFileId; //created\r\n    \r\n    if (!options.events) {\r\n      options.events = {};\r\n    }\r\n    \r\n    options.events.onInvalidFile = options.events.onInvalidFile || function(text){console.log(text);};\r\n    options.events.onError = options.events.onError || function(text){console.log(text);};\r\n    /**\r\n        *  Initializes the API client library and sets up sign-in state\r\n        *  listeners.\r\n        */\r\n    function initClient() {\r\n      gapi.client.init({\r\n        apiKey: options.apiKey,\r\n        clientId: options.clientId,\r\n        discoveryDocs: DISCOVERY_DOCS,\r\n        scope: SCOPES\r\n          }).then(function () {\r\n            // Listen for sign-in state changes.\r\n            gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);\r\n            // Handle the initial sign-in state.\r\n            updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());\r\n            handleAuthClick();\r\n          }, function(error) {\r\n          options.events.onError(error);\r\n          });\r\n      }\r\n\r\n  /**\r\n       *  Called when the signed in status changes, to update the UI\r\n       *  appropriately. After a sign-in, the API is called.\r\n       */\r\n    function updateSigninStatus(isSignedIn) {\r\n        if (isSignedIn) {\r\n         userArea.style.display = 'block';\r\n        } \r\n      }\r\n\r\n    /**\r\n      *  Sign in the user upon button click.\r\n      */\r\n    function handleAuthClick(event) {\r\n      if(!gapi.auth2.getAuthInstance().isSignedIn.get() || (gapi.auth.getToken() !== undefined && gapi.auth.getToken().access_token === undefined)){ \r\n        Promise.resolve(gapi.auth2.getAuthInstance().signIn()).then(function(){\r\n        handleFileUpload();\r\n      })}\r\n      else{\r\n        handleFileUpload();\r\n      }\r\n     \r\n    }\r\n\r\n    /**\r\n      *  Sign out the user upon button click.\r\n      */\r\n    function handleSignoutClick(event) {\r\n      var accessToken = gapi.auth.getToken().access_token;\r\n      var id = responseFileId;\r\n      var url = \"https://docs.google.com/feeds/download/documents/export/Export?id=\" + id + \"&format=docx&access_token=\" + accessToken;\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open('get', url);\r\n      xhr.responseType = \"arraybuffer\";\r\n      xhr.onload = function() {   \r\n        var link =new Blob([new Uint8Array(this.response)], {\r\n        type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\r\n        });\r\n\r\n        const currentFile=file_list.get(options.fileIndex)\r\n        link.name = currentFile.name;\r\n        link.lastModified = currentFile.lastModified;\r\n        link.lastModifiedDate = currentFile.lastModifiedDate;\r\n        file_list.set(options.fileIndex, link);\r\n        editor.filesManager.upload(\r\n          link,\r\n          file_list_values,\r\n          $current_image,\r\n          options.fileIndex\r\n          ); \r\n          closeEditDocContainer();\r\n        };\r\n      xhr.send();\r\n    return\r\n  }\r\n    \r\n    /**\r\n      * Handles file uploaded event\r\n      */\r\n    function handleFileUpload(event) {\r\n      disableOnEdit(options.fileIndex)\r\n      var file = options.file; //created\r\n      if (!file) {\r\n        options.events.onInvalidFile(\"File is not selected\");\r\n        return;\r\n      }\r\n      saveSingleFile(file, showEditableDoc);\r\n    };\r\n  \r\n    /**\r\n      * Shows google doc in iframe\r\n      */\r\n    function showEditableDoc(doc) {\r\n      responseFileId = doc.id; //created\r\n      var googleDocUrl = 'https://docs.google.com/document/d/' + doc.id +'/edit';     \r\n      const body = editor.o_doc.body;\r\n      const editDocContainer = editor.o_doc.createElement('div');\r\n      editDocContainer.setAttribute('id', 'editDocContainer');\r\n      editDocContainer.style.cssText ='position: fixed; top: 0;left: 0;padding: 0;width: 100%;height: 100%;background: rgba(255,255,255,1);z-index: 9998;display:block';\r\n     // margin-top is given for wordpress-framework\r\n      editDocContainer.innerHTML = '<div style=\"margin-top:25px; text-align:center\"><label>Sign Out : </label><input type=\"checkbox\" id =\"markSignOut\" role=\"button\"/>  <button id=\"signout_button\"  class=\"fr-trim-button\" >Save </button> <button id=\"cancel_file_edit\" class=\"fr-trim-button\">Cancel</button></div>  <iframe title=\"Edit your file\" frameBorder=\"0\" width=\"100%\" height=\"700px\" src=\"' + googleDocUrl + '\"></iframe>';\r\n      body.appendChild(editDocContainer);     \r\n      document.getElementById('signout_button').onclick=handleSignoutClick;\r\n      document.getElementById('cancel_file_edit').onclick=closeEditDocContainer;\r\n     \r\n    }\r\n    function closeEditDocContainer(){\r\n      document.getElementById('markSignOut').checked && gapi.auth2.getAuthInstance().signOut().then(function(){ \r\n        if (gapi.auth.getToken()) {\r\n          gapi.auth.getToken().access_token = undefined;\r\n          }\r\n         });\r\n      let container = document.getElementById('editDocContainer');\r\n      container.parentNode.removeChild(container);\r\n      if(document.getElementById(`user_area-${options.fileIndex}`))\r\n       document.getElementById(`user_area-${options.fileIndex}`).style.display = 'none';\r\n      enableAfterEdit(options.fileIndex);\r\n\r\n    }\r\n      /**\r\n      * Saves file to google drive\r\n      */\t\r\n    function saveSingleFile(file, callback) {\r\n      var reader = new FileReader();\r\n      reader.readAsArrayBuffer(file);\r\n      reader.onload = function(e) {\r\n        var contentType = 'application/vnd.google-apps.document';\r\n        var metadata = {\r\n          'title': file.name,\r\n          'mimeType': contentType\r\n        };\r\n        var binary = '';\r\n          var bytes = new Uint8Array( reader.result );\r\n          var len = bytes.byteLength;\r\n          for (var i = 0; i < len; i++) {\r\n              binary += String.fromCharCode(bytes[i]);\r\n          }\r\n        var base64Data = btoa(binary);\r\n        var multipartRequestBody =\r\n          DELIMITER +\r\n          'Content-Type: application/json; charset=UTF-8\\r\\n\\r\\n' +\r\n          JSON.stringify(metadata) +\r\n          DELIMITER +\r\n          'Content-Type: ' + 'application/octet-stream' + '\\r\\n' +\t\t\t\t\r\n          'Content-Transfer-Encoding: base64\\r\\n' +\r\n          '\\r\\n' +\r\n          base64Data +\r\n          CLOSE_DELIMITER;\r\n                \r\n        var request = gapi.client.request({\r\n          'path': '/upload/drive/v2/files',\r\n          'method': 'POST',\r\n          'params': {\r\n            'uploadType': 'multipart',\r\n            'fields': DEFAULT_FIELDS\r\n          },\r\n          'headers': {\r\n            'Content-Type': 'multipart/related; boundary=\"' + BOUNDARY + '\"',\r\n            'Content-Length': multipartRequestBody.Length\r\n          },\r\n          'body': multipartRequestBody\r\n        });\r\n        if (!callback) {\r\n          callback = function(file) {\r\n            console.log(file);\r\n          };\r\n        }\r\n        request.execute(function(doc, resp) {\r\n          if (!doc.error) {\r\n            callback(doc);\r\n          } else {\r\n            options.events.onError(doc.error);\r\n          }\r\n          \r\n        });\r\n      }\r\n      };\r\n      \r\n    var docEditor = {};\r\n    docEditor.handleClientLoad = function() {\r\n      gapi.load('client:auth2', initClient);\r\n       };\r\n    return docEditor;\r\n  }\r\n\r\n  function disableOnEdit(index){\r\n    const buttons = document.getElementsByClassName(`fr-doc-edit-${index}`);\r\n    for(var i = 0; i < buttons.length; i++){\r\n      buttons[i].setAttribute('disabled',true)\r\n      buttons[i].classList.add('fr-disabled')\r\n    }\r\n  }\r\n\r\n  function enableAfterEdit(index){\r\n\r\n    const buttons = document.getElementsByClassName(`fr-doc-edit-${index}`);\r\n    for(var i = 0; i < buttons.length; i++){\r\n      buttons[i].removeAttribute('disabled')\r\n      buttons[i].classList.remove('fr-disabled')\r\n    }\r\n  }\r\n \r\n\r\n  function saveImage($img) {\r\n    let obj = file_list_values.get($current_image_index);\r\n    obj.link = window.URL.createObjectURL(\r\n      new Blob($img, { type: 'image/png' })\r\n    );\r\n    file_list_values.set($current_image_index, obj);\r\n  }\r\n\r\n  /*\r\n  * Get file.type for machines which do not return type by default.\r\n  */\r\n  function _getFileType (file)\r\n  {\r\n\r\n    let fileTypeMap = [['.doc', 'application/msword'], ['.docx', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'], ['.gif', 'image/gif'], ['.jpeg', 'image/jpeg'], ['.jpg', 'image/jpeg'], ['.txt', 'text/plain'], ['.log', 'type/text'], ['.mov', 'video/quicktime'], ['.mp3', 'audio/mpeg'], ['.mp4', 'video/mp4'], ['.ogg', 'audio/ogg'], ['.ogv', 'video/ogg'], ['.pdf', 'application/pdf'], ['.png', 'image/png'], ['.webm', 'video/webm'], ['.webp', 'image/webp'], ['.wmv', 'video/x-ms-wmv'], ['.xls', 'application/vnd.ms-excel'], ['.xlsx', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'], ['.zip', 'application/x-zip-compressed']];\r\n\r\n\r\n    if(file.type == \"\")\r\n    {\r\n      let re = /(?:\\.([^.]+))?$/;\r\n      let ext = re.exec(file.name)[1];\r\n      let fileType\r\n      fileTypeMap.forEach(function(value, index){\r\n        if(value[0] == `.${ext}`){\r\n          fileType = value[1];\r\n        }\r\n      })\r\n      return fileType\r\n    }\r\n    return file.type\r\n  }\r\n\r\n  /**\r\n   * Insert image into the editor.\r\n   */\r\n\r\n  function insert(index, fileKeys) {\r\n    if (isFile(_getFileType(file_list_values.get(index))) || !isFormatSupported(_getFileType(file_list_values.get(index)))) {\r\n      let link = file_list_values.get(index).link\r\n      let text = file_list_values.get(index).text\r\n      if(!text && file_list.get(index) && file_list.get(index).name){\r\n        text = file_list.get(index).name\r\n      }\r\n       let response = file_list_values.get(index).response\r\n      editor.edit.on()\r\n\r\n      // Focus in the editor.\r\n      editor.events.focus(true)\r\n      editor.selection.restore()\r\n\r\n      if (editor.opts.fileUseSelectedText && editor.selection.text().length) {\r\n        text = editor.selection.text()\r\n      }\r\n\r\n      if (link.endsWith('.pdf') || link.endsWith('.txt')) {\r\n        let code = `<iframe src=\"${link}\" title=\"${text}\" width=\"”100%”\" height=\"”100%”\" class=\"fr-file\"></iframe>`\r\n        insertEmbeddedFile(code, true)\r\n      } else {\r\n        editor.html.insert(`<a href=\"${link}\" target=\"_blank\" id=\"fr-inserted-file\" class=\"fr-file\">${text}</a>`)\r\n      }\r\n      // Get the file.\r\n      const $file = editor.$el.find('#fr-inserted-file')\r\n\r\n      $file.removeAttr('id')\r\n\r\n      editor.undo.saveStep()\r\n\r\n      _syncFiles()\r\n      editor.selection.clear()\r\n      editor.selection.setAfter($file)\r\n\r\n      editor.events.trigger('file.inserted', [$file, response])    \r\n      insertFiles(fileKeys)\r\n    }\r\n\r\n\r\n    if (isImage(_getFileType(file_list_values.get(index))) && isFormatSupported(_getFileType(file_list_values.get(index)))) {\r\n\r\n      let link = file_list_values.get(index).link;\r\n      let sanitize = file_list_values.get(index).sanitize;\r\n      let data = file_list_values.get(index).data;\r\n      let $existing_img = file_list_values.get(index).$existing_img;\r\n      let response = file_list_values.get(index).response;\r\n\r\n    if ($existing_img && typeof $existing_img === 'string') {\r\n      $existing_img = editor.$($existing_img)\r\n    }\r\n\r\n    editor.edit.off()\r\n    _setProgressMessage(editor.language.translate('Loading image'))\r\n\r\n    if (sanitize) link = editor.helpers.sanitizeURL(link)\r\n\r\n    const image = new Image()\r\n\r\n    image.onload = function () {\r\n      let $img\r\n      let attr\r\n\r\n      if ($existing_img) {\r\n        if (!editor.undo.canDo() && !$existing_img.hasClass('fr-uploading')) editor.undo.saveStep()\r\n\r\n        let old_src = $existing_img.data('fr-old-src')\r\n\r\n        if ($existing_img.data('fr-image-pasted')) {\r\n          old_src = null\r\n        }\r\n\r\n        if (editor.$wp) {\r\n\r\n          // Clone existing image.\r\n          $img = $existing_img.clone()\r\n            .removeData('fr-old-src')\r\n            .removeClass('fr-uploading')\r\n            .removeAttr('data-fr-image-pasted')\r\n\r\n          // Remove load event.\r\n          $img.off('load')\r\n\r\n          // Set new SRC.\r\n          if (old_src) $existing_img.attr('src', old_src)\r\n\r\n          // Replace existing image with its clone.\r\n          $existing_img.replaceWith($img)\r\n\r\n        }\r\n        else {\r\n          $img = $existing_img\r\n        }\r\n\r\n        // Remove old data.\r\n        const atts = $img.get(0).attributes\r\n\r\n        for (let i = 0; i < atts.length; i++) {\r\n          const att = atts[i]\r\n\r\n          if (att.nodeName.indexOf('data-') === 0) {\r\n            $img.removeAttr(att.nodeName)\r\n          }\r\n        }\r\n\r\n        // Set new data.\r\n        if (typeof data != 'undefined') {\r\n          for (attr in data) {\r\n            if (data.hasOwnProperty(attr)) {\r\n              if (attr != 'link') {\r\n                $img.attr(`data-${attr}`, data[attr])\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        $img.on('load', _loadedCallback)\r\n        $img.attr('src', link)\r\n        editor.edit.on()\r\n        editor.undo.saveStep()\r\n\r\n        // Cursor will not appear if we don't make blur.\r\n        editor.events.disableBlur()\r\n        editor.$el.blur()\r\n        editor.events.trigger(old_src ? 'image.replaced' : 'image.inserted', [$img, response])\r\n      }\r\n      else {\r\n        $img = _addImage(link, data, _loadedCallback)\r\n        editor.undo.saveStep()\r\n\r\n        // Cursor will not appear if we don't make blur.\r\n        editor.events.disableBlur()\r\n        editor.$el.blur()\r\n        editor.events.trigger('image.inserted', [$img, response])\r\n      }\r\n    }\r\n\r\n    image.onerror = function () {\r\n      _throwError(BAD_LINK, null, null, index)\r\n      insertFiles(fileKeys)\r\n    }\r\n    image.src = link\r\n    }\r\n\r\n\r\n    if ((isVideo(_getFileType(file_list_values.get(index))) || isAudio(_getFileType(file_list_values.get(index)))) && isFormatSupported(_getFileType(file_list_values.get(index)))) {\r\n      current_index=index\r\n      if (_getFileType(file_list_values.get(index)) == 'video/url') {\r\n\r\n\r\n        let video_autoplay = false\r\n        if (document.getElementById('fr-file-autoplay-button-' + index) !== undefined) {\r\n          video_autoplay = document.getElementById('fr-file-autoplay-button-' + index).checked\r\n        }\r\n        if (video_autoplay && file_list_values.get(index) !== undefined && file_list_values.get(index).video.indexOf('iframe') > -1 \r\n          && file_list_values.get(index).video.indexOf('autoplay=1') < 0) {\r\n        \r\n          let url = file_list_values.get(index).video.substring(file_list_values.get(index).video.indexOf('src') + 3)\r\n          url = url.substring(url.indexOf('\"') + 1)\r\n          url = url.substring(0, url.indexOf('\"'))\r\n          let appendSymbol = '&'\r\n          if (url.indexOf('?') < 0) {\r\n            appendSymbol = '?'\r\n          }\r\n\r\n          file_list_values.get(index).video = file_list_values.get(index).video.replace(url, (url += appendSymbol + 'autoplay=1'))             \r\n        }\r\n        else if(!video_autoplay && file_list_values.get(index).video.indexOf('iframe' > -1)) {\r\n          if (file_list_values.get(index).video.indexOf('&autoplay=1') > -1) {\r\n            file_list_values.get(index).video = file_list_values.get(index).video.replace('&autoplay=1', '')\r\n          }\r\n\r\n          if (file_list_values.get(index).video.indexOf('?autoplay=1') > -1) {\r\n            file_list_values.get(index).video = file_list_values.get(index).video.replace('?autoplay=1', '')\r\n          }\r\n        }\r\n\r\n        // Make sure we have focus.\r\n        editor.events.focus(true)\r\n        editor.selection.restore()\r\n\r\n        editor.html.insert(`<span contenteditable=\"false\" draggable=\"true\" class=\"fr-jiv fr-video fr-deletable\">${file_list_values.get(index).video}</span>`, false, editor.opts.videoSplitHTML)\r\n        \r\n        editor.popups.hide('filesManager.insert')\r\n\r\n        const $video = editor.$el.find('.fr-jiv')\r\n        $video.removeClass('fr-jiv')\r\n        $video.toggleClass('fr-rv', editor.opts.videoResponsive)\r\n\r\n        _setVideoStyle($video, editor.opts.videoDefaultDisplay, editor.opts.videoDefaultAlign)\r\n\r\n        $video.toggleClass('fr-draggable', editor.opts.videoMove)\r\n        \r\n        editor.events.trigger('video.inserted', [$video])\r\n        _loadedCallback.call($video)\r\n      }\r\n        else {\r\n          let link = file_list_values.get(index).link;\r\n          let sanitize = file_list_values.get(index).sanitize;\r\n          let data = file_list_values.get(index).data;\r\n          let $existing_video = file_list_values.get(index).$existing_img;\r\n          let response = file_list_values.get(index).response;\r\n          editor.edit.off()\r\n    \r\n          if (sanitize) link = editor.helpers.sanitizeURL(link)\r\n    \r\n          const _add = function () {\r\n            let $video\r\n            let attr\r\n    \r\n            if ($existing_video) {\r\n              if (!editor.undo.canDo() && !$existing_video.find('video').hasClass('fr-uploading')) editor.undo.saveStep()\r\n    \r\n              const old_src = $existing_video.find('video').data('fr-old-src')\r\n    \r\n              const replaced = $existing_video.data('fr-replaced')\r\n              $existing_video.data('fr-replaced', false)\r\n    \r\n              if (editor.$wp) {\r\n    \r\n                // Clone existing video.\r\n                $video = $existing_video.clone(true)\r\n                $video.find('video').removeData('fr-old-src').removeClass('fr-uploading')\r\n    \r\n                // Remove load event.\r\n                $video.find('video').off('canplay')\r\n    \r\n                // Set new SRC.\r\n                if (old_src) $existing_video.find('video').attr('src', old_src)\r\n    \r\n                // Replace existing video with its clone.\r\n                $existing_video.replaceWith($video)\r\n              }\r\n              else {\r\n                $video = $existing_video\r\n              }\r\n    \r\n              // Remove old data.\r\n              const atts = $video.find('video').get(0).attributes\r\n    \r\n              for (let i = 0; i < atts.length; i++) {\r\n                const att = atts[i]\r\n    \r\n                if (att.nodeName.indexOf('data-') === 0) {\r\n                  $video.find('video').removeAttr(att.nodeName)\r\n                }\r\n              }\r\n    \r\n              // Set new data.\r\n              if (typeof data != 'undefined') {\r\n                for (attr in data) {\r\n                  if (data.hasOwnProperty(attr)) {\r\n                    if (attr != 'link') {\r\n                      $video.find('video').attr(`data-${attr}`, data[attr])\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n    \r\n              $video.find('video').on('canplay', _loadedCallback)\r\n              $video.find('video').attr('src', link)\r\n              editor.edit.on()\r\n              _syncVideos()\r\n              editor.undo.saveStep()\r\n    \r\n              // Cursor will not appear if we don't make blur.\r\n              editor.$el.blur()\r\n    \r\n              editor.events.trigger(replaced ? 'video.replaced' : 'video.inserted', [$video, response])\r\n            }\r\n            else {\r\n\r\n              $video = _addVideo(link, data, _loadedCallback, _getFileType(file_list_values.get(index)) ,index)\r\n\r\n              _syncVideos()\r\n              editor.undo.saveStep()\r\n              editor.events.trigger('video.inserted', [$video, response])\r\n              }\r\n          }\r\n          _add()\r\n        }\r\n    }\r\n    editor.popups.hide('filesManager.insert')\r\n    checked_files.delete(index)\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    $popup.find(`input.fr-insert-attr.fr-checkbox-file-${index}`)[0].checked = false\r\n    $popup.find(`.fr-file-` + index).get(0).classList.add('fr-unchecked')\r\n    checkInsertAllState();\r\n    if (document.getElementById('fr-file-autoplay-button-' + index)) {\r\n      document.getElementById('fr-file-autoplay-button-' + index).checked = false\r\n    }\r\n    autoplayCheckbox = autoplayCheckbox.filter(function (i){\r\n      return i != index\r\n    })\r\n  }\r\n\r\n  function _setVideoStyle($video, _display, _align) {\r\n    if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n      $video.removeClass('fr-fvl fr-fvr fr-dvb fr-dvi') \r\n      $video.addClass(`fr-fv${_align[0]} fr-dv${_display[0]}`) \r\n    }\r\n    else {\r\n      if (_display == 'inline') {\r\n        $video.css({\r\n          display: 'inline-block'\r\n        })\r\n\r\n        if (_align == 'center') {\r\n          $video.css({\r\n            'float': 'none'\r\n          })\r\n        }\r\n        else if (_align == 'left') {\r\n          $video.css({\r\n            'float': 'left'\r\n          })\r\n        }\r\n        else {\r\n          $video.css({\r\n            'float': 'right'\r\n          })\r\n        }\r\n      }\r\n      else {\r\n        $video.css({\r\n          display: 'block',\r\n          clear: 'both'\r\n        })\r\n\r\n        if (_align == 'left') {\r\n          $video.css({\r\n            textAlign: 'left'\r\n          })\r\n        }\r\n        else if (_align == 'right') {\r\n          $video.css({\r\n            textAlign: 'right'\r\n          })\r\n        }\r\n        else {\r\n          $video.css({\r\n            textAlign: 'center'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /* insert Embed \r\n  */\r\n\r\n function insertEmbeddedFile(embedded_code, file) {\r\n   let type\r\n   let fileSplitHTML\r\n   if (FE.VIDEO_EMBED_REGEX.test(embedded_code)) {\r\n     type = 'video'\r\n     fileSplitHTML = editor.opts.videoSplitHTML\r\n   } else if (FE.IMAGE_EMBED_REGEX.test(embedded_code)) {\r\n     type = 'image'\r\n     fileSplitHTML = editor.opts.imageSplitHTML\r\n   }\r\n   // Make sure we have focus.\r\n   editor.events.focus(true)\r\n   editor.selection.restore()\r\n\r\n   // Flag to tell if the video is replaced.\r\n   let replaced = false\r\n\r\n   // If current video found we have to replace it.\r\n   if ($current_image) {\r\n\r\n     // Remove the old video.\r\n     remove()\r\n\r\n     // Mark that the video is replaced.\r\n     replaced = true\r\n   }\r\n   editor.html.insert(`<span id=\"fr-inserted-file\" contenteditable=\"true\" draggable=\"true\" class=\"fr-${type} fr-jiv fr-deletable\">${embedded_code}</span>`, false, fileSplitHTML)\r\n\r\n   // add the below code for image as well\r\n   editor.popups.hide('filesManager.insert')\r\n\r\n   const $file = editor.$el.find('.fr-jiv')\r\n   $file.removeClass('fr-jiv')\r\n\r\n   if (type == 'video') {\r\n\r\n     $file.toggleClass('fr-rv', editor.opts.videoResponsive)\r\n\r\n     _setStyleVideo($file, editor.opts.videoDefaultDisplay, editor.opts.videoDefaultAlign)\r\n\r\n     $file.toggleClass('fr-draggable', editor.opts.videoMove)\r\n\r\n     editor.events.trigger(replaced ? 'video.replaced' : 'video.inserted', [$file])\r\n   }\r\n\r\n   if (type == 'image') {\r\n\r\n     _setStyleImage($file, editor.opts.imageDefaultDisplay, editor.opts.imageDefaultAlign)\r\n\r\n     $file.find('img').removeClass('fr-dii')\r\n\r\n     $file.find('img').addClass('fr-dib')\r\n\r\n     $file.toggleClass('fr-draggable', editor.opts.imageMove)\r\n\r\n     editor.events.trigger(replaced ? 'image.replaced' : 'image.inserted', [$file])\r\n   }\r\n   if(file)\r\n   {\r\n    editImageValue = $file\r\n    editor.selection.clear()\r\n    editor.toolbar.disable()\r\n    editor.video._editVideo(editImageValue)\r\n   }   \r\n }\r\n\r\n  function _addVideo(link, data, loadCallback, type,index) {\r\n\r\n    // Build video data string.\r\n    let data_str = ''\r\n    let attr\r\n\r\n    if (data && typeof data != 'undefined') {\r\n      for (attr in data) {\r\n        if (data.hasOwnProperty(attr)) {\r\n          if (attr != 'link') {\r\n            data_str += ` data-${attr}=\"${data[attr]}\"`\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    let { videoDefaultWidth: width } = editor.opts\r\n\r\n    if (width && width != 'auto') {\r\n      width = `${width}px`\r\n    }\r\n    let $video\r\n    if (isAudio(type)) {\r\n      // https://github.com/froala-labs/froala-editor-js-2/issues/2810\r\n      // Create audio object and set the load event.\r\n      $video = $(document.createElement('span')).attr('contenteditable', 'false').attr('draggable', 'true').attr('class', 'fr-video fr-dv' + (editor.opts.videoDefaultDisplay[0]) + (editor.opts.videoDefaultAlign != 'center' ? ' fr-fv' + editor.opts.videoDefaultAlign[0] : '')).html('<audio src=\"' + link + '\" ' + data_str + ' controls>' + editor.language.translate('Your browser does not support HTML5 video.') + '</audio>')\r\n    }\r\n    else {\r\n      let autoplay=''\r\n      let video_autoplay=document.getElementById('fr-file-autoplay-button-' + index).checked\r\n      if(video_autoplay){\r\n        autoplay=\"autoplay\"\r\n      }\r\n      // Create video object and set the load event.\r\n      $video = $(document.createElement('span')).attr('contenteditable', 'false').attr('draggable', 'true').attr('class', 'fr-video fr-dv' + (editor.opts.videoDefaultDisplay[0]) + (editor.opts.videoDefaultAlign != 'center' ? ' fr-fv' + editor.opts.videoDefaultAlign[0] : '')).html('<video src=\"' + link + '\" ' + data_str + (width ? ' style=\"width: ' + width + ';\" ' : '')+ autoplay + '  controls>' + editor.language.translate('Your browser does not support HTML5 video.') + '</video>')\r\n    }\r\n\r\n    $video.toggleClass('fr-draggable', editor.opts.videoMove)\r\n\r\n    // Make sure we have focus.\r\n    // Call the event.\r\n    editor.edit.on()\r\n    editor.events.focus(true)\r\n    editor.selection.restore()\r\n\r\n    editor.undo.saveStep()\r\n\r\n    // Insert marker and then replace it with the video.\r\n    if (editor.opts.videoSplitHTML) {\r\n      editor.markers.split()\r\n    }\r\n    else {\r\n      editor.markers.insert()\r\n    }\r\n\r\n    editor.html.wrap()\r\n    const $marker = editor.$el.find('.fr-marker')\r\n\r\n    // Do not insert video inside emoticon.\r\n    if (editor.node.isLastSibling($marker) && $marker.parent().hasClass('fr-deletable')) {\r\n\r\n      $marker.insertAfter($marker.parent())\r\n    }\r\n\r\n    $marker.replaceWith($video)\r\n\r\n    let typeVar = ''\r\n     isAudio(type) ?  typeVar= 'audio' :  typeVar = 'video'\r\n     if ($video.find(typeVar).get(0).readyState > $video.find(typeVar).get(0).HAVE_FUTURE_DATA || editor.helpers.isIOS()) {\r\n      loadCallback.call($video.find(typeVar).get(0))\r\n    }\r\n    else {\r\n      $video.find(typeVar).on('canplaythrough load', loadCallback)\r\n      $video.find(typeVar).on('error', loadCallback)\r\n    }\r\n    return $video\r\n  }\r\n\r\n\r\n  /**\r\n   * Parse image response.\r\n   */\r\n\r\n  function _parseResponse(response, index) {\r\n    try {\r\n      if (editor.events.trigger('filesManager.uploaded', [response], true) === false) {\r\n        editor.edit.on()\r\n\r\n        return false\r\n      }\r\n      const resp = JSON.parse(response)\r\n\r\n      if (resp.link) {\r\n\r\n        return resp\r\n      }\r\n      else {\r\n\r\n        // No link in upload request.\r\n        _throwError(MISSING_LINK, response, null, index)\r\n\r\n        return false\r\n      }\r\n    } catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response, null, index)\r\n\r\n      return false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Parse image response.\r\n   */\r\n\r\n  function _parseXMLResponse(response, index) {\r\n    try {\r\n      const link = $(response).find('Location').text()\r\n      const key = $(response).find('Key').text()\r\n\r\n      if (editor.events.trigger('filesManager.uploadedToS3', [link, key, response], true) === false) {\r\n        editor.edit.on()\r\n\r\n        return false\r\n      }\r\n\r\n      return link\r\n    } catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response, null, index)\r\n\r\n      return false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Image was uploaded to the server and we have a response.\r\n   */\r\n\r\n  function _fileUploaded(text, index, type, url, key) {\r\n    const { status } = this\r\n    const { response } = this\r\n    const { responseXML } = this\r\n    const { responseText } = this\r\n\r\n    try {\r\n      if (editor.opts.filesManagerUploadToS3 || editor.opts.filesManagerUploadToAzure) {\r\n        if (status === 201) {\r\n          let link\r\n          if(editor.opts.filesManagerUploadToAzure){\r\n            if (editor.events.trigger('filesManager.uploadedToAzure', [this.responseURL, key, response], true) === false) {\r\n              editor.edit.on()\r\n              return false\r\n            }\r\n            link = url\r\n          } else {\r\n            link = _parseXMLResponse(responseXML, index)\r\n          }\r\n          if (link) {\r\n            let obj =\r\n            {\r\n              link: link,\r\n              text: text,\r\n              response: response,\r\n              type: type\r\n            }\r\n            file_list_values.set(index, obj)\r\n          }\r\n        }\r\n        else {\r\n          _throwError(BAD_RESPONSE, response || responseXML, null, index)\r\n        }\r\n      }\r\n      else {\r\n        if (status >= 200 && status < 300) {\r\n          const resp = _parseResponse(responseText, index)\r\n\r\n          if (resp) {\r\n            let obj =\r\n            {\r\n              link: resp.link,\r\n              text: text,\r\n              response: response,\r\n              type: type\r\n            }\r\n            file_list_values.set(index, obj)\r\n          }\r\n        }\r\n        else {\r\n          _throwError(ERROR_DURING_UPLOAD, response || responseText, null, index)\r\n        }\r\n      }\r\n    }\r\n    catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response || responseText, null, index)\r\n    }\r\n  }\r\n\r\n  function _imageUploaded($image_placeholder, index, type, url, key) {\r\n    const { status } = this\r\n    const { response } = this\r\n    const { responseXML } = this\r\n    const { responseText } = this\r\n\r\n    try {\r\n      if (editor.opts.filesManagerUploadToS3 || editor.opts.filesManagerUploadToAzure) {\r\n        if (status == 201) {\r\n          let link\r\n          if(editor.opts.filesManagerUploadToAzure){\r\n            if (editor.events.trigger('filesManager.uploadedToAzure', [this.responseURL, key, response], true) === false) {\r\n              editor.edit.on()\r\n              return false\r\n            }\r\n            link = url\r\n          } else {\r\n            link = _parseXMLResponse(responseXML, index)\r\n          }\r\n          if (link) {\r\n            let obj = {\r\n              link: link,\r\n              sanitize: false,\r\n              data: [],\r\n              $existing_img: $image_placeholder,\r\n              response: response || responseXML,\r\n              type: type\r\n            }\r\n            file_list_values.set(index, obj)\r\n          }\r\n        }\r\n        else {\r\n          _throwError(BAD_RESPONSE, response || responseXML, $image_placeholder, index)\r\n        }\r\n      }\r\n      else {\r\n        if (status >= 200 && status < 300) {\r\n          const resp = _parseResponse(responseText, index)\r\n\r\n          if (resp) {\r\n            let obj = {\r\n              link: resp.link,\r\n              sanitize: false,\r\n              data: resp,\r\n              $existing_img: $image_placeholder,\r\n              response: response || responseXML,\r\n              type: type\r\n            }\r\n            file_list_values.set(index, obj)\r\n          }\r\n        }\r\n        else {\r\n          _throwError(ERROR_DURING_UPLOAD, response || responseText, $image_placeholder, index)\r\n        }\r\n      }\r\n    } catch (ex) {\r\n\r\n      // Bad response.\r\n      _throwError(BAD_RESPONSE, response || responseText, $image_placeholder, index)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Image upload error.\r\n   */\r\n\r\n  function _fileUploadError() {\r\n    _throwError(BAD_RESPONSE, this.response || this.responseText || this.responseXML)\r\n  }\r\n\r\n  /**\r\n   * Image upload progress.\r\n   */\r\n\r\n  function _fileUploadProgress(e, index) {\r\n    if (e.lengthComputable) {\r\n      const complete = (e.loaded / e.total * 100 | 0)\r\n      updateFileUploadingProgress(complete, index, false)\r\n    }\r\n  }\r\n\r\n  function _addImage(link, data, loadCallback) {\r\n\r\n    // Build image data string.\r\n    let data_str = ''\r\n    let attr\r\n    const $img = $(document.createElement('img')).attr('src', link)\r\n\r\n    if (data && typeof data != 'undefined') {\r\n      for (attr in data) {\r\n        if (data.hasOwnProperty(attr)) {\r\n          if (attr != 'link') {\r\n            data_str += ` data-${attr}=\"${data[attr]}\"`\r\n            // https://github.com/froala-labs/froala-editor-js-2/issues/2649\r\n            $img.attr(`data-${attr}`, data[attr])\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    let width = editor.opts.imageDefaultWidth\r\n\r\n    if (width && width != 'auto') {\r\n      width = (editor.opts.imageResizeWithPercent ? '100%' : `${width}px`)\r\n    }\r\n\r\n    // Create image object and set the load event.\r\n    $img.attr('style', (width ? `width: ${width};` : ''))\r\n    _setStyleImage($img, editor.opts.imageDefaultDisplay, editor.opts.imageDefaultAlign)\r\n\r\n    $img.on('load', loadCallback)\r\n\r\n    // Image might be corrupted. Continue upload flow.\r\n    $img.on('error', loadCallback)\r\n\r\n    // Make sure we have focus.\r\n    // Call the event.\r\n    editor.edit.on()\r\n    editor.events.focus(true)\r\n    editor.selection.restore()\r\n    editor.undo.saveStep()\r\n\r\n    // Insert marker and then replace it with the image.\r\n    if (editor.opts.imageSplitHTML) {\r\n      editor.markers.split()\r\n    }\r\n    else {\r\n      editor.markers.insert()\r\n    }\r\n\r\n    editor.html.wrap()\r\n    const $marker = editor.$el.find('.fr-marker')\r\n\r\n    if ($marker.length) {\r\n\r\n      // Do not insert image in HR.\r\n      if ($marker.parent().is('hr')) {\r\n        $marker.parent().after($marker)\r\n      }\r\n\r\n      // Do not insert image inside emoticon.\r\n      if (editor.node.isLastSibling($marker) && $marker.parent().hasClass('fr-deletable')) {\r\n\r\n        $marker.insertAfter($marker.parent())\r\n      }\r\n\r\n      $marker.replaceWith($img)\r\n    }\r\n    else {\r\n      editor.$el.append($img)\r\n    }\r\n\r\n    return $img\r\n  }\r\n\r\n  /**\r\n   * Image upload aborted.\r\n   */\r\n  function _fileUploadAborted(index, e) {\r\n    _throwError(UPLOAD_CANCEL, e, $current_image, index)\r\n  }\r\n\r\n  function _browserUpload(index, file, $image_placeholder) {\r\n    const reader = new FileReader()\r\n\r\n    reader.onload = function () {\r\n      let link = reader.result\r\n\r\n      if (reader.result.indexOf('svg+xml') < 0) {\r\n\r\n        // Convert file to local blob.\r\n        const binary = atob(reader.result.split(',')[1])\r\n        const array = []\r\n\r\n        for (let i = 0; i < binary.length; i++) {\r\n          array.push(binary.charCodeAt(i))\r\n        }\r\n\r\n        // Get local image link.\r\n        link = window.URL.createObjectURL(new Blob([new Uint8Array(array)], {\r\n          type: _getFileType(file)\r\n        }))\r\n\r\n        if (isImage(_getFileType(file))) {\r\n          let obj = {\r\n            link: link,\r\n            sanitize: false,\r\n            data: null,\r\n            $existing_img: $image_placeholder,\r\n            response: null,\r\n            type: _getFileType(file)\r\n          }\r\n          file_list_values.set(index, obj)\r\n        }\r\n\r\n        if (isFile(_getFileType(file))) {\r\n          let obj = {\r\n            link: link,\r\n            text: file.name,\r\n            response: null,\r\n            type: _getFileType(file)\r\n          }\r\n          file_list_values.set(index, obj)\r\n        }\r\n\r\n        if (isVideo(_getFileType(file)) || isAudio(_getFileType(file))) {\r\n          let obj = {\r\n            link: link,\r\n            sanitize: false,\r\n            data: null,\r\n            $existing_img: $image_placeholder,\r\n            type: _getFileType(file)\r\n          }\r\n          file_list_values.set(index, obj)\r\n        }\r\n      }\r\n    }\r\n    reader.readAsDataURL(file)\r\n  }\r\n\r\n  function upload(file, files, $image_placeholder, index) {\r\n    if(unsupported_file_types.indexOf(_getFileType(file)) > -1 || !_getFileType(file)){\r\n\r\n      _throwError(BAD_FILE_TYPE, null, null, index)\r\n      return false\r\n    }\r\n    // Check if we should cancel the image upload.\r\n    if (editor.events.trigger('filesManager.beforeUpload', [files]) === false) {\r\n      return false\r\n    }\r\n\r\n    if ((editor.opts.filesManagerUploadURL === null || editor.opts.filesManagerUploadURL == DEFAULT_FILE_UPLOAD_URL) && !editor.opts.filesManagerUploadToS3 && !editor.opts.filesManagerUploadToAzure) {\r\n      _browserUpload(index, file)\r\n      return false\r\n    }\r\n\r\n    if(isImage(_getFileType(file))) {\r\n      if (!file.name) {\r\n        file.name = (new Date()).getTime() + '.' + (_getFileType(file) || 'image/jpeg').replace(/image\\//g, '')\r\n      }\r\n    }\r\n\r\n    if (file.size > editor.opts.filesManagerMaxSize) {\r\n      _throwError(MAX_SIZE_EXCEEDED, null, null, index)\r\n      return false\r\n    }\r\n\r\n    if (editor.opts.filesManagerAllowedTypes.indexOf('*') < 0 && editor.opts.filesManagerAllowedTypes.indexOf(_getFileType(file)) < 0) {\r\n      _throwError(BAD_FILE_TYPE, null, null, index)\r\n        return false\r\n    }\r\n\r\n    initialFileUploadStatus(index)\r\n    // Create form Data.\r\n    let form_data\r\n\r\n    if (editor.drag_support.formdata) {\r\n      form_data = editor.drag_support.formdata ? new FormData() : null\r\n    }\r\n\r\n    // Prepare form data for request.\r\n    if (form_data) {      \r\n      let key\r\n      // Upload to S3.\r\n      if (editor.opts.filesManagerUploadToS3 !== false) {\r\n        form_data.append('key', editor.opts.filesManagerUploadToS3.keyStart + (new Date()).getTime() + '-' + (file.name || 'untitled'))\r\n        form_data.append('success_action_status', '201')\r\n        form_data.append('X-Requested-With', 'xhr')\r\n        form_data.append('Content-Type', _getFileType(file))\r\n\r\n        for (key in editor.opts.filesManagerUploadToS3.params) {\r\n          if (editor.opts.filesManagerUploadToS3.params.hasOwnProperty(key)) {\r\n            form_data.append(key, editor.opts.filesManagerUploadToS3.params[key])\r\n          }\r\n        }\r\n      }\r\n\r\n      // Add upload params.\r\n      for (key in editor.opts.filesManagerUploadParams) {\r\n        if (editor.opts.filesManagerUploadParams.hasOwnProperty(key)) {\r\n          form_data.append(key, editor.opts.filesManagerUploadParams[key])\r\n        }\r\n      }\r\n\r\n      // Set the image in the request.\r\n      form_data.append(editor.opts.filesManagerUploadParam, file, file.name)\r\n     \r\n      // Create XHR request.\r\n      let url = editor.opts.filesManagerUploadURL\r\n      let fileURL\r\n      let azureKey\r\n\r\n      if (editor.opts.filesManagerUploadToS3) {\r\n        if (editor.opts.filesManagerUploadToS3.uploadURL) {\r\n          url = editor.opts.filesManagerUploadToS3.uploadURL\r\n        } else {\r\n          url = `https://${editor.opts.filesManagerUploadToS3.region}.amazonaws.com/${editor.opts.filesManagerUploadToS3.bucket}`\r\n        }\r\n      }\r\n      \r\n      if (editor.opts.filesManagerUploadToAzure) {\r\n        if (editor.opts.filesManagerUploadToAzure.uploadURL) {\r\n          url = `${editor.opts.filesManagerUploadToAzure.uploadURL}/${file.name}`\r\n        } else {\r\n          url = encodeURI(`https://${editor.opts.filesManagerUploadToAzure.account}.blob.core.windows.net/${editor.opts.filesManagerUploadToAzure.container}/${file.name}`)\r\n        }\r\n        fileURL = url\r\n        if (editor.opts.filesManagerUploadToAzure.SASToken) {\r\n          url += editor.opts.filesManagerUploadToAzure.SASToken\r\n        }\r\n        editor.opts.filesManagerUploadMethod = 'PUT'\r\n      }\r\n      \r\n      const xhr = editor.core.getXHR(url, editor.opts.filesManagerUploadMethod)\r\n\r\n      if (editor.opts.filesManagerUploadToAzure) {\r\n        let uploadDate = new Date().toUTCString()\r\n        if (!editor.opts.filesManagerUploadToAzure.SASToken && editor.opts.filesManagerUploadToAzure.accessKey) {\r\n          let azureAccount = editor.opts.filesManagerUploadToAzure.account\r\n          let azureContainer = editor.opts.filesManagerUploadToAzure.container\r\n          if(editor.opts.filesManagerUploadToAzure.uploadURL) {\r\n            let urls = editor.opts.filesManagerUploadToAzure.uploadURL.split('/')\r\n            azureContainer = urls.pop()\r\n            azureAccount = urls.pop().split('.')[0]\r\n          }\r\n          let headerResource = `x-ms-blob-type:BlockBlob\\nx-ms-date:${uploadDate}\\nx-ms-version:2019-07-07`\r\n          let urlResource = encodeURI('/' + azureAccount + '/' + azureContainer + '/' + file.name)\r\n          let stringToSign = editor.opts.filesManagerUploadMethod + '\\n\\n\\n' + file.size + '\\n\\n' + _getFileType(file) + '\\n\\n\\n\\n\\n\\n\\n' + headerResource + '\\n' + urlResource\r\n          let signatureBytes = editor.cryptoJSPlugin.cryptoJS.HmacSHA256(stringToSign, editor.cryptoJSPlugin.cryptoJS.enc.Base64.parse(editor.opts.filesManagerUploadToAzure.accessKey))\r\n          let signature = signatureBytes.toString(editor.cryptoJSPlugin.cryptoJS.enc.Base64)\r\n          let authHeader = 'SharedKey ' + azureAccount + ':' + signature\r\n          azureKey = signature\r\n          xhr.setRequestHeader(\"Authorization\", authHeader)\r\n        }\r\n        xhr.setRequestHeader(\"x-ms-version\", \"2019-07-07\")\r\n        xhr.setRequestHeader(\"x-ms-date\", uploadDate)\r\n        xhr.setRequestHeader(\"Content-Type\", _getFileType(file))\r\n        xhr.setRequestHeader(\"x-ms-blob-type\", \"BlockBlob\")\r\n        for (key in editor.opts.filesManagerUploadParams) {\r\n          if (editor.opts.filesManagerUploadParams.hasOwnProperty(key)) {\r\n            xhr.setRequestHeader(key, editor.opts.filesManagerUploadParams[key])\r\n          }\r\n        }\r\n        for (key in editor.opts.filesManagerUploadToAzure.params) {\r\n          if (editor.opts.filesManagerUploadToAzure.params.hasOwnProperty(key)) {\r\n            xhr.setRequestHeader(key, editor.opts.filesManagerUploadToAzure.params[key])\r\n          }\r\n        }\r\n      }\r\n\r\n      xhr.onload = function () {\r\n        if (isFile(_getFileType(file))) {\r\n          _fileUploaded.call(xhr, file.name, index, _getFileType(file), fileURL, azureKey)        \r\n        } else {\r\n          _imageUploaded.call(xhr, $current_image, index, _getFileType(file), fileURL, azureKey)\r\n        }\r\n        if(!failedUploadFiles.has(index)){\r\n          updateFileUploadingProgress(100, index, true) \r\n        }\r\n      }\r\n      xhr.onerror =   function _fileUploadError() {\r\n        _throwError(BAD_RESPONSE, this.response || this.responseText || this.responseXML, null, index)\r\n      }\r\n      xhr.upload.onprogress =  function (e) {\r\n        _fileUploadProgress(e, index)\r\n      }\r\n      xhr.onabort = function(e) {\r\n        _fileUploadAborted(index, e)\r\n      }\r\n      xhr.send(editor.opts.filesManagerUploadToAzure ? file : form_data)\r\n      XMLHttpRequests.set(index, xhr)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Image drop inside the upload zone.\r\n   */\r\n\r\n  function _bindInsertEvents($popup) {\r\n\r\n    //disable keypad launch on click in mobile\r\n    editor.events.$on($popup, 'click', '.fr-upload-progress-layer', function (e) {\r\n      if (editor.helpers.isMobile()) {\r\n        e.stopPropagation()\r\n        return false\r\n      }\r\n    }, true)\r\n\r\n    //preventing Drag over on file list in filesManager popup\r\n    editor.events.$on($popup, 'dragover dragenter', '.fr-upload-progress-layer', function (e) {\r\n      e.preventDefault()\r\n      for (var i = 0; i < e.originalEvent.dataTransfer.types.length; i++) {\r\n        if (e.originalEvent.dataTransfer.types[i] == \"Files\") {\r\n          e.originalEvent.dataTransfer.dropEffect = \"none\"\r\n        }\r\n    }      \r\n      return false\r\n    }, true)\r\n\r\n\r\n    //preventing Drag end on file list in filesManager popup\r\n    editor.events.$on($popup, 'dragleave dragend', '.fr-upload-progress-layer', function (e) {\r\n      e.preventDefault()\r\n      return false\r\n    }, true)\r\n\r\n\r\n    // Drag over the dropable area.\r\n    editor.events.$on($popup, 'dragover dragenter', '.fr-files-upload-layer', function (e) {\r\n      $(this).addClass('fr-drop')\r\n\r\n      if (editor.browser.msie || editor.browser.edge) {\r\n        e.preventDefault()\r\n      }\r\n\r\n      return false\r\n    }, true)\r\n\r\n    // Drag end.\r\n    editor.events.$on($popup, 'dragleave dragend', '.fr-files-upload-layer', function (e) {\r\n      $(this).removeClass('fr-drop')\r\n\r\n      if (editor.browser.msie || editor.browser.edge) {\r\n        e.preventDefault()\r\n      }\r\n\r\n      return false\r\n    }, true)\r\n\r\n    editor.events.$on($popup, 'click', '.fr-insert-checkbox', function (e){\r\n      if(this.classList.contains('fr-checkbox-disabled')){\r\n        this.children['target'].disabled = true\r\n        this.children['target'].checked = false\r\n        return\r\n      }\r\n      let index = parseInt(this.id.split('-').pop())\r\n      checked_files.set(index,this.children['target'].checked)\r\n      let $btnInsert = $popup.find('.fr-command[data-cmd=\"insertAll\"]')\r\n      let $btnDelete = $popup.find('.fr-command[data-cmd=\"deleteAll\"]')\r\n      const check_inputs = $popup.find('input.fr-file-insert-check[type=\"checkbox\"]')\r\n      let size = check_inputs.length\r\n      let isDisabled = true\r\n      for(let i = 0; i< size; i++)\r\n      {\r\n        if(check_inputs[i].checked == true)\r\n        {\r\n          isDisabled=false\r\n        } \r\n      }\r\n      isDisabled?$btnInsert.addClass('fr-disabled'):$btnInsert.removeClass('fr-disabled')\r\n      isDisabled?$btnDelete.addClass('fr-disabled'):$btnDelete.removeClass('fr-disabled')\r\n\r\n      if(this.children['target'].checked){\r\n        $popup.find(`.fr-file-` + this.id.split('-').pop()).get(0).setAttribute('draggable' , 'true')\r\n        $popup.find(`.fr-file-` + this.id.split('-').pop()).get(0).classList.remove('fr-unchecked')\r\n      }\r\n      else{\r\n        let id = this.id.split('-').pop()\r\n        $popup.find(`.fr-file-` + this.id.split('-').pop()).get(0).setAttribute('draggable' , 'false')\r\n        $popup.find(`.fr-file-` + this.id.split('-').pop()).get(0).classList.add('fr-unchecked')\r\n      }\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-file-insert-button', function (e){\r\n      if(this.classList.contains('fr-disabled')){\r\n        return\r\n      }\r\n      let index = parseInt(this.id.split('-').pop())\r\n      insert(index)\r\n    })\r\n    \r\n    editor.events.$on($popup, 'click', '.fr-file-autoplay-button', function (e){\r\n      if(this.parentNode.classList.contains('fr-checkbox-disabled')){\r\n        this.disabled = true\r\n        this.checked = false\r\n        return\r\n      }\r\n            let index = parseInt(this.id.split('-').pop())\r\n      checkAutoplay(index)\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-file-edit-button', function (e){\r\n      let index = parseInt(this.id.split('-').pop())\r\n      if(!$popup.find(`.fr-file-edit-button-${index}`).hasClass('fr-disabled'))\r\n          editImage(index);\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-file-view-button', function (e){\r\n      let index = parseInt(this.id.split('-').pop())\r\n      if(!$popup.find(`.fr-file-view-button-${index}`).hasClass('fr-disabled'))\r\n          viewImage(index)\r\n      \r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-file-delete-button', function (e){\r\n      let index = parseInt(this.id.split('-').pop())\r\n      deleteFile(index)\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-file-cancel-upload-button', function (e){\r\n      let index = parseInt(this.id.split('-').pop())\r\n      cancelFileUpload(index)\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-upload-delete-button', function (e){\r\n      let index = parseInt(this.id.split('-').pop())\r\n      deleteFileUpload(index)\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-file-view-close', function (e){\r\n      $popup.find('.fr-file-view-modal').get(0).outerHTML = ''\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-plugins-enable', function (e){\r\n      addPlugins()\r\n      loadPlugins(FE.PLUGINS)\r\n      editor.popups.get('filesManager.insert').get(0).outerHTML = ''\r\n      _initInsertPopup()\r\n      showInsertPopup(true)\r\n    })\r\n\r\n    editor.events.$on($popup, 'click', '.fr-plugins-cancel', function (e){\r\n      editor.popups.hide('filesManager.insert')\r\n    })\r\n\r\n    // preventing drop on file list in filesManager popup\r\n    editor.events.$on($popup, 'drop', '.fr-upload-progress', function (e) {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n    })\r\n    // Drop.\r\n    editor.events.$on($popup, 'drop', '.fr-files-upload-layer', function (e) {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      $(this).removeClass('fr-drop')\r\n      const dt = e.originalEvent.dataTransfer\r\n\r\n      if (dt && dt.files) {\r\n        const inst = $popup.data('instance') || editor\r\n        inst.events.disableBlur()\r\n        let indexes = []\r\n        for (let i = 0; i < dt.files.length; i++) {\r\n          let j = fileListIndex\r\n          file_list.set(j, dt.files[i])\r\n          showFileUploadProgressLayer(j)\r\n          checked_files.set(j,false)\r\n          indexes.push(j)\r\n          fileListIndex++\r\n        }\r\n        for(let i = 0 ; i < indexes.length ; i++){\r\n          inst.filesManager.upload(file_list.get(indexes[i]), dt.files, $current_image, indexes[i])\r\n        }\r\n        inst.events.enableBlur()\r\n      }\r\n      }, true)\r\n\r\n      if (editor.helpers.isIOS()) {\r\n        editor.events.$on($popup, 'touchstart', '.fr-files-upload-layer input[type=\"file\"]', function () {\r\n          $(this).trigger('click')\r\n        }, true)\r\n      }\r\n\r\n      editor.events.$on($popup, 'change', '.fr-files-upload-layer input[type=\"file\"]', function () {\r\n            if (this.files) {\r\n              const inst = $popup.data('instance') || editor\r\n\r\n              inst.events.disableBlur()\r\n              $popup.find('input:focus').blur()\r\n              inst.events.enableBlur()\r\n              let indexes = []\r\n              // Make sure we have what to upload.\r\n              if (typeof this.files != 'undefined' && this.files.length > 0) {\r\n                for (let i = 0; i < this.files.length; i++) {\r\n                  let j = fileListIndex\r\n                  file_list.set(j, this.files[i])\r\n                  showFileUploadProgressLayer(j)\r\n                  checked_files.set(j,false)\r\n                  ++fileListIndex\r\n                  indexes.push(j)\r\n                }\r\n                for(let i = 0 ; i < indexes.length ; i++){\r\n                  inst.filesManager.upload(file_list.get(indexes[i]), this.files, $current_image, indexes[i])\r\n                }\r\n              }\r\n\r\n            }\r\n\r\n      // Else IE 9 case.\r\n      // Chrome fix.\r\n      $(this).val('')\r\n    }, true)\r\n  }\r\n  function checkAutoplay(index){\r\n    const checkbox=document.getElementById('fr-file-autoplay-button-' + index).checked\r\n    if(checkbox){\r\n      autoplayCheckbox.push(index)\r\n    }else {\r\n      autoplayCheckbox = autoplayCheckbox.filter(function (i){\r\n        return i!=index\r\n      })\r\n    }\r\n\r\n  }\r\n  function isImage(type)\r\n  {\r\n    return type && type.split('/')[0] === 'image';\r\n    \r\n  }\r\n\r\n  function isFile(type)\r\n  {\r\n    return (type && type.split('/')[0] != 'image')&&(type && type.split('/')[0] != 'video')&&(type && type.split('/')[0] != 'audio');\r\n  }\r\n\r\n  function isVideo(type)\r\n  {\r\n    return type && type.split('/')[0] === 'video';\r\n  }\r\n\r\n  function isAudio(type)\r\n  {\r\n    return type && type.split('/')[0] === 'audio';\r\n  }\r\n\r\n  function isFormatSupported(type)\r\n  {\r\n    let webp = 'image/webp'\r\n    let webm = 'video/webm'\r\n    let ogg = 'audio/ogg'\r\n    let ogv = 'video/ogg'\r\n    if(type == ogg || type == ogv || type == webp || type == webm) {\r\n      if(editor.browser.msie || editor.browser.edge || editor.browser.safari){  \r\n        return false\r\n      }\r\n      if(editor.helpers.isMobile()){\r\n        if(type == ogg || type == ogv){\r\n          return false\r\n        }\r\n        if(!editor.helpers.isAndroid() && !editor.browser.chrome){\r\n          return false\r\n        }\r\n      }\r\n    }\r\n    return true\r\n  }\r\n\r\n  function _beforeElementDrop($el) {\r\n    if ($el.is('img') && $el.parents('.fr-img-caption').length > 0) {\r\n      return $el.parents('.fr-img-caption')\r\n    }\r\n  }\r\n\r\n  function _initEvents() {\r\n    // Mouse down on image. It might start move.\r\n    editor.events.$on(editor.$el, editor._mousedown, editor.el.tagName == 'IMG' ? null : 'img:not([contenteditable=\"false\"])', function (e) {\r\n      if ($(this).parents('contenteditable').not('.fr-element').not('.fr-img-caption').not('body').first().attr('contenteditable') == 'false') return true\r\n\r\n      if (!editor.helpers.isMobile()) editor.selection.clear()\r\n\r\n      mousedown = true\r\n\r\n      if (editor.popups.areVisible()) editor.events.disableBlur()\r\n\r\n      // Prevent the image resizing.\r\n      if (editor.browser.msie) {\r\n        editor.events.disableBlur()\r\n        editor.$el.attr('contenteditable', false)\r\n      }\r\n\r\n      if (!editor.draggable && e.type != 'touchstart') e.preventDefault()\r\n\r\n      e.stopPropagation()\r\n    })\r\n    editor.events.$on(editor.$el, editor._mousedown, '.fr-img-caption .fr-inner', function (e) {\r\n\r\n      if (!editor.core.hasFocus()) {\r\n        editor.events.focus()\r\n      }\r\n\r\n      e.stopPropagation()\r\n    })\r\n    editor.events.$on(editor.$el, 'paste', '.fr-img-caption .fr-inner', function (e) {\r\n\r\n      editor.toolbar.hide()\r\n   \r\n      e.stopPropagation()\r\n    })\r\n\r\n    // Mouse up on an image prevent move.\r\n    editor.events.$on(editor.$el, editor._mouseup, editor.el.tagName == 'IMG' ? null : 'img:not([contenteditable=\"false\"])', function (e) {\r\n      if ($(this).parents('contenteditable').not('.fr-element').not('.fr-img-caption').not('body').first().attr('contenteditable') == 'false') return true\r\n\r\n      if (mousedown) {\r\n        mousedown = false\r\n\r\n        // Remove moving class.\r\n        e.stopPropagation()\r\n\r\n        if (editor.browser.msie) {\r\n          editor.$el.attr('contenteditable', true)\r\n          editor.events.enableBlur()\r\n        }\r\n      }\r\n    })\r\n\r\n    // Show image popup when it was selected.\r\n    editor.events.on('keyup', function (e) {\r\n      if (e.shiftKey && editor.selection.text().replace(/\\n/g, '') === '' && editor.keys.isArrow(e.which)) {\r\n        const s_el = editor.selection.element()\r\n        const e_el = editor.selection.endElement()\r\n\r\n        if (s_el && s_el.tagName == 'IMG') {\r\n          _editImg($(s_el))\r\n        }\r\n        else if (e_el && e_el.tagName == 'IMG') {\r\n          _editImg($(e_el))\r\n        }\r\n      }\r\n    }, true)\r\n\r\n    // https://github.com/froala-labs/froala-editor-js-2/issues/1916\r\n    editor.events.on('window.mousedown', _markExit)\r\n    editor.events.on('window.touchmove', _unmarkExit)\r\n\r\n    editor.events.on('mouseup window.mouseup', function () {\r\n      if ($current_image) {\r\n        _exitEdit()\r\n\r\n        return false\r\n      }\r\n\r\n      _unmarkExit()\r\n    })\r\n    editor.events.on('commands.mousedown', function ($btn) {\r\n      if ($btn.parents('.fr-toolbar').length > 0) {\r\n        _exitEdit()\r\n      }\r\n    })\r\n    editor.events.on('image.resizeEnd', function () {\r\n      if (editor.opts.iframe) {\r\n        editor.size.syncIframe()\r\n      }\r\n    })\r\n\r\n    editor.events.on('blur image.hideResizer commands.undo commands.redo element.dropped', function () {\r\n      mousedown = false\r\n      _exitEdit(true)\r\n    })\r\n\r\n    editor.events.on('modals.hide', function () {\r\n      if ($current_image) {\r\n        editor.selection.clear()\r\n      }\r\n    })\r\n\r\n    editor.events.on('image.resizeEnd', function () {\r\n      if (editor.win.getSelection) {\r\n        _editImg($current_image)\r\n      }\r\n    })\r\n\r\n    // Add new line after image is inserted.\r\n    if (editor.opts.imageAddNewLine) {\r\n      editor.events.on('image.inserted', function ($img) {\r\n        let lastNode = $img.get(0)\r\n\r\n        // Ignore first BR after image.\r\n        if (lastNode.nextSibling && lastNode.nextSibling.tagName === 'BR') lastNode = lastNode.nextSibling;\r\n\r\n        // Look upper nodes.\r\n        while (lastNode && !editor.node.isElement(lastNode)) {\r\n          if (!editor.node.isLastSibling(lastNode)) {\r\n            lastNode = null;\r\n          }\r\n          else {\r\n            lastNode = lastNode.parentNode;\r\n          }\r\n        }\r\n\r\n        // If node is element, then image is last element.\r\n        if (editor.node.isElement(lastNode)) {\r\n\r\n          // ENTER_BR mode.\r\n          if (editor.opts.enter === FE.ENTER_BR) {\r\n            $img.after('<br>');\r\n          }\r\n          else {\r\n            let $parent = $(editor.node.blockParent($img.get(0)));\r\n\r\n            $parent.after(`<${editor.html.defaultTag()}><br></${editor.html.defaultTag()}>`);\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Init the image upload popup.\r\n   */\r\n\r\n  function _initInsertPopup(delayed) {\r\n    if (delayed) {\r\n      editor.popups.onRefresh('filesManager.insert', _refreshInsertPopup)\r\n      editor.popups.onHide('filesManager.insert', _hideInsertPopup)\r\n\r\n      return true\r\n    }\r\n\r\n    let active\r\n    let $popup\r\n\r\n    // Image buttons.\r\n    let image_buttons = ''\r\n\r\n    // https://github.com/froala/wysiwyg-editor/issues/2987\r\n\r\n    if (!editor.opts.imageUpload && editor.opts.filesInsertButtons.indexOf('filesUpload') !== -1) {\r\n      editor.opts.imageInsertButtons.splice(editor.opts.filesInsertButtons.indexOf('filesUpload'), 1)\r\n    }\r\n\r\n    const buttonList = editor.button.buildList(editor.opts.filesInsertButtons)\r\n    const buttonList2 = editor.button.buildList(editor.opts.filesInsertButtons2)\r\n\r\n    if (buttonList !== '') {\r\n      image_buttons = `<div class=\"fr-buttons fr-tabs\">${buttonList}<span class=\"fr-align-right\">${buttonList2}</span></div>`\r\n    }\r\n\r\n    const uploadIndex = editor.opts.filesInsertButtons.indexOf('filesUpload')\r\n    const urlIndex = editor.opts.filesInsertButtons.indexOf('filesByURL')\r\n    const embedIndex = editor.opts.filesInsertButtons.indexOf('filesEmbed')\r\n\r\n    // Image upload layer.\r\n    let upload_layer = ''\r\n\r\n    if (uploadIndex >= 0) {\r\n      active = ' fr-active'\r\n\r\n      if (urlIndex >= 0 && uploadIndex > urlIndex) {\r\n        active = ''\r\n      }\r\n       upload_layer = `<div class=\"fr-files-upload-layer${active} fr-layer \" id=\"fr-files-upload-layer-${editor.id}\"><div style=\"display:flex\"><div class=\"fr-upload-section\"><div class = 'fr-blue-decorator'><div class = 'fr-cloud-icon'><svg class = \"fr-svg\" focusable=\"false\" width=\"26px\" height=\"26px\" viewBox = \"0 0 24 24\" xlmns = \"http://w3.org/200/svg\"><path d = 'M12 6.66667a4.87654 4.87654 0 0 1 4.77525 3.92342l0.29618 1.50268 1.52794 0.10578a2.57021 2.57021 0 0 1 -0.1827 5.13478H6.5a3.49774 3.49774 0 0 1 -0.3844 -6.97454l1.06682 -0.11341L7.678 9.29387A4.86024 4.86024 0 0 1 12 6.66667m0 -2A6.871 6.871 0 0 0 5.90417 8.37 5.49773 5.49773 0 0 0 6.5 19.33333H18.41667a4.57019 4.57019 0 0 0 0.32083 -9.13A6.86567 6.86567 0 0 0 12 4.66667Zm0.99976 7.2469h1.91406L11.99976 9 9.08618 11.91357h1.91358v3H11V16h2V14h-0.00024Z'></path></svg></div>Drag & Drop One or More Files<br><div class=\"decorated\"><span> OR </span></div> Click Browse Files </div> </div><div class=\"fr-form\"><input type=\"file\" accept=\"${editor.opts.filesManagerAllowedTypes.join(',').toLowerCase()}\" tabIndex=\"-1\" aria - labelledby=\"fr-files-upload-layer-${editor.id}\"role=\"button\" multiple></div> </div></div>`    }\r\n\r\n    // File embed layer.\r\n    let embed_layer = ''\r\n    if (embedIndex >= 0) {\r\n      active = ' fr-active'\r\n\r\n      if ((embedIndex > uploadIndex && uploadIndex >= 0) || (embedIndex > urlIndex && urlIndex >= 0)) {\r\n        active = ''\r\n      }\r\n\r\n\r\n      embed_layer = `<div class=\"fr-files-embed-layer fr-layer${active}\" id=\"fr-files-embed-layer-${editor.id}\"><div class=\"fr-input-line padding-top-15\"><textarea data-gramm_editor=\"false\" style='height:60px' id=\"fr-files-embed-layer-text${editor.id}\" type=\"text\" placeholder=\"${editor.language.translate('Embedded Code')}\" tabIndex=\"1\" aria-required=\"true\" rows=\"5\"></textarea></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"insertEmbed\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Insert')}</button></div></div>`\r\n\r\n    }\r\n\r\n    // Image by url layer.\r\n    let by_url_layer = ''\r\n\r\n    if (urlIndex >= 0) {\r\n      active = ' fr-active'\r\n\r\n      if (uploadIndex >= 0 && urlIndex > uploadIndex) {\r\n        active = ''\r\n      }\r\n\r\n      by_url_layer = `<div class=\"fr-files-by-url-layer${active} fr-layer\" id=\"fr-files-by-url-layer-${editor.id}\"><div class=\"fr-input-line fr-by-url-padding\"><input id=\"fr-files-by-url-layer-text-${editor.id}\" type=\"text\" placeholder=\"http://\" tabIndex=\"1\" aria-required=\"true\"></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"filesInsertByURL\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Add')}</button></div></div>`\r\n    }\r\n\r\n    let upload_progress_layer = ''\r\n    \r\n\r\n    upload_progress_layer = `<div class = ' fr-margin-16 fr-upload-progress' id=\"fr-upload-progress-layer-${editor.id}\" ><div  class='fr-progress-bar-style'><div class='fr-progress-bar fr-none'></div></div><div id='filesList' class = 'fr-upload-progress-layer fr-layer'></div></div>`\r\n\r\n\r\n\r\n    // Progress bar.\r\n    const progress_bar_layer = '<div class=\"fr-files-progress-bar-layer fr-layer\"><h3 tabIndex=\"-1\" class=\"fr-message\">Uploading</h3><div class=\"fr-loader\"><span class=\"fr-progress\"></span></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-dismiss\" data-cmd=\"filesDismissError\" tabIndex=\"2\" role=\"button\">OK</button></div></div>'\r\n\r\n    const template = {\r\n      buttons: image_buttons,\r\n      upload_layer: upload_layer,\r\n      by_url_layer: by_url_layer,\r\n      embed_layer: embed_layer,\r\n      upload_progress_layer: upload_progress_layer,\r\n      progress_bar: progress_bar_layer\r\n    }\r\n\r\n    // Set the template in the popup.\r\n    if (editor.opts.imageInsertButtons.length >= 1) {\r\n      $popup = editor.popups.create('filesManager.insert', template)\r\n    }\r\n\r\n    if (editor.$wp) {\r\n      editor.events.$on(editor.$wp, 'scroll', function () {\r\n        if ($current_image && editor.popups.isVisible('filesManager.insert')) {\r\n          replace()\r\n        }\r\n      })\r\n    }\r\n\r\n    _bindInsertEvents($popup)\r\n    editor.popups.setPopupDimensions($popup)\r\n    return $popup\r\n  }\r\n\r\n  function _initPluginErrorPopup(){\r\n    const file_buttons = `<div class=\"fr-buttons fr-tabs\">${editor.button.buildList(editor.opts.fileInsertButtons)}</div>`\r\n    const message_layer = `<div style= 'padding:10px'>\r\n    <div class = 'fr-message'><h3 style ='font-size: 16px; margin: 10px 10px;font-weight: normal;'>${editor.language.translate( getMissingPluginsText() + ' not enabled. Do you want to enable?')}</h3></div>\r\n    <div style='text-align:right;'>\r\n      <button class='fr-trim-button fr-plugins-enable'>${editor.language.translate('Enable')}</button>               \r\n      <button class='fr-trim-button fr-plugins-cancel'>${editor.language.translate('Cancel')}</button>\r\n    </div>`\r\n    const template = {\r\n      buttons: file_buttons,\r\n      upload_layer: message_layer,\r\n      by_url_layer: '',\r\n      embed_layer: '',\r\n      upload_progress_layer: '',\r\n      progress_bar: ''\r\n    }\r\n    // Set the template in the popup.\r\n    const $popup = editor.popups.create('filesManager.insert', template)\r\n    _bindInsertEvents($popup)\r\n    return $popup\r\n  }\r\n\r\n  function getMissingPluginsText() {\r\n    let missingPlugins = ''\r\n    let plugins = getMissingPlugins()\r\n    missingPlugins = plugins.join(', ')\r\n    if(plugins.length > 1){\r\n      missingPlugins += ' plugin are'\r\n    }\r\n    else{\r\n      missingPlugins += ' plugin is'\r\n    }\r\n    return missingPlugins\r\n  }\r\n\r\n  function getMissingPlugins() {\r\n    let files = []\r\n    requiredPlugins.forEach(function(file){\r\n      if(editor.opts.pluginsEnabled.indexOf(file) < 0){\r\n        files.push(file.charAt(0).toUpperCase() + file.slice(1))\r\n      }\r\n    })\r\n    return files\r\n  }\r\n\r\n  function getFileDescription(date) {\r\n    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\r\n    let  dateFormat\r\n    try{\r\n      dateFormat = date.toLocaleDateString(editor.opts.language ? editor.opts.language : undefined, options)  \r\n    }\r\n    catch(err)\r\n    {\r\n      dateFormat = date.toLocaleDateString(undefined, options)  \r\n    } \r\n    return dateFormat+''\r\n  }\r\n\r\n  function getFileSize(size) {\r\n    if(size == 0)\r\n      return '0 Bytes'\r\n    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\r\n    var i = Math.floor(Math.log(size) / Math.log(1024));\r\n    return ' | ' + (size / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + sizes[i];\r\n  }\r\n\r\n // Get file name from url\r\nfunction getUrlFileName(url){\r\n  let fileName = url.split('/').pop()\r\n  if(fileName.split('.').length < 2){\r\n  let date = new Date()\r\n  return fileName + '-' + date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear()\r\n  }\r\n  return fileName\r\n  }\r\n\r\n\r\n  /**\r\n   * Refresh the ALT popup.\r\n   */\r\n\r\n  function _refreshAltPopup() {\r\n    if ($current_image) {\r\n      const $popup = editor.popups.get('image.alt')\r\n      $popup.find('input').val($current_image.attr('alt') || '').trigger('change')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the ALT popup.\r\n   */\r\n\r\n  function showAltPopup() {\r\n    let $popup = editor.popups.get('image.alt')\r\n\r\n    if (!$popup) $popup = _initAltPopup()\r\n    hideProgressBar()\r\n    editor.popups.refresh('image.alt')\r\n    editor.popups.setContainer('image.alt', editor.$sc)\r\n\r\n    let $el = getEl()\r\n\r\n    if (hasCaption()) {\r\n      $el = $el.find('.fr-img-wrap')\r\n    }\r\n\r\n    let left = $el.offset().left + $el.outerWidth() / 2\r\n    const top = $el.offset().top + $el.outerHeight()\r\n\r\n    editor.popups.show('image.alt', left, top, $el.outerHeight(), true)\r\n  }\r\n\r\n  /**\r\n   * Init the image upload popup.\r\n   */\r\n\r\n  function _initAltPopup(delayed) {\r\n    if (delayed) {\r\n      editor.popups.onRefresh('image.alt', _refreshAltPopup)\r\n\r\n      return true\r\n    }\r\n\r\n    // Image buttons.\r\n    let image_buttons = ''\r\n    image_buttons = `<div class=\"fr-buttons fr-tabs\">${editor.button.buildList(editor.opts.imageAltButtons)}</div>`\r\n\r\n    // Image by url layer.\r\n    let alt_layer = ''\r\n    alt_layer = `<div class=\"fr-image-alt-layer fr-layer fr-active\" id=\"fr-image-alt-layer-${editor.id}\"><div class=\"fr-input-line\"><input id=\"fr-image-alt-layer-text-${editor.id}\" type=\"text\" placeholder=\"${editor.language.translate('Alternative Text')}\" tabIndex=\"1\"></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"imageSetAlt\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Update')}</button></div></div>`\r\n\r\n    const template = {\r\n      buttons: image_buttons,\r\n      alt_layer: alt_layer\r\n    }\r\n\r\n    // Set the template in the popup.\r\n    const $popup = editor.popups.create('image.alt', template)\r\n\r\n    if (editor.$wp) {\r\n      editor.events.$on(editor.$wp, 'scroll.image-alt', function () {\r\n        if ($current_image && editor.popups.isVisible('image.alt')) {\r\n          showAltPopup()\r\n        }\r\n      })\r\n    }\r\n\r\n    return $popup\r\n  }\r\n\r\n  /**\r\n   * Set ALT based on the values from the popup.\r\n   */\r\n\r\n  function setAlt(alt) {\r\n    if ($current_image) {\r\n      const $popup = editor.popups.get('image.alt')\r\n      $current_image.attr('alt', alt || $popup.find('input').val() || '')\r\n      $popup.find('input:focus').blur()\r\n      _editImg($current_image)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the size popup.\r\n   */\r\n\r\n  // Issue 2845\r\n\r\n  function _refreshSizePopup() {\r\n    const $popup = editor.popups.get('image.size')\r\n\r\n    if ($current_image) {\r\n\r\n      if (hasCaption()) {\r\n        let $el = $current_image.parent()\r\n\r\n        if (!($el.get(0).style.width)) {\r\n          $el = $current_image.parent().parent()\r\n        }\r\n        $popup.find('input[name=\"width\"]').val($el.get(0).style.width).trigger('change')\r\n        $popup.find('input[name=\"height\"]').val($el.get(0).style.height).trigger('change')\r\n      }\r\n      else {\r\n        $popup.find('input[name=\"width\"]').val($current_image.get(0).style.width).trigger('change')\r\n        $popup.find('input[name=\"height\"]').val($current_image.get(0).style.height).trigger('change')\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the size popup.\r\n   */\r\n\r\n  function showSizePopup() {\r\n    let $popup = editor.popups.get('image.size')\r\n\r\n    if (!$popup) $popup = _initSizePopup()\r\n    hideProgressBar()\r\n    editor.popups.refresh('image.size')\r\n    editor.popups.setContainer('image.size', editor.$sc)\r\n\r\n    let $el = getEl()\r\n\r\n    if (hasCaption()) {\r\n      $el = $el.find('.fr-img-wrap')\r\n    }\r\n\r\n    let left = $el.offset().left + $el.outerWidth() / 2\r\n    const top = $el.offset().top + $el.outerHeight()\r\n\r\n    editor.popups.show('image.size', left, top, $el.outerHeight(), true)\r\n  }\r\n\r\n  /**\r\n   * Init the image upload popup.\r\n   */\r\n\r\n  function _initSizePopup(delayed) {\r\n    if (delayed) {\r\n      editor.popups.onRefresh('image.size', _refreshSizePopup)\r\n\r\n      return true\r\n    }\r\n\r\n    // Image buttons.\r\n    let image_buttons = ''\r\n    image_buttons = `<div class=\"fr-buttons fr-tabs\">${editor.button.buildList(editor.opts.imageSizeButtons)}</div>`\r\n\r\n    // Size layer.\r\n    let size_layer = ''\r\n    size_layer = `<div class=\"fr-image-size-layer fr-layer fr-active\" id=\"fr-image-size-layer-${editor.id}\"><div class=\"fr-image-group\"><div class=\"fr-input-line\"><input id=\"fr-image-size-layer-width-'${editor.id}\" type=\"text\" name=\"width\" placeholder=\"${editor.language.translate('Width')}\" tabIndex=\"1\"></div><div class=\"fr-input-line\"><input id=\"fr-image-size-layer-height${editor.id}\" type=\"text\" name=\"height\" placeholder=\"${editor.language.translate('Height')}\" tabIndex=\"1\"></div></div><div class=\"fr-action-buttons\"><button type=\"button\" class=\"fr-command fr-submit\" data-cmd=\"imageSetSize\" tabIndex=\"2\" role=\"button\">${editor.language.translate('Update')}</button></div></div>`\r\n\r\n    const template = {\r\n      buttons: image_buttons,\r\n      size_layer: size_layer\r\n    }\r\n\r\n    // Set the template in the popup.\r\n    const $popup = editor.popups.create('image.size', template)\r\n\r\n    if (editor.$wp) {\r\n      editor.events.$on(editor.$wp, 'scroll.image-size', function () {\r\n        if ($current_image && editor.popups.isVisible('image.size')) {\r\n          showSizePopup()\r\n        }\r\n      })\r\n    }\r\n\r\n    return $popup\r\n  }\r\n\r\n  /**\r\n   * Set size based on the current image size.\r\n   */\r\n\r\n  function setSize(width, height) {\r\n    if ($current_image) {\r\n      const $popup = editor.popups.get('image.size')\r\n      width = width || $popup.find('input[name=\"width\"]').val() || ''\r\n      height = height || $popup.find('input[name=\"height\"]').val() || ''\r\n      const regex = /^[\\d]+((px)|%)*$/g\r\n\r\n      $current_image.removeAttr('width').removeAttr('height')\r\n\r\n      if (width.match(regex)) $current_image.css('width', width)\r\n      else $current_image.css('width', '')\r\n\r\n      if (height.match(regex)) $current_image.css('height', height)\r\n      else $current_image.css('height', '')\r\n\r\n      if (hasCaption()) {\r\n        $current_image.parents('.fr-img-caption').removeAttr('width').removeAttr('height')\r\n\r\n        if (width.match(regex)) $current_image.parents('.fr-img-caption').css('width', width)\r\n        else $current_image.parents('.fr-img-caption').css('width', '')\r\n\r\n        if (height.match(regex)) $current_image.parents('.fr-img-caption').css('height', height)\r\n        else $current_image.parents('.fr-img-caption').css('height', '')\r\n      }\r\n\r\n      if ($popup) $popup.find('input:focus').blur()\r\n      _editImg($current_image)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Show the image upload layer.\r\n   */\r\n\r\n  function showLayer(name) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n\r\n    let left\r\n    let top\r\n\r\n    // Click on the button from the toolbar without image selected.\r\n    if (!$current_image && !editor.opts.toolbarInline) {\r\n      const $btn = editor.$tb.find('.fr-command[data-cmd=\"insertFiles\"]')\r\n      left = $btn.offset().left\r\n      top = $btn.offset().top + (editor.opts.toolbarBottom ? 10 : $btn.outerHeight() - 10)\r\n    }\r\n\r\n    // Image is selected.\r\n    else if ($current_image) {\r\n\r\n      let $el = getEl()\r\n\r\n      if (hasCaption()) {\r\n        $el = $el.find('.fr-img-wrap')\r\n      }\r\n\r\n      // Set the top to the bottom of the image.\r\n      top = $el.offset().top + $el.outerHeight()\r\n      left = $el.offset().left\r\n    }\r\n\r\n    // Image is selected and we are in inline mode.\r\n    if (!$current_image && editor.opts.toolbarInline) {\r\n\r\n      // Set top to the popup top.\r\n      top = $popup.offset().top - editor.helpers.getPX($popup.css('margin-top'))\r\n\r\n      // If the popup is above apply height correction.\r\n      if ($popup.hasClass('fr-above')) {\r\n        top += $popup.outerHeight()\r\n      }\r\n    }\r\n\r\n    // Show the new layer.\r\n    $popup.find('.fr-layer').removeClass('fr-active')\r\n    $popup.find(`.fr-${name}-layer`).addClass('fr-active')\r\n    $popup.find(`.fr-upload-progress-layer`).addClass('fr-active')\r\n    editor.popups.show('filesManager.insert', left, top, ($current_image ? $current_image.outerHeight() : 0))\r\n    editor.accessibility.focusPopup($popup)\r\n  }\r\n\r\n  /**\r\n   * Refresh the upload image button.\r\n   */\r\n\r\n  function refreshUploadButton($btn) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    if ($popup && $popup.find('.fr-files-upload-layer').hasClass('fr-active')) {\r\n      $btn.addClass('fr-active').attr('aria-pressed', true)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh the insert by url button.\r\n   */\r\n\r\n  function refreshByURLButton($btn) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    if ($popup && $popup.find('.fr-files-by-url-layer').hasClass('fr-active')) {\r\n      $btn.addClass('fr-active').attr('aria-pressed', true)\r\n    }\r\n  }\r\n\r\n  function _resizeImage(e, initPageX, direction, step) {\r\n    e.pageX = initPageX\r\n    _handlerMousedown.call(this, e)\r\n    e.pageX = e.pageX + direction * Math.floor(Math.pow(1.1, step))\r\n    _handlerMousemove.call(this, e)\r\n    _handlerMouseup.call(this, e)\r\n\r\n    return ++step\r\n  }\r\n\r\n  /**\r\n   * Init image resizer.\r\n   */\r\n  function _initImageResizer() {\r\n    let doc\r\n\r\n    // No shared image resizer.\r\n    if (!editor.shared.$image_resizer) {\r\n\r\n      // Create shared image resizer.\r\n      editor.shared.$image_resizer = $(document.createElement('div')).attr('class', 'fr-image-resizer')\r\n      $image_resizer = editor.shared.$image_resizer\r\n\r\n      // Bind mousedown event shared.\r\n      editor.events.$on($image_resizer, 'mousedown', function (e) {\r\n        e.stopPropagation()\r\n      }, true)\r\n\r\n      // Image resize is enabled.\r\n      if (editor.opts.imageResize) {\r\n        $image_resizer.append(_getHandler('nw') + _getHandler('ne') + _getHandler('sw') + _getHandler('se'))\r\n\r\n        // Add image resizer overlay and set it.\r\n        editor.shared.$img_overlay = $(document.createElement('div')).attr('class', 'fr-image-overlay')\r\n        $overlay = editor.shared.$img_overlay\r\n        doc = $image_resizer.get(0).ownerDocument\r\n        $(doc).find('body').first().append($overlay)\r\n      }\r\n    }\r\n    else {\r\n      $image_resizer = editor.shared.$image_resizer\r\n      $overlay = editor.shared.$img_overlay\r\n\r\n      editor.events.on('destroy', function () {\r\n        $('body').first().append($image_resizer.removeClass('fr-active'))\r\n      }, true)\r\n    }\r\n\r\n    // Shared destroy.\r\n    editor.events.on('shared.destroy', function () {\r\n      $image_resizer.html('').removeData().remove()\r\n      $image_resizer = null\r\n\r\n      if (editor.opts.imageResize) {\r\n        $overlay.remove()\r\n        $overlay = null\r\n      }\r\n    }, true)\r\n\r\n    // Window resize. Exit from edit.\r\n    if (!editor.helpers.isMobile()) {\r\n      editor.events.$on($(editor.o_win), 'resize', function () {\r\n        if ($current_image && !$current_image.hasClass('fr-uploading')) {\r\n          _exitEdit(true)\r\n        }\r\n        else if ($current_image) {\r\n          _repositionResizer()\r\n          replace()\r\n          showProgressBar(false)\r\n        }\r\n      })\r\n    }\r\n\r\n    // Image resize is enabled.\r\n    if (editor.opts.imageResize) {\r\n      doc = $image_resizer.get(0).ownerDocument\r\n      editor.events.$on($image_resizer, editor._mousedown, '.fr-handler', _handlerMousedown)\r\n      editor.events.$on($(doc), editor._mousemove, _handlerMousemove)\r\n      editor.events.$on($(doc.defaultView || doc.parentWindow), editor._mouseup, _handlerMouseup)\r\n      editor.events.$on($overlay, 'mouseleave', _handlerMouseup)\r\n\r\n      // Accessibility.\r\n\r\n      // Used for keys holing.\r\n      let step = 1\r\n      let prevKey = null\r\n      let prevTimestamp = 0\r\n\r\n      // Keydown event.\r\n      editor.events.on('keydown', function (e) {\r\n        if ($current_image) {\r\n          const ctrlKey = navigator.userAgent.indexOf('Mac OS X') != -1 ? e.metaKey : e.ctrlKey\r\n          const keycode = e.which\r\n\r\n          if (keycode !== prevKey || e.timeStamp - prevTimestamp > 200) {\r\n            step = 1\r\n\r\n            // Reset step. Known browser issue: Keyup does not trigger when ctrl is pressed.\r\n          }\r\n\r\n          // Increase image size.\r\n          if ((keycode == FE.KEYCODE.EQUALS || (editor.browser.mozilla && keycode == FE.KEYCODE.FF_EQUALS)) && ctrlKey && !e.altKey) {\r\n            step = _resizeImage.call(this, e, 1, 1, step)\r\n          }\r\n\r\n          // Decrease image size.\r\n          else if ((keycode == FE.KEYCODE.HYPHEN || (editor.browser.mozilla && keycode == FE.KEYCODE.FF_HYPHEN)) && ctrlKey && !e.altKey) {\r\n            step = _resizeImage.call(this, e, 2, -1, step)\r\n          }\r\n          else if (!editor.keys.ctrlKey(e) && keycode == FE.KEYCODE.ENTER) {\r\n            $current_image.before('<br>')\r\n            _editImg($current_image)\r\n          }\r\n\r\n          // Save key code.\r\n          prevKey = keycode\r\n\r\n          // Save timestamp.\r\n          prevTimestamp = e.timeStamp\r\n        }\r\n      }, true)\r\n\r\n      // Reset the step on key up event.\r\n      editor.events.on('keyup', function () {\r\n        step = 1\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove the current image.\r\n   */\r\n  function remove($img) {\r\n    $img = $img || getEl()\r\n\r\n    if ($img) {\r\n      if (editor.events.trigger('image.beforeRemove', [$img]) !== false) {\r\n        editor.popups.hideAll()\r\n        _exitEdit(true)\r\n\r\n        if (!editor.undo.canDo()) editor.undo.saveStep()\r\n\r\n        if ($img.get(0) == editor.el) {\r\n          $img.removeAttr('src')\r\n        }\r\n        else {\r\n          if ($img.get(0).parentNode && $img.get(0).parentNode.tagName == 'A') {\r\n            editor.selection.setBefore($img.get(0).parentNode) || editor.selection.setAfter($img.get(0).parentNode) || $img.parent().after(FE.MARKERS)\r\n            $($img.get(0).parentNode).remove()\r\n          }\r\n          else {\r\n            editor.selection.setBefore($img.get(0)) || editor.selection.setAfter($img.get(0)) || $img.after(FE.MARKERS)\r\n            $img.remove()\r\n          }\r\n\r\n          editor.html.fillEmptyBlocks()\r\n          editor.selection.restore()\r\n        }\r\n\r\n        editor.undo.saveStep()\r\n      }\r\n    }\r\n  }\r\n\r\n  function _editorKeydownHandler(e) {\r\n    const key_code = e.which\r\n\r\n    if ($current_image && (key_code == FE.KEYCODE.BACKSPACE || key_code == FE.KEYCODE.DELETE)) {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      remove()\r\n\r\n      return false\r\n    }\r\n    else if ($current_image && key_code == FE.KEYCODE.ESC) {\r\n      const $img = $current_image\r\n      _exitEdit(true)\r\n      editor.selection.setAfter($img.get(0))\r\n      editor.selection.restore()\r\n      e.preventDefault()\r\n\r\n      return false\r\n    }\r\n\r\n    // Move cursor if left and right arrows are used.\r\n    else if ($current_image && (key_code == FE.KEYCODE.ARROW_LEFT || key_code == FE.KEYCODE.ARROW_RIGHT)) {\r\n      const img = $current_image.get(0)\r\n      _exitEdit(true)\r\n\r\n      if (key_code == FE.KEYCODE.ARROW_LEFT) {\r\n        editor.selection.setBefore(img)\r\n      }\r\n      else {\r\n        editor.selection.setAfter(img)\r\n      }\r\n\r\n      editor.selection.restore()\r\n      e.preventDefault()\r\n\r\n      return false\r\n    }\r\n    else if ($current_image && key_code === FE.KEYCODE.TAB) {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n      _exitEdit(true)\r\n\r\n      return false\r\n    }\r\n    else if ($current_image && key_code != FE.KEYCODE.F10 && !editor.keys.isBrowserAction(e)) {\r\n      e.preventDefault()\r\n      e.stopPropagation()\r\n\r\n      return false\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Do some cleanup on images.\r\n   */\r\n  function _cleanOnGet(el) {\r\n\r\n    // Tag is image.\r\n    if (el && el.tagName == 'IMG') {\r\n\r\n      // Remove element if it has class fr-uploading or fr-error.\r\n      if (editor.node.hasClass(el, 'fr-uploading') || editor.node.hasClass(el, 'fr-error')) {\r\n        el.parentNode.removeChild(el)\r\n      }\r\n\r\n      // Remove class if it is draggable.\r\n      else if (editor.node.hasClass(el, 'fr-draggable')) {\r\n        el.classList.remove('fr-draggable')\r\n      }\r\n\r\n      if (el.parentNode && el.parentNode.parentNode && editor.node.hasClass(el.parentNode.parentNode, 'fr-img-caption')) {\r\n        const p_node = el.parentNode.parentNode\r\n        p_node.removeAttribute('contenteditable')\r\n        p_node.removeAttribute('draggable')\r\n        p_node.classList.remove('fr-draggable')\r\n\r\n        const n_node = el.nextSibling\r\n\r\n        if (n_node) {\r\n          n_node.removeAttribute('contenteditable')\r\n        }\r\n      }\r\n    }\r\n\r\n    // Look for inner nodes that might be in a similar case.\r\n    else if (el && el.nodeType == Node.ELEMENT_NODE) {\r\n      const imgs = el.querySelectorAll('img.fr-uploading, img.fr-error, img.fr-draggable')\r\n\r\n      for (let i = 0; i < imgs.length; i++) {\r\n        _cleanOnGet(imgs[i])\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialization.\r\n   */\r\n  function _init() {\r\n    _initEvents()\r\n\r\n    // Init on image.\r\n    if (editor.el.tagName == 'IMG') {\r\n      editor.$el.addClass('fr-view')\r\n    }\r\n\r\n    if (editor.helpers.isMobile()) {\r\n      editor.events.$on(editor.$el, 'touchstart', editor.el.tagName == 'IMG' ? null : 'img:not([contenteditable=\"false\"])', function () {\r\n        touchScroll = false\r\n      })\r\n\r\n      editor.events.$on(editor.$el, 'touchmove', function () {\r\n        touchScroll = true\r\n      })\r\n    }\r\n\r\n    if (editor.$wp) {\r\n      editor.events.on('window.keydown keydown', _editorKeydownHandler, true)\r\n\r\n      editor.events.on('keyup', function (e) {\r\n        if ($current_image && e.which == FE.KEYCODE.ENTER) {\r\n\r\n          return false\r\n        }\r\n      }, true)\r\n\r\n      // Prevent typing in image caption DOM structure.\r\n      editor.events.$on(editor.$el, 'keydown', function () {\r\n        let el = editor.selection.element()\r\n\r\n        // Parent node of the current element.\r\n        if (el.nodeType === Node.TEXT_NODE || (el.tagName == 'BR' && editor.node.isLastSibling(el))) {\r\n          el = el.parentNode\r\n        }\r\n\r\n        if (!editor.node.hasClass(el, 'fr-inner')) {\r\n          if (!editor.node.hasClass(el, 'fr-img-caption')) {\r\n            el = $(el).parents('.fr-img-caption').get(0)\r\n          }\r\n\r\n          // Check if we are in image caption.\r\n          if (editor.node.hasClass(el, 'fr-img-caption')) {\r\n            $(el).after(FE.INVISIBLE_SPACE + FE.MARKERS);\r\n            editor.selection.restore();\r\n          }\r\n        }\r\n      })\r\n    }\r\n    else {\r\n      editor.events.$on(editor.$win, 'keydown', _editorKeydownHandler)\r\n    }\r\n\r\n    // ESC from accessibility.\r\n    editor.events.on('toolbar.esc', function () {\r\n      if ($current_image) {\r\n        if (editor.$wp) {\r\n          editor.events.disableBlur()\r\n          editor.events.focus()\r\n        }\r\n        else {\r\n          const $img = $current_image\r\n          _exitEdit(true)\r\n          editor.selection.setAfter($img.get(0))\r\n          editor.selection.restore()\r\n        }\r\n\r\n        return false\r\n      }\r\n    }, true)\r\n\r\n    // focusEditor from accessibility.\r\n    editor.events.on('toolbar.focusEditor', function () {\r\n      if ($current_image) {\r\n\r\n        return false\r\n      }\r\n    }, true)\r\n\r\n    // Copy/cut image.\r\n    editor.events.on('window.cut window.copy', function (e) {\r\n      // Do copy only if image.edit popups is visible and not focused.\r\n      if ($current_image && editor.popups.isVisible('image.edit') && !editor.popups.get('image.edit').find(':focus').length) {\r\n\r\n        const $el = getEl()\r\n\r\n        if (hasCaption()) {\r\n          $el.before(FE.START_MARKER)\r\n          $el.after(FE.END_MARKER)\r\n          editor.selection.restore()\r\n          editor.paste.saveCopiedText($el.get(0).outerHTML, $el.text())\r\n        }\r\n        else {\r\n          editor.paste.saveCopiedText($current_image.get(0).outerHTML, $current_image.attr('alt'))\r\n        }\r\n\r\n        if (e.type == 'copy') {\r\n          setTimeout(function () {\r\n            _editImg($current_image)\r\n          })\r\n        }\r\n        else {\r\n          _exitEdit(true)\r\n          editor.undo.saveStep()\r\n          setTimeout(function () {\r\n            editor.undo.saveStep()\r\n          }, 0)\r\n        }\r\n      }\r\n    }, true)\r\n\r\n    // Fix IE copy not working when selection is collapsed.\r\n    if (editor.browser.msie) {\r\n      editor.events.on('keydown', function (e) {\r\n        // Selection is collapsed and we have an image.\r\n        if (!(editor.selection.isCollapsed() && $current_image)) return true\r\n\r\n        const key_code = e.which\r\n\r\n        // Copy.\r\n        if (key_code == FE.KEYCODE.C && editor.keys.ctrlKey(e)) {\r\n          editor.events.trigger('window.copy')\r\n        }\r\n\r\n        // Cut.\r\n        else if (key_code == FE.KEYCODE.X && editor.keys.ctrlKey(e)) {\r\n          editor.events.trigger('window.cut')\r\n        }\r\n      })\r\n    }\r\n\r\n    // Do not leave page while uploading.\r\n    editor.events.$on($(editor.o_win), 'keydown', function (e) {\r\n      const key_code = e.which\r\n\r\n      if ($current_image && key_code == FE.KEYCODE.BACKSPACE) {\r\n        e.preventDefault()\r\n\r\n        return false\r\n      }\r\n    })\r\n\r\n    // Check if image is uploading to abort it.\r\n    editor.events.$on(editor.$win, 'keydown', function (e) {\r\n      const key_code = e.which\r\n\r\n      if ($current_image && $current_image.hasClass('fr-uploading') && key_code == FE.KEYCODE.ESC) {\r\n        $current_image.trigger('abortUpload')\r\n      }\r\n    })\r\n\r\n    editor.events.on('destroy', function () {\r\n      if ($current_image && $current_image.hasClass('fr-uploading')) {\r\n        $current_image.trigger('abortUpload')\r\n      }\r\n    })\r\n\r\n    editor.events.on('paste.before', _clipboardPaste)\r\n    editor.events.on('paste.beforeCleanup', _clipboardPasteCleanup)\r\n    editor.events.on('paste.after', _uploadPastedImages)\r\n\r\n    // Remove any fr-uploading / fr-error images.\r\n    editor.events.on('html.processGet', _cleanOnGet)\r\n\r\n    if (editor.opts.imageOutputSize) {\r\n      let imgs\r\n\r\n      editor.events.on('html.beforeGet', function () {\r\n        imgs = editor.el.querySelectorAll('img')\r\n        for (let i = 0; i < imgs.length; i++) {\r\n          const width = imgs[i].style.width || $(imgs[i]).width()\r\n          const height = imgs[i].style.height || $(imgs[i]).height()\r\n\r\n          if (width) imgs[i].setAttribute('width', (`${width}`).replace(/px/, ''))\r\n\r\n          if (height) imgs[i].setAttribute('height', (`${height}`).replace(/px/, ''))\r\n        }\r\n      })\r\n    }\r\n\r\n    if (editor.opts.iframe) {\r\n      editor.events.on('image.loaded', editor.size.syncIframe)\r\n    }\r\n\r\n    editor.events.$on($(editor.o_win), 'orientationchange.image', function () {\r\n      setTimeout(function () {\r\n        if ($current_image) {\r\n          _editImg($current_image)\r\n        }\r\n      }, 100)\r\n    })\r\n\r\n    _initEditPopup(true)\r\n    _initInsertPopup(true)\r\n    _initSizePopup(true)\r\n    _initAltPopup(true)\r\n\r\n    editor.events.on('node.remove', function ($node) {\r\n      if ($node.get(0).tagName == 'IMG') {\r\n        remove($node)\r\n\r\n        return false\r\n      }\r\n    })\r\n\r\n    editor.events.on('popups.hide.filesManager.insert', function ($node) {\r\n      editor.filesManager.minimizePopup(current_index)\r\n    })\r\n  }\r\n\r\n  function _processPastedImage(img) {\r\n    if (editor.events.trigger('image.beforePasteUpload', [img]) === false) {\r\n\r\n      return false\r\n    }\r\n\r\n    // Show the progress bar.\r\n    $current_image = $(img)\r\n    _repositionResizer()\r\n    showProgressBar()\r\n\r\n    $current_image.on('load', function () {\r\n      let loadEvents = []\r\n\r\n      _repositionResizer()\r\n      // https://github.com/froala/wysiwyg-editor/issues/3407\r\n      if ($(editor.popups.get('filesManager.insert').get(0)).find('div.fr-active.fr-error').length < 1) {\r\n        showProgressBar()\r\n      }\r\n\r\n      // https://github.com/froala-labs/froala-editor-js-2/issues/1866\r\n      $(this).data('events').find(function(event) {\r\n        if (event[0] === 'load') {\r\n          loadEvents.push(event)\r\n        }\r\n      })\r\n      \r\n      // turn off the event if it is registered only once\r\n      loadEvents.length <= 1 && $(this).off('load')\r\n    })\r\n\r\n    const splitSrc = $(img).attr('src').split(',')\r\n\r\n    // Convert image to blob.\r\n    const binary = atob(splitSrc[1])\r\n    const array = []\r\n\r\n    for (let i = 0; i < binary.length; i++) {\r\n      array.push(binary.charCodeAt(i))\r\n    }\r\n\r\n    const upload_img = new Blob([new Uint8Array(array)], {\r\n      type: splitSrc[0].replace(/data\\:/g, '').replace(/;base64/g, '')\r\n    })\r\n\r\n    upload(upload_img, $current_image)\r\n  }\r\n\r\n  function _uploadPastedImages() {\r\n    if (!editor.opts.imagePaste) {\r\n      editor.$el.find('img[data-fr-image-pasted]').remove()\r\n    }\r\n    else {\r\n\r\n      // Safari won't work https://bugs.webkit.org/show_bug.cgi?id=49141\r\n      editor.$el.find('img[data-fr-image-pasted]').each(function (index, img) {\r\n        if (editor.opts.imagePasteProcess) {\r\n          let width = editor.opts.imageDefaultWidth\r\n\r\n          if (width && width != 'auto') {\r\n            width = width + (editor.opts.imageResizeWithPercent ? '%' : 'px')\r\n          }\r\n          $(img)\r\n            .css('width', width)\r\n            .removeClass('fr-dii fr-dib fr-fir fr-fil')\r\n\r\n          _setStyleImage($(img), editor.opts.imageDefaultDisplay, editor.opts.imageDefaultAlign)\r\n        }\r\n\r\n        // Data images.\r\n        if (img.src.indexOf('data:') === 0) {\r\n          _processPastedImage(img)\r\n        }\r\n\r\n        // New way Safari is pasting images.\r\n        else if (img.src.indexOf('blob:') === 0 || (img.src.indexOf('http') === 0 && editor.opts.imageUploadRemoteUrls && editor.opts.imageCORSProxy)) {\r\n          const _img = new Image()\r\n          _img.crossOrigin = 'Anonymous'\r\n          _img.onload = function () {\r\n            // Create canvas.\r\n            const canvas = editor.o_doc.createElement('CANVAS')\r\n            const context = canvas.getContext('2d')\r\n\r\n            // Set height.\r\n            canvas.height = this.naturalHeight\r\n            canvas.width = this.naturalWidth\r\n\r\n            // Draw image.\r\n            context.drawImage(this, 0, 0)\r\n\r\n            // pushing the execution at end of the stack\r\n            setTimeout(function () {\r\n              _processPastedImage(img)\r\n            }, 0)\r\n\r\n            let imgExt\r\n\r\n            if (this.naturalWidth > 2000 || this.naturalHeight > 1500) {\r\n              imgExt = 'jpeg' // if images are too large\r\n            }\r\n            else {\r\n              imgExt = 'png'\r\n            }\r\n            // Update image and process it.\r\n            img.src = canvas.toDataURL(`image/${imgExt}`)\r\n          }\r\n          _img.src = (img.src.indexOf('blob:') === 0 ? '' : (`${editor.opts.imageCORSProxy}/`)) + img.src\r\n        }\r\n\r\n        // Images without http (Safari ones.).\r\n        else if (img.src.indexOf('http') !== 0 || img.src.indexOf('https://mail.google.com/mail') === 0) {\r\n          editor.selection.save()\r\n          $(img).remove()\r\n          editor.selection.restore()\r\n        }\r\n        else {\r\n          $(img).removeAttr('data-fr-image-pasted')\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  function _clipboardImageLoaded(e) {\r\n    const result = e.target.result\r\n\r\n    // Default width.\r\n    let width = editor.opts.imageDefaultWidth\r\n\r\n    if (width && width != 'auto') {\r\n      width = width + (editor.opts.imageResizeWithPercent ? '%' : 'px')\r\n    }\r\n\r\n    editor.undo.saveStep()\r\n\r\n    editor.html.insert(`<img data-fr-image-pasted=\"true\" src=\"${result}\"${(width ? ` style=\"width: ${width};\"` : '')}>`)\r\n\r\n    const $img = editor.$el.find('img[data-fr-image-pasted=\"true\"]')\r\n\r\n    if ($img) {\r\n      _setStyleImage($img, editor.opts.imageDefaultDisplay, editor.opts.imageDefaultAlign)\r\n    }\r\n\r\n    editor.events.trigger('paste.after')\r\n  }\r\n\r\n  function _processsClipboardPaste(file) {\r\n    const reader = new FileReader()\r\n    reader.onload = _clipboardImageLoaded\r\n    reader.readAsDataURL(file)\r\n  }\r\n\r\n  function _clipboardPaste(e) {\r\n    if (e && e.clipboardData && e.clipboardData.items) {\r\n\r\n      let file = null\r\n\r\n      if (!((e.clipboardData.types && [].indexOf.call(e.clipboardData.types, 'text/rtf') != -1) || e.clipboardData.getData('text/rtf'))) {\r\n        for (let i = 0; i < e.clipboardData.items.length; i++) {\r\n          file = e.clipboardData.items[i].getAsFile()\r\n\r\n          if (file) {\r\n            break\r\n          }\r\n        }\r\n      }\r\n      else {\r\n        file = e.clipboardData.items[0].getAsFile()\r\n      }\r\n\r\n      if (file) {\r\n        _processsClipboardPaste(file)\r\n\r\n        return false\r\n      }\r\n    }\r\n  }\r\n\r\n  function _clipboardPasteCleanup(clipboard_html) {\r\n    clipboard_html = clipboard_html.replace(/<img /gi, '<img data-fr-image-pasted=\"true\" ')\r\n\r\n    return clipboard_html\r\n  }\r\n\r\n  /**\r\n   * Start edit.\r\n   */\r\n  let touchScroll\r\n\r\n  function _edit(e) {\r\n    if ($(this).parents('[contenteditable]').not('.fr-element').not('.fr-img-caption').not('body').first().attr('contenteditable') == 'false') return true\r\n\r\n    if (e && e.type == 'touchend' && touchScroll) {\r\n\r\n      return true\r\n    }\r\n\r\n    if (e && editor.edit.isDisabled()) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n\r\n      return false\r\n    }\r\n\r\n    // Hide resizer for other instances.\r\n    for (let i = 0; i < FE.INSTANCES.length; i++) {\r\n      if (FE.INSTANCES[i] != editor) {\r\n        FE.INSTANCES[i].events.trigger('image.hideResizer')\r\n      }\r\n    }\r\n\r\n    editor.toolbar.disable()\r\n\r\n    if (e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n    }\r\n\r\n    // Hide keyboard.\r\n    if (editor.helpers.isMobile()) {\r\n      editor.events.disableBlur()\r\n      editor.$el.blur()\r\n      editor.events.enableBlur()\r\n    }\r\n\r\n    if (editor.opts.iframe) {\r\n      editor.size.syncIframe()\r\n    }\r\n\r\n    // Store current image.\r\n    $current_image = $(this)\r\n\r\n    // Reposition resizer.\r\n    _repositionResizer()\r\n\r\n    // Issue 2801\r\n    if (editor.browser.msie) {\r\n      if (editor.popups.areVisible()) {\r\n        editor.events.disableBlur()\r\n      }\r\n\r\n      if (editor.win.getSelection) {\r\n        editor.win.getSelection().removeAllRanges()\r\n        editor.win.getSelection().addRange(editor.doc.createRange())\r\n      }\r\n    }\r\n    else {\r\n      editor.selection.clear()\r\n    }\r\n\r\n    // Fix for image remaining selected.\r\n    if (editor.helpers.isIOS()) {\r\n      editor.events.disableBlur()\r\n      editor.$el.blur()\r\n    }\r\n\r\n    // Refresh buttons.\r\n    editor.button.bulkRefresh()\r\n    editor.events.trigger('video.hideResizer')\r\n  }\r\n\r\n  /**\r\n   * Exit edit.\r\n   */\r\n\r\n  function _exitEdit(force_exit) {\r\n    if ($current_image && (_canExit() || force_exit === true)) {\r\n      editor.toolbar.enable()\r\n      $image_resizer && $image_resizer.removeClass('fr-active')\r\n      editor.popups.hide('image.edit')\r\n      $current_image = null\r\n      _unmarkExit()\r\n\r\n      $handler = null\r\n\r\n      if ($overlay) {\r\n        $overlay.hide()\r\n      }\r\n    }\r\n  }\r\n\r\n  let img_exit_flag = false\r\n\r\n  function _markExit() {\r\n    img_exit_flag = true\r\n  }\r\n\r\n  function _unmarkExit() {\r\n    img_exit_flag = false\r\n  }\r\n\r\n  function _canExit() {\r\n\r\n    return img_exit_flag\r\n  }\r\n\r\n  function _setStyleVideo($video, _display, _align) {\r\n    if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n      $video.removeClass('fr-fvl fr-fvr fr-dvb fr-dvi') \r\n      $video.addClass(`fr-fv${_align[0]} fr-dv${_display[0]}`) \r\n    }\r\n    else {\r\n      if (_display == 'inline') {\r\n        $video.css({\r\n          display: 'inline-block'\r\n        })\r\n\r\n        if (_align == 'center') {\r\n          $video.css({\r\n            'float': 'none'\r\n          })\r\n        }\r\n        else if (_align == 'left') {\r\n          $video.css({\r\n            'float': 'left'\r\n          })\r\n        }\r\n        else {\r\n          $video.css({\r\n            'float': 'right'\r\n          })\r\n        }\r\n      }\r\n      else {\r\n        $video.css({\r\n          display: 'block',\r\n          clear: 'both'\r\n        })\r\n\r\n        if (_align == 'left') {\r\n          $video.css({\r\n            textAlign: 'left'\r\n          })\r\n        }\r\n        else if (_align == 'right') {\r\n          $video.css({\r\n            textAlign: 'right'\r\n          })\r\n        }\r\n        else {\r\n          $video.css({\r\n            textAlign: 'center'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * Set style for image.\r\n   */\r\n  function _setStyleImage($img, _display, _align) {\r\n\r\n    if (!editor.opts.htmlUntouched && editor.opts.useClasses) {\r\n      $img.removeClass('fr-fil fr-fir fr-dib fr-dii')\r\n\r\n      if (_align) {\r\n        $img.addClass(`fr-fi${_align[0]}`)\r\n      }\r\n\r\n      if (_display) {\r\n        $img.addClass(`fr-di${_display[0]}`)\r\n      }\r\n    }\r\n    else {\r\n      if (_display == 'inline') {\r\n        $img.css({\r\n          display: 'inline-block',\r\n          verticalAlign: 'bottom',\r\n          margin: editor.opts.imageDefaultMargin\r\n        })\r\n\r\n        if (_align == 'center') {\r\n          $img.css({\r\n            'float': 'none',\r\n            marginBottom: '',\r\n            marginTop: '',\r\n            maxWidth: `calc(100% - ${(2 * editor.opts.imageDefaultMargin)}px)`,\r\n            textAlign: 'center'\r\n          })\r\n        }\r\n        else if (_align == 'left') {\r\n          $img.css({\r\n            'float': 'left',\r\n            marginLeft: 0,\r\n            maxWidth: `calc(100% - ${editor.opts.imageDefaultMargin}px)`,\r\n            textAlign: 'left'\r\n          })\r\n        }\r\n        else {\r\n          $img.css({\r\n            'float': 'right',\r\n            marginRight: 0,\r\n            maxWidth: `calc(100% - ${editor.opts.imageDefaultMargin}px)`,\r\n            textAlign: 'right'\r\n          })\r\n        }\r\n      }\r\n      else if (_display == 'block') {\r\n        $img.css({\r\n          display: 'block',\r\n          'float': 'none',\r\n          verticalAlign: 'top',\r\n          margin: `${editor.opts.imageDefaultMargin}px auto`,\r\n          textAlign: 'center'\r\n        })\r\n\r\n        if (_align == 'left') {\r\n          $img.css({\r\n            marginLeft: 0,\r\n            textAlign: 'left'\r\n          })\r\n        }\r\n        else if (_align == 'right') {\r\n          $img.css({\r\n            marginRight: 0,\r\n            textAlign: 'right'\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n \r\n  /**\r\n   * Get the current image.\r\n   */\r\n\r\n  function get() {\r\n\r\n    return $current_image\r\n  }\r\n\r\n  function getEl() {\r\n    return hasCaption() ? $current_image.parents('.fr-img-caption').first() : $current_image\r\n  }\r\n\r\n  /**\r\n   * Apply specific style.\r\n   */\r\n\r\n  function applyStyle(val, imageStyles, multipleStyles) {\r\n    if (typeof imageStyles == 'undefined') imageStyles = editor.opts.imageStyles\r\n\r\n    if (typeof multipleStyles == 'undefined') multipleStyles = editor.opts.imageMultipleStyles\r\n\r\n    if (!$current_image) return false\r\n\r\n    const $img = getEl()\r\n\r\n    // Remove multiple styles.\r\n    if (!multipleStyles) {\r\n      const styles = Object.keys(imageStyles)\r\n      styles.splice(styles.indexOf(val), 1)\r\n      $img.removeClass(styles.join(' '))\r\n    }\r\n\r\n    if (typeof imageStyles[val] == 'object') {\r\n      $img.removeAttr('style')\r\n      $img.css(imageStyles[val].style)\r\n    }\r\n    else {\r\n      $img.toggleClass(val)\r\n    }\r\n\r\n    _editImg($current_image)\r\n  }\r\n\r\n  function hasCaption() {\r\n    if ($current_image) {\r\n      return $current_image.parents('.fr-img-caption').length > 0\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  function refreshEmbedButton($btn) {\r\n    const $popup = editor.popups.get('filesManager.insert')\r\n    if ($popup && $popup.find('.fr-files-embed-layer').hasClass('fr-active')) {\r\n      $btn.addClass('fr-active').attr('aria-pressed', true)\r\n    }\r\n  }\r\n\r\n  function toggleCaption() {\r\n    let $el\r\n\r\n    if ($current_image && !hasCaption()) {\r\n      $el = $current_image\r\n\r\n      // Check if there is a link wrapping the image.\r\n      if ($current_image.parent().is('a')) {\r\n        $el = $current_image.parent()\r\n      }\r\n\r\n      // code start https://github.com/froala-labs/froala-editor-js-2/issues/1864\r\n\r\n      // check the li placement\r\n      var $listParent = $current_image.parents('ul') && $current_image.parents('ul').length > 0 ? $current_image.parents('ul') : $current_image.parents('ol') && $current_image.parents('ol').length > 0 ? $current_image.parents('ol') : [];\r\n      if ($listParent.length > 0) {\r\n        var totLi = $listParent.find('li').length,\r\n          $currLi = $current_image.parents('li'),\r\n          $newLi = document.createElement(\"li\");;\r\n        \r\n        if ((totLi - 1) === $currLi.index()) { // if li placement last then add one extra li\r\n          $listParent.append($newLi);\r\n          $newLi.innerHTML = '&nbsp;';\r\n        }\r\n      }\r\n\r\n      let splitAttrs\r\n      let oldWidth\r\n\r\n      if ($el.attr('style')) {\r\n        splitAttrs = $el.attr('style').split(':')\r\n        oldWidth = splitAttrs.indexOf('width') > -1 ? splitAttrs[splitAttrs.indexOf('width') + 1].replace(';', '') : ''\r\n      }\r\n\r\n      // Issue 2861\r\n      const current_width = editor.opts.imageResizeWithPercent ? (oldWidth.indexOf('px') > -1 ? null : oldWidth) || '100%' : $current_image.width() + 'px'\r\n  \r\n      // https://github.com/froala-labs/froala-editor-js-2/issues/1864\r\n      $el.wrap('<div class=\"fr-img-space-wrap\"><span ' + (!editor.browser.mozilla ? 'contenteditable=\"false\"' : '') + 'class=\"fr-img-caption ' + $current_image.attr('class') + '\" style=\"' + (!editor.opts.useClasses ? $el.attr('style') : '') + '\" draggable=\"false\"></span><p class=\"fr-img-space-wrap2\">&nbsp;</p></div>')\r\n      $el.wrap('<span class=\"fr-img-wrap\"></span>')\r\n      $current_image.after(`<span class=\"fr-inner\"${(!editor.browser.mozilla ? ' contenteditable=\"true\"' : '')}>${FE.START_MARKER}${editor.language.translate('Image Caption')}${FE.END_MARKER}</span>`)\r\n      $current_image.removeAttr('class').removeAttr('style').removeAttr('width')\r\n\r\n      $current_image.parents('.fr-img-caption').css('width', current_width);\r\n\r\n      _exitEdit(true)\r\n\r\n      editor.selection.restore()\r\n    }\r\n    else {\r\n      $el = getEl()\r\n      $current_image.insertAfter($el)\r\n      $current_image\r\n        .attr('class', $el.attr('class').replace('fr-img-caption', ''))\r\n        .attr('style', $el.attr('style'))\r\n      $el.remove()\r\n\r\n      _editImg($current_image)\r\n    }\r\n  }\r\n\r\n  return {\r\n    _init: _init,\r\n    showInsertPopup: showInsertPopup,\r\n    showLayer: showLayer,\r\n    refreshUploadButton: refreshUploadButton,\r\n    refreshByURLButton: refreshByURLButton,\r\n    upload: upload,\r\n    insertByURL: insertByURL,\r\n    insertAllFiles: insertAllFiles,\r\n    deleteAllFiles: deleteAllFiles,\r\n    get: get,\r\n    getEl: getEl,\r\n    insert: insert,\r\n    showProgressBar: showProgressBar,\r\n    remove: remove,\r\n    hideProgressBar: hideProgressBar,\r\n    applyStyle: applyStyle,\r\n    showAltPopup: showAltPopup,\r\n    showSizePopup: showSizePopup,\r\n    setAlt: setAlt,\r\n    setSize: setSize,\r\n    toggleCaption: toggleCaption,\r\n    refreshEmbedButton: refreshEmbedButton,\r\n    insertEmbed: insertEmbed,\r\n    hasCaption: hasCaption,\r\n    exitEdit: _exitEdit,\r\n    edit: _editImg,\r\n    cancelFileInsert: cancelFileInsert,\r\n    minimizePopup: minimizePopup,\r\n    editImage: editImage,\r\n    saveImage: saveImage,\r\n    _showErrorMessage: _showErrorMessage,\r\n    _showFileErrorMessage: _showFileErrorMessage,\r\n    getFileThumbnail: getFileThumbnail,\r\n    deleteFile:deleteFile,\r\n    checkAutoplay:checkAutoplay,\r\n    checkInsertAllState:checkInsertAllState,\r\n    _disableInsertCheckbox:_disableInsertCheckbox,\r\n    _getFileType: _getFileType,\r\n    isChildWindowOpen: isChildWindowOpen,\r\n    setChildWindowState: setChildWindowState,\r\n    resetAllFilesCheckbox: resetAllFilesCheckbox\r\n  }\r\n}\r\n\r\n// Insert image button.\r\nFE.DefineIcon('insertFiles', {\r\n  NAME: 'image',\r\n  SVG_KEY: 'fileManager'\r\n})\r\nFE.RegisterShortcut(FE.KEYCODE.P, 'insertFiles', null, 'P')\r\nFE.RegisterCommand('insertFiles', {\r\n  title: 'Insert Files',\r\n  undo: false,\r\n  focus: true,\r\n  refreshAfterCallback: false,\r\n  popup: true,\r\n  callback: function () {\r\n    if (!this.popups.isVisible('filesManager.insert')) {\r\n      this.filesManager.showInsertPopup()\r\n    }\r\n    else {\r\n      if (this.$el.find('.fr-marker').length) {\r\n        this.events.disableBlur()\r\n        this.selection.restore()\r\n      }\r\n      this.popups.hide('filesManager.insert')\r\n    }\r\n  },\r\n  plugin: 'filesManager'\r\n})\r\n\r\n\r\nFE.DefineIcon('cloudIcon', {\r\n  NAME: 'cloudIcon',\r\n  SVG_KEY: 'uploadFiles'\r\n})\r\n\r\n// Image upload button inside the insert image popup.\r\nFE.DefineIcon('filesUpload', {\r\n  NAME: 'uploadFiles',\r\n  SVG_KEY: 'uploadFiles'\r\n})\r\nFE.RegisterCommand('filesUpload', {\r\n  title: 'Upload Files',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.filesManager.showLayer('files-upload')\r\n  },\r\n  refresh: function ($btn) {\r\n    this.filesManager.refreshUploadButton($btn)\r\n  }\r\n})\r\n\r\n// Image by URL button inside the insert image popup.\r\nFE.DefineIcon('filesByURL', {\r\n  NAME: 'link',\r\n  SVG_KEY: 'insertLink'\r\n})\r\nFE.RegisterCommand('filesByURL', {\r\n  title: 'By URL',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.filesManager.showLayer('files-by-url')\r\n  },\r\n  refresh: function ($btn) {\r\n    this.filesManager.refreshByURLButton($btn)\r\n  }\r\n})\r\n\r\n// image\r\n// Video embed button inside the insert video popup.\r\nFE.DefineIcon('filesEmbed', { NAME: 'code', SVG_KEY: 'codeView' })\r\nFE.RegisterCommand('filesEmbed', {\r\n  title: 'Embedded Code',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.filesManager.showLayer('files-embed')\r\n  },\r\n  refresh: function ($btn) {\r\n    this.filesManager.refreshEmbedButton($btn)\r\n  }\r\n})\r\n\r\nFE.DefineIcon('insertAll', { NAME: 'insertAll', SVG_KEY: 'fileInsert' })\r\nFE.RegisterCommand('insertAll', {\r\n  title: 'Insert',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  disabled: true,\r\n  callback: function () {\r\n    this.filesManager.insertAllFiles()\r\n  }\r\n})\r\n\r\nFE.DefineIcon('deleteAll', { NAME: 'remove', SVG_KEY: 'remove' })\r\nFE.RegisterCommand('deleteAll', {\r\n  title: 'Delete',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  disabled: true,\r\n  callback: function () {\r\n    this.filesManager.deleteAllFiles()\r\n  }\r\n})\r\n\r\nFE.DefineIcon('cancel', { NAME: 'cancel', SVG_KEY: 'cancel' })\r\nFE.RegisterCommand('cancel', {\r\n  title: 'Cancel',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.filesManager.cancelFileInsert() \r\n  },\r\n  refresh: function ($btn) {\r\n  }\r\n})\r\n\r\nFE.DefineIcon('minimize', { NAME: 'minimize', SVG_KEY: 'minimize' })\r\nFE.RegisterCommand('minimize', {\r\n  title: 'Minimize',\r\n  undo: false,\r\n  focus: false,\r\n  toggle: true,\r\n  callback: function () {\r\n    this.filesManager.minimizePopup(\"image.insert\", true);\r\n  },\r\n  refresh: function ($btn) {\r\n    this.filesManager.refreshEmbedButton($btn)\r\n  }\r\n})\r\n\r\n\r\n// Insert image button inside the insert by URL layer.\r\nFE.RegisterCommand('filesInsertByURL', {\r\n  title: 'Insert Image',\r\n  undo: true,\r\n  refreshAfterCallback: false,\r\n  callback: function () {\r\n    this.filesManager.insertByURL()\r\n  },\r\n  refresh: function ($btn) {\r\n      $btn.text(this.language.translate('Add'))\r\n  }\r\n})\r\n\r\n// Insert image button inside the insert by upload layer.\r\nFE.RegisterCommand('imageInsertByUpload', {\r\n  title: 'Insert',\r\n  undo: true,\r\n  refreshAfterCallback: false,\r\n  callback: function (cmd, val) {\r\n  },\r\n  refresh: function ($btn) {\r\n  }\r\n})\r\n\r\n// View image\r\nFE.RegisterCommand('viewImage', {\r\n  title: 'View Image',\r\n  undo: true,\r\n  refreshAfterCallback: false,\r\n  callback: function (cmd, val) {\r\n    \r\n  },\r\n  refresh: function ($btn) {\r\n  }\r\n})\r\n\r\n// Embed Insert\r\nFE.RegisterCommand('insertEmbed', {\t\r\n  undo: true,\r\n  focus: true,\r\n  callback: function () {\r\n    this.filesManager.insertEmbed()\r\n    this.popups.get('filesManager.insert').find('textarea')[0].value=''\r\n    this.popups.get('filesManager.insert').find('textarea').removeClass('fr-not-empty')\r\n  }\t\r\n})\r\n\r\nFE.RegisterCommand('filesDismissError', {\r\n  title: 'OK',\r\n  undo: false,\r\n  callback: function () {\t\r\n    this.filesManager.hideProgressBar(true)\t\r\n  }\t\r\n})\r\n"],"names":["Object","assign","FE","POPUP_TEMPLATES","DEFAULTS","filesInsertButtons","filesInsertButtons2","imageEditButtons","imageAltButtons","imageSizeButtons","imageUpload","filesManagerUploadURL","imageCORSProxy","imageUploadRemoteUrls","filesManagerUploadParam","filesManagerUploadParams","googleOptions","filesManagerUploadToS3","filesManagerUploadToAzure","filesManagerUploadMethod","filesManagerMaxSize","filesManagerAllowedTypes","imageResize","imageResizeWithPercent","imageRoundPercent","imageDefaultWidth","imageDefaultAlign","imageDefaultDisplay","imageSplitHTML","imageStyles","imageMove","imageMultipleStyles","imageTextNear","imagePaste","imagePasteProcess","imageMinWidth","imageOutputSize","imageDefaultMargin","imageAddNewLine","VIDEO_PROVIDERS","test_regex","url_regex","url_text","html","provider","VIDEO_EMBED_REGEX","IMAGE_EMBED_REGEX","PLUGINS","filesManager","editor","$","DEFAULT_FILE_UPLOAD_URL","$current_image","$current_image_index","current_index","$child_window_open","$image_resizer","$handler","$overlay","disableEdit","mousedown","file_list","Map","file_list_values","XMLHttpRequests","fileUploads","checked_files","failedUploadFiles","completedUploads","fileKeys","imageEditIndex","editImageValue","autoplayCheckbox","fileListIndex","requiredPlugins","BAD_LINK","MISSING_LINK","ERROR_DURING_UPLOAD","BAD_RESPONSE","MAX_SIZE_EXCEEDED","BAD_FILE_TYPE","NO_CORS_IE","CORRUPTED_IMAGE","ERROR_LINK","UPLOAD_CANCEL","unsupported_file_types","error_messages","_refreshInsertPopup","$popup","popups","get","$url_input","find","val","$embed_area","trigger","showInsertPopup","rerender","hasOwnProperty","isImage","forEach","errorMessage","index","deleteFile","checkRequiredPlugins","_initInsertPopup","_initPluginErrorPopup","$btn","$tb","hideProgressBar","hasClass","resetAllFilesCheckbox","refresh","setContainer","isVisible","button","getPosition","size","left","top","show","outerHeight","position","forSelection","setPopupDimensions","setFileListHeight","addClass","plugins","plugin","opts","pluginsEnabled","indexOf","addPlugins","push","loadPlugins","module_list","m_name","_init","_hideInsertPopup","_repositionResizer","_initImageResizer","$container","$wp","$sc","append","data","wrap_correction_top","scrollTop","css","offset","wrap_correction_left","scrollLeft","helpers","getPX","$el","is","getEl","hasCaption","iframePaddingTop","iframePaddingLeft","iframe","getBoundingClientRect","width","height","_getHandler","pos","_setWidth","parents","_handlerMousedown","e","core","sameInstance","preventDefault","stopPropagation","undo","canDo","saveStep","start_x","pageX","originalEvent","touches","type","oel","$oel","doc","ownerDocument","win","defaultView","parentWindow","editor_inside_iframe","location","parent","ex","frameElement","clientLeft","p_node","parentsUntil","blockTagsQuery","el","outerWidth","toFixed","hideAll","_unmarkExit","insertEmbed","code","length","test","_showErrorMessage","language","translate","events","insertEmbeddedFile","_handlerMousemove","real_image_size","c_x","s_x","diff_x","Math","round","removeAttr","attr","match","_handlerMouseup","hide","removeClass","_disableInsertCheckbox","disabled","document","getElementById","parentElement","classList","add","remove","_disableFileIcons","_throwError","response","$img","edit","on","updateFileUploadingProgress","set","_showFileErrorMessage","message","_initEditPopup","delayed","$on","disableBlur","image_buttons","buildList","template","buttons","create","cancelFileInsert","file_manager_dialog_open","req","readyState","abort","cancelFileUpload","right","innerHTML","getFileActionButtons","updateProgressBar","deleteFileUpload","checkInsertAllState","$btnInsert","$btnDelete","isDisabled","addCheck","file","i","map","link","undefined","outerHTML","toolbarBottom","minimizePopup","checked","children","id","split","pop","filter","autoplay","showProgressBar","no_message","_setProgressMessage","dismiss","focus","run","dropRedo","_exitEdit","selection","setAfter","restore","progress","$layer","text","$message_header","$row","globalListClass","sortableLists","globalX","globalY","enableDragSort","listClass","getElementsByClassName","Array","prototype","call","list","enableDragItem","item","addEventListener","event","pageY","bottom","scrollBy","isMobile","sourceElement","target","contains","hoveredItem","elementFromPoint","targetTouches","clientX","clientY","elementsWithHoverClass","element","ondrag","handleDrag","ondragend","handleDrop","selectedItem","selectedLocX","selectedLocY","x","y","droppedItem","browser","safari","mozilla","swapItem","swapNodes","n1","n2","p1","parentNode","p2","i1","i2","isEqualNode","insertBefore","showFileUploadProgressLayer","description","getFileDescription","Date","checkedClass","checkmark","upload_progress_layer","text_truncate","name","getFileSize","setAttribute","getFileThumbnail","str","ending","substring","getFileThumbnailSrc","icon","getFileIcon","update","thumbnail","_getFileType","localName","thumbnailLink","thumbnailImage","reader","FileReader","oldImage","onloadend","src","result","binary","atob","array","charCodeAt","href","window","URL","createObjectURL","Blob","Uint8Array","readAsDataURL","path","fileActionButtons","isVideo","disableAutoplay","disableAutoplayCheckBox","isFormatSupported","pdf","txt","docx","xlsx","xls","log","disbleView","isAudio","isFile","API_KEY","CLIENT_ID","percent","loaded","row","progressCircle","floor","initialFileUploadStatus","isNaN","totalUploadPercent","value","style","validURL","pattern","RegExp","insertByURL","$input","urls","trim","$urls","j","files","files_index","initial_index","validUrls","url","addFilesToList","file_url","video","getVideoByURL","obj","xhr","XMLHttpRequest","onload","status","getUrlFileName","sanitize","existing_image","onerror","file_index","open","responseType","send","blur","upload","isURL","vp","videoAllowedProviders","join","replace","_editImg","_edit","viewImage","msie","navigator","msSaveBlob","createElement","download","click","viewImages","imageView","image","videoIframe","autoplayURL","endsWith","_loadedCallback","next","tagName","insertFiles","videos","_syncVideos","c_videos","slice","querySelectorAll","video_srcs","getAttribute","toggleClass","videoMove","removeAttribute","_syncFiles","c_files","file_srcs","insertAllFiles","insertMapElements","parseInt","toArray","deleteAllFiles","deleteMapElements","fileIndex","has","_editVideo","toolbar","disable","shift","insert","isChildWindowOpen","setChildWindowState","childWindowState","docEditor","loadScripts","callback","loader","handler","script","handleClientLoad","onreadystatechange","head","getElementsByTagName","body","appendChild","editImage","isChildWindowTriggered","trimVideoPlugin","trimVideo","o_doc","imageTUI","launch","options","apiKey","clientId","authorizeButton","signoutButton","userArea","fileInput","fileContainer","loadingText","onInvalidFile","console","onError","error","googleDocEditor","DISCOVERY_DOCS","SCOPES","DEFAULT_FIELDS","BOUNDARY","DELIMITER","CLOSE_DELIMITER","responseFileId","initClient","gapi","client","init","discoveryDocs","scope","then","auth2","getAuthInstance","isSignedIn","listen","updateSigninStatus","handleAuthClick","display","auth","getToken","access_token","Promise","resolve","signIn","handleFileUpload","handleSignoutClick","accessToken","currentFile","lastModified","lastModifiedDate","closeEditDocContainer","disableOnEdit","saveSingleFile","showEditableDoc","googleDocUrl","editDocContainer","cssText","onclick","signOut","container","removeChild","enableAfterEdit","readAsArrayBuffer","contentType","metadata","bytes","len","byteLength","String","fromCharCode","base64Data","btoa","multipartRequestBody","JSON","stringify","request","Length","execute","resp","load","saveImage","fileTypeMap","re","ext","exec","fileType","fileUseSelectedText","$file","clear","$existing_img","off","sanitizeURL","Image","old_src","clone","removeData","replaceWith","atts","attributes","att","nodeName","_addImage","video_autoplay","appendSymbol","videoSplitHTML","$video","videoResponsive","_setVideoStyle","videoDefaultDisplay","videoDefaultAlign","$existing_video","_add","replaced","_addVideo","_display","_align","htmlUntouched","useClasses","textAlign","embedded_code","fileSplitHTML","_setStyleVideo","_setStyleImage","loadCallback","data_str","videoDefaultWidth","markers","wrap","$marker","node","isLastSibling","insertAfter","typeVar","HAVE_FUTURE_DATA","isIOS","_parseResponse","parse","_parseXMLResponse","key","_fileUploaded","responseXML","responseText","responseURL","_imageUploaded","$image_placeholder","_fileUploadProgress","lengthComputable","complete","total","after","_fileUploadAborted","_browserUpload","getTime","form_data","drag_support","formdata","FormData","keyStart","params","fileURL","azureKey","uploadURL","region","bucket","encodeURI","account","SASToken","getXHR","uploadDate","toUTCString","accessKey","azureAccount","azureContainer","headerResource","urlResource","stringToSign","signatureBytes","cryptoJSPlugin","cryptoJS","HmacSHA256","enc","Base64","signature","toString","authHeader","setRequestHeader","_fileUploadError","onprogress","onabort","_bindInsertEvents","dataTransfer","types","dropEffect","edge","check_inputs","checkAutoplay","dt","inst","indexes","enableBlur","checkbox","webp","webm","ogg","ogv","isAndroid","chrome","_initEvents","_mousedown","not","first","areVisible","draggable","hasFocus","_mouseup","shiftKey","keys","isArrow","which","s_el","e_el","endElement","_markExit","syncIframe","getSelection","lastNode","nextSibling","isElement","enter","ENTER_BR","$parent","blockParent","defaultTag","onRefresh","onHide","active","imageInsertButtons","splice","buttonList","buttonList2","uploadIndex","urlIndex","embedIndex","upload_layer","toLowerCase","embed_layer","by_url_layer","progress_bar_layer","progress_bar","file_buttons","fileInsertButtons","message_layer","getMissingPluginsText","missingPlugins","getMissingPlugins","charAt","toUpperCase","date","weekday","year","month","day","dateFormat","toLocaleDateString","err","sizes","pow","fileName","getDate","getMonth","getFullYear","_refreshAltPopup","showAltPopup","_initAltPopup","alt_layer","setAlt","alt","_refreshSizePopup","showSizePopup","_initSizePopup","size_layer","setSize","regex","showLayer","toolbarInline","accessibility","focusPopup","refreshUploadButton","refreshByURLButton","_resizeImage","initPageX","direction","step","shared","$img_overlay","o_win","_mousemove","prevKey","prevTimestamp","ctrlKey","userAgent","metaKey","keycode","timeStamp","KEYCODE","EQUALS","FF_EQUALS","altKey","HYPHEN","FF_HYPHEN","ENTER","before","setBefore","MARKERS","fillEmptyBlocks","_editorKeydownHandler","key_code","BACKSPACE","DELETE","ESC","ARROW_LEFT","ARROW_RIGHT","img","TAB","F10","isBrowserAction","_cleanOnGet","n_node","nodeType","Node","ELEMENT_NODE","imgs","touchScroll","TEXT_NODE","INVISIBLE_SPACE","$win","START_MARKER","END_MARKER","paste","saveCopiedText","setTimeout","isCollapsed","C","X","_clipboardPaste","_clipboardPasteCleanup","_uploadPastedImages","$node","_processPastedImage","loadEvents","splitSrc","upload_img","each","_img","crossOrigin","canvas","context","getContext","naturalHeight","naturalWidth","drawImage","imgExt","toDataURL","save","_clipboardImageLoaded","_processsClipboardPaste","clipboardData","items","getData","getAsFile","clipboard_html","INSTANCES","removeAllRanges","addRange","createRange","bulkRefresh","force_exit","_canExit","enable","img_exit_flag","verticalAlign","margin","marginBottom","marginTop","maxWidth","marginLeft","marginRight","applyStyle","multipleStyles","styles","refreshEmbedButton","toggleCaption","$listParent","totLi","$currLi","$newLi","splitAttrs","oldWidth","current_width","exitEdit","DefineIcon","NAME","SVG_KEY","RegisterShortcut","P","RegisterCommand","title","refreshAfterCallback","popup","toggle","cmd"],"mappings":"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"}