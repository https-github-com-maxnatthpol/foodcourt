/*!
 * froala_editor v3.2.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

{"version":3,"file":"print.js","sources":["../../../src/js/plugins/print.js"],"sourcesContent":["import FE from '../index.js'\r\n'use strict';\r\n\r\nObject.assign(FE.DEFAULTS, {\r\n  html2pdf: window.html2pdf\r\n})\r\n\r\n\r\nFE.PLUGINS.print = function (editor) {\r\n  function _prepare(callback) {\r\n    // Get editor content for printing.\r\n    const contents = editor.html.get()\r\n\r\n    // Get or create the iframe for printing.\r\n    let print_iframe = null\r\n\r\n    if (editor.shared.print_iframe) {\r\n      ({ print_iframe } = editor.shared );\r\n    }\r\n    else {\r\n      print_iframe = document.createElement('iframe')\r\n      print_iframe.name = 'fr-print'\r\n      print_iframe.style.position = 'fixed'\r\n      print_iframe.style.top = '0'\r\n      print_iframe.style.left = '-9999px'\r\n      print_iframe.style.height = '100%'\r\n      print_iframe.style.width = '0'\r\n      print_iframe.style.overflow = 'hidden'\r\n      print_iframe.style['z-index'] = '2147483647'\r\n      print_iframe.style.tabIndex = '-1'\r\n\r\n      // Remove editor on shared destroy.\r\n      editor.events.on('shared.destroy', function () {\r\n        print_iframe.remove()\r\n      })\r\n\r\n      editor.shared.print_iframe = print_iframe\r\n    }\r\n\r\n    try {\r\n      document.body.removeChild(print_iframe)\r\n    }\r\n    catch (ex) {\r\n\r\n    }\r\n    document.body.appendChild(print_iframe)\r\n\r\n    // Iframe ready.\r\n    const listener = () => {\r\n      callback()\r\n      print_iframe.removeEventListener('load', listener)\r\n    }\r\n    print_iframe.addEventListener('load', listener)\r\n\r\n    // Build printing document.\r\n    const { contentWindow : frame_doc } = print_iframe\r\n    frame_doc.document.open()\r\n    frame_doc.document.write('<!DOCTYPE html><html ' + (editor.opts.documentReady ? 'style=\"margin: 0; padding: 0;\"' : '') + '><head><title>' + document.title + '</title>')\r\n\r\n    // Add styles.\r\n    Array.prototype.forEach.call(document.querySelectorAll('style'), function (style_el) {\r\n      style_el = style_el.cloneNode(true)\r\n      frame_doc.document.write(style_el.outerHTML)\r\n    })\r\n\r\n    // Add css links.\r\n    const style_elements = document.querySelectorAll('link[rel=stylesheet]')\r\n\r\n    Array.prototype.forEach.call(style_elements, function (link_el) {\r\n      const new_link_el = document.createElement('link')\r\n      new_link_el.rel = link_el.rel\r\n      new_link_el.href = link_el.href\r\n      new_link_el.media = 'print'\r\n      new_link_el.type = 'text/css'\r\n      new_link_el.media = 'all'\r\n      frame_doc.document.write(new_link_el.outerHTML)\r\n    })\r\n\r\n    frame_doc.document.write('</head><body style=\"height:auto;text-align: ' + (editor.opts.direction == 'rtl' ? 'right' : 'left') + '; direction: ' + editor.opts.direction + '; ' + (editor.opts.documentReady ? ' padding: 2cm; width: 17cm; margin: 0;' : '') + '\"><div class=\"fr-view\">')\r\n\r\n    // Add editor contents.\r\n    frame_doc.document.write(contents)\r\n    frame_doc.document.write('</div></body></html>')\r\n    frame_doc.document.close()\r\n  }\r\n\r\n  function run() {\r\n    _prepare(function () {\r\n      setTimeout(function () {\r\n\r\n        // Focus iframe window.\r\n        editor.events.disableBlur()\r\n        window.frames['fr-print'].focus()\r\n\r\n        // Open printing window.\r\n        window.frames['fr-print'].print()\r\n\r\n        // Refocus editor's window.\r\n        editor.$win.get(0).focus()\r\n\r\n        // Focus editor.\r\n        editor.events.disableBlur()\r\n        editor.events.focus()\r\n      }, 0)\r\n    })\r\n  }\r\n\r\n  function toPDF() {\r\n    if (editor.opts.html2pdf) {\r\n      editor.$el.css('text-align', 'left')\r\n\r\n      editor.opts.html2pdf()\r\n        .set({\r\n          margin: [10, 20],\r\n          html2canvas: {\r\n            useCORS: true\r\n          }\r\n        })\r\n        .from(editor.el)\r\n        .save()\r\n\r\n      setTimeout(function () {\r\n        editor.$el.css('text-align', '')\r\n      }, 100)\r\n    }\r\n  }\r\n\r\n  return {\r\n    run: run,\r\n    toPDF: toPDF\r\n  }\r\n}\r\n\r\nFE.DefineIcon('print', { NAME: 'print', SVG_KEY: 'print' })\r\nFE.RegisterCommand('print', {\r\n  title: 'Print',\r\n  undo: false,\r\n  focus: false,\r\n  plugin: 'print',\r\n  callback: function () {\r\n    this.print.run()\r\n  }\r\n})\r\n\r\nFE.DefineIcon('getPDF', {\r\n  NAME: 'file-pdf-o',\r\n  FA5NAME: 'file-pdf',\r\n  SVG_KEY: 'pdfExport'\r\n})\r\nFE.RegisterCommand('getPDF', {\r\n  title: 'Download PDF',\r\n  type: 'button',\r\n  focus: false,\r\n  undo: false,\r\n  callback: function () {\r\n    this.print.toPDF()\r\n  }\r\n})\r\n"],"names":["Object","assign","FE","DEFAULTS","html2pdf","window","PLUGINS","print","editor","_prepare","callback","contents","html","get","print_iframe","shared","document","createElement","name","style","position","top","left","height","width","overflow","tabIndex","events","on","remove","body","removeChild","ex","appendChild","listener","removeEventListener","addEventListener","frame_doc","contentWindow","open","write","opts","documentReady","title","Array","prototype","forEach","call","querySelectorAll","style_el","cloneNode","outerHTML","style_elements","link_el","new_link_el","rel","href","media","type","direction","close","run","setTimeout","disableBlur","frames","focus","$win","toPDF","$el","css","set","margin","html2canvas","useCORS","from","el","save","DefineIcon","NAME","SVG_KEY","RegisterCommand","undo","plugin","FA5NAME"],"mappings":"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"}