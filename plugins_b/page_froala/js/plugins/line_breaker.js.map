/*!
 * froala_editor v3.2.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

{"version":3,"file":"line_breaker.js","sources":["../../../src/js/plugins/line_breaker.js"],"sourcesContent":["import FE from '../index.js'\r\n'use strict';\r\n\r\nObject.assign(FE.DEFAULTS, {\r\n  lineBreakerTags: ['table', 'hr', 'form', 'dl', 'span.fr-video', '.fr-embedly', 'img'],\r\n  lineBreakerOffset: 15,\r\n  lineBreakerHorizontalOffset: 10\r\n}) \r\n\r\nFE.PLUGINS.lineBreaker = function (editor) {\r\n  const $ = editor.$\r\n  let $line_breaker \r\n  let mouseDownFlag \r\n  let mouseMoveTimer \r\n\r\n  /*\r\n   * Show line breaker.\r\n   * Compute top, left, width and show the line breaker.\r\n   * tag1 and tag2 are the tags between which the line breaker must be showed.\r\n   * If tag1 is null then tag2 is the first tag in the editor.\r\n   * If tag2 is null then tag1 is the last tag in the editor.\r\n   */\r\n  function _show($tag1, $tag2) {\r\n    // Line breaker's possition and width.\r\n    let breakerTop \r\n    let breakerLeft \r\n    let breakerWidth \r\n    let parent_tag \r\n    let parent_top \r\n    let parent_bottom \r\n    let tag_top \r\n    let tag_bottom \r\n\r\n    // Mouse is over the first tag in the editor. Show line breaker above tag2.\r\n    if ($tag1 == null) {\r\n      // Compute line breaker's possition and width.\r\n      parent_tag = $tag2.parent() \r\n      parent_top = parent_tag.offset().top \r\n      tag_top = $tag2.offset().top \r\n\r\n      breakerTop = tag_top - Math.min((tag_top - parent_top) / 2, editor.opts.lineBreakerOffset) \r\n      breakerWidth = parent_tag.outerWidth() \r\n      breakerLeft = parent_tag.offset().left \r\n    }\r\n\r\n    // Mouse is over the last tag in the editor. Show line breaker below tag1.\r\n    else if ($tag2 == null) {\r\n      // Compute line breaker's possition and width.\r\n      parent_tag = $tag1.parent() \r\n      parent_bottom = parent_tag.offset().top + parent_tag.outerHeight() \r\n      tag_bottom = $tag1.offset().top + $tag1.outerHeight() \r\n\r\n      if (parent_bottom < tag_bottom) {\r\n        parent_tag = $(parent_tag).parent() \r\n        parent_bottom = parent_tag.offset().top + parent_tag.outerHeight() \r\n      }\r\n\r\n      breakerTop = tag_bottom + Math.min(Math.abs(parent_bottom - tag_bottom) / 2, editor.opts.lineBreakerOffset) \r\n      breakerWidth = parent_tag.outerWidth() \r\n      breakerLeft = parent_tag.offset().left \r\n    }\r\n\r\n    // Mouse is between the 2 tags.\r\n    else {\r\n      // Compute line breaker's possition and width.\r\n      parent_tag = $tag1.parent() \r\n      const tag1_bottom = $tag1.offset().top + $tag1.height() \r\n      const tag2_top = $tag2.offset().top \r\n\r\n      // Tags may be on the same line, so there is no need for line breaker.\r\n      if (tag1_bottom > tag2_top) {\r\n        return false \r\n      }\r\n\r\n      breakerTop = (tag1_bottom + tag2_top) / 2 \r\n      breakerWidth = parent_tag.outerWidth() \r\n      breakerLeft = parent_tag.offset().left \r\n    }\r\n\r\n    if (editor.opts.iframe) {\r\n      const iframePaddingTop = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-top'))\r\n      const iframePaddingLeft = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-left'))\r\n      breakerLeft += editor.$iframe.offset().left - editor.helpers.scrollLeft() + iframePaddingLeft\r\n      breakerTop += editor.$iframe.offset().top - editor.helpers.scrollTop() + iframePaddingTop\r\n    }\r\n\r\n    editor.$box.append($line_breaker) \r\n\r\n    // Set line breaker's top, left and width.\r\n    $line_breaker.css('top', breakerTop - editor.win.pageYOffset) \r\n    $line_breaker.css('left', breakerLeft - editor.win.pageXOffset) \r\n    $line_breaker.css('width', breakerWidth) \r\n    $line_breaker.data('tag1', $tag1) \r\n    $line_breaker.data('tag2', $tag2) \r\n\r\n    // Show the line breaker.\r\n    $line_breaker.addClass('fr-visible').data('instance', editor) \r\n  }\r\n\r\n  /*\r\n   * Check tag siblings.\r\n   * The line breaker hould appear if there is no sibling or if the sibling is also in the line breaker tags list.\r\n   */\r\n  function _checkTagSiblings($tag, mouseY) {\r\n\r\n    // Tag's Y top and bottom coordinate.\r\n    const tag_top = $tag.offset().top \r\n    const tag_bottom = $tag.offset().top + $tag.outerHeight() \r\n    let $sibling \r\n    let tag \r\n\r\n    // Only if the mouse is close enough to the bottom or top edges.\r\n    if (Math.abs(tag_bottom - mouseY) <= editor.opts.lineBreakerOffset ||\r\n      Math.abs(mouseY - tag_top) <= editor.opts.lineBreakerOffset) {\r\n\r\n      // Mouse is near bottom check for next sibling.\r\n      if (Math.abs(tag_bottom - mouseY) < Math.abs(mouseY - tag_top)) {\r\n        tag = $tag.get(0) \r\n        let next_node = null \r\n        if(tag.nextSibling)  {\r\n\r\n          // check for visible element\r\n          next_node = tag.nextSibling.offsetParent ? tag.nextSibling : null\r\n        }\r\n\r\n        while (next_node && next_node.nodeType == Node.TEXT_NODE && next_node.textContent.length === 0) {\r\n          next_node = next_node.nextSibling \r\n        }\r\n\r\n        // Tag has next sibling.\r\n        if (next_node) {\r\n          $sibling = _checkTag(next_node) \r\n\r\n          // Sibling is in the line breaker tags list.\r\n          if ($sibling) {\r\n\r\n            // Show line breaker.\r\n            _show($tag, $sibling) \r\n\r\n            return true \r\n          }\r\n\r\n          // No next sibling.\r\n        }\r\n        else {\r\n\r\n          // Show line breaker\r\n          _show($tag, null) \r\n\r\n          return true \r\n        }\r\n      }\r\n\r\n      // Mouse is near top check for prev sibling.\r\n      else {\r\n        tag = $tag.get(0) \r\n\r\n        // No prev sibling.\r\n        if (!tag.previousSibling) {\r\n\r\n          // Show line breaker\r\n          _show(null, $tag) \r\n\r\n          return true \r\n\r\n          // Tag has prev sibling.\r\n        }\r\n        else {\r\n          $sibling = _checkTag(tag.previousSibling) \r\n\r\n          // Sibling is in the line breaker tags list.\r\n          if ($sibling) {\r\n\r\n            // Show line breaker.\r\n            _show($sibling, $tag) \r\n\r\n            return true \r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    $line_breaker.removeClass('fr-visible').removeData('instance') \r\n  }\r\n\r\n  /*\r\n   * Check if tag is in the line breaker list and in the editor as well.\r\n   * Returns the tag from the line breaker list or false if the tag is not in the list.\r\n   */\r\n  function _checkTag(tag) {\r\n    if (tag) {\r\n      const $tag = $(tag) \r\n\r\n      // Make sure tag is inside the editor.\r\n      if (editor.$el.find($tag).length === 0) return null \r\n\r\n      // Tag is in the line breaker tags list.\r\n      if (tag.nodeType != Node.TEXT_NODE && $tag.is(editor.opts.lineBreakerTags.join(','))) {\r\n\r\n        return $tag \r\n      }\r\n\r\n      // Tag's parent is in the line breaker tags list.\r\n      else if ($tag.parents(editor.opts.lineBreakerTags.join(',')).length > 0) {\r\n        tag = $tag.parents(editor.opts.lineBreakerTags.join(',')).get(0) \r\n\r\n        if (editor.$el.find($(tag)).length === 0 || !$(tag).is(editor.opts.lineBreakerTags.join(','))) return null \r\n\r\n        return $(tag) \r\n      }\r\n    }\r\n\r\n    return null \r\n  }\r\n\r\n  function _isInWp(tag) {\r\n    if (typeof tag.inFroalaWrapper != 'undefined') return tag.inFroalaWrapper \r\n    const o_tag = tag \r\n\r\n    while (tag.parentNode && tag.parentNode !== editor.$wp.get(0)) {\r\n      tag = tag.parentNode \r\n    }\r\n\r\n    o_tag.inFroalaWrapper = (tag.parentNode == editor.$wp.get(0)) \r\n\r\n    return o_tag.inFroalaWrapper \r\n  }\r\n\r\n  /*\r\n   * Look for tag at the specified coordinates.\r\n   */\r\n  function _tagAt(x, y) {\r\n    const tag = editor.doc.elementFromPoint(x, y) \r\n\r\n    // We found a tag.\r\n    if (tag && !$(tag).closest('.fr-line-breaker').length && !editor.node.isElement(tag) && tag != editor.$wp.get(0) && _isInWp(tag)) {\r\n      return tag \r\n    }\r\n\r\n    // No tag at x, y.\r\n    return null \r\n  }\r\n\r\n  /*\r\n   * Look for tags above and bellow the specificed point.\r\n   */\r\n  function _searchTagVertically(x, y, step) {\r\n    let i = step \r\n    let tag = null \r\n\r\n    // Look up and down until a tag is found or the line breaker offset is reached.\r\n    while (i <= editor.opts.lineBreakerOffset && !tag) {\r\n\r\n      // Look for tag above.\r\n      tag = _tagAt(x, y - i) \r\n\r\n      if (!tag) {\r\n\r\n        // Look for tag below.\r\n        tag = _tagAt(x, y + i) \r\n      }\r\n\r\n      i += step \r\n    }\r\n\r\n    return tag \r\n  }\r\n\r\n  /*\r\n   * Look for tag left and right, up and down for each point.\r\n   */\r\n  function _searchTagHorizontally(x, y, direction) {\r\n    let tag = null \r\n\r\n    // Do not check left / right too much.\r\n    let limit = 100 \r\n\r\n    // Look left / right until a tag is found or the editor margins are reached.\r\n    while (!tag && x > editor.$box.offset().left && x < editor.$box.offset().left + editor.$box.outerWidth() && limit > 0) {\r\n      tag = _tagAt(x, y) \r\n\r\n      // There's not tag here, look up and down.\r\n      if (!tag) {\r\n\r\n        // Look 5px up and 5 down.\r\n        tag = _searchTagVertically(x, y, 5) \r\n      }\r\n\r\n      // Move left or right.\r\n      if (direction == 'left') x -= editor.opts.lineBreakerHorizontalOffset \r\n      else x += editor.opts.lineBreakerHorizontalOffset \r\n\r\n      limit -= editor.opts.lineBreakerHorizontalOffset \r\n    }\r\n\r\n    return tag \r\n  }\r\n\r\n  /*\r\n   * Get the tag under the mouse cursor.\r\n   */\r\n  function _tagUnder(e) {\r\n    mouseMoveTimer = null \r\n\r\n    // The tag for which the line breaker should be showed.\r\n    let $tag = null \r\n    let tag = null \r\n\r\n    // The tag under the mouse cursor.\r\n    const tag_under = editor.doc.elementFromPoint(e.pageX - editor.win.pageXOffset, e.pageY - editor.win.pageYOffset) \r\n\r\n    // Tag is the editor element. Look for closest tag above and bellow, left and right.\r\n    if (tag_under && (tag_under.tagName == 'HTML' || tag_under.tagName == 'BODY' || editor.node.isElement(tag_under) || (tag_under.getAttribute('class') || '').indexOf('fr-line-breaker') >= 0)) {\r\n\r\n      // Look 1px up and 1 down.\r\n      tag = _searchTagVertically(e.pageX - editor.win.pageXOffset, e.pageY - editor.win.pageYOffset, 1) \r\n\r\n      // Stil haven't found a tag, look left.\r\n      if (!tag) {\r\n        tag = _searchTagHorizontally(e.pageX - editor.win.pageXOffset - editor.opts.lineBreakerHorizontalOffset, e.pageY - editor.win.pageYOffset, 'left') \r\n      }\r\n\r\n      // Stil haven't found a tag, look right.\r\n      if (!tag) {\r\n        tag = _searchTagHorizontally(e.pageX - editor.win.pageXOffset + editor.opts.lineBreakerHorizontalOffset, e.pageY - editor.win.pageYOffset, 'right') \r\n      }\r\n\r\n      $tag = _checkTag(tag) \r\n\r\n      // Tag is not the editor element.\r\n    }\r\n    else {\r\n\r\n      // Check if the tag is in the line breaker list.\r\n      $tag = _checkTag(tag_under) \r\n    }\r\n\r\n    // Check tag siblings.\r\n    if ($tag) {\r\n      _checkTagSiblings($tag, e.pageY) \r\n    }\r\n    else if (editor.core.sameInstance($line_breaker)) {\r\n      $line_breaker.removeClass('fr-visible').removeData('instance') \r\n    }\r\n  }\r\n\r\n  /*\r\n   * Set mouse timer to improve performance.\r\n   */\r\n  function _mouseTimer(e) {\r\n    if ($line_breaker.hasClass('fr-visible') && !editor.core.sameInstance($line_breaker)) return false \r\n\r\n    if (editor.popups.areVisible() || editor.el.querySelector('.fr-selected-cell')) {\r\n      $line_breaker.removeClass('fr-visible') \r\n\r\n      return true \r\n    }\r\n\r\n    if (mouseDownFlag === false && !editor.edit.isDisabled()) {\r\n      if (mouseMoveTimer) {\r\n        clearTimeout(mouseMoveTimer) \r\n      }\r\n\r\n      mouseMoveTimer = setTimeout(_tagUnder, 30, e) \r\n    }\r\n  }\r\n\r\n  /*\r\n   * Hide line breaker and prevent timer from showing it again.\r\n   */\r\n  function _hide() {\r\n    if (mouseMoveTimer) {\r\n      clearTimeout(mouseMoveTimer) \r\n    }\r\n\r\n    if ($line_breaker && $line_breaker.hasClass('fr-visible')) {\r\n      $line_breaker.removeClass('fr-visible').removeData('instance') \r\n    }\r\n  }\r\n\r\n  /*\r\n   * Notify that mouse is down and prevent line breaker from showing.\r\n   * This may happen either for selection or for drag.\r\n   */\r\n  const _mouseDown = () => {\r\n    mouseDownFlag = true \r\n    _hide() \r\n  }\r\n\r\n  /*\r\n   * Notify that mouse is no longer pressed.\r\n   */\r\n  const _mouseUp = () => {\r\n    mouseDownFlag = false \r\n  }\r\n\r\n  /*\r\n   * Add new line between the tags.\r\n   */\r\n  function _doLineBreak(e) {\r\n    e.preventDefault() \r\n\r\n    const instance = $line_breaker.data('instance') || editor \r\n\r\n    // Hide the line breaker.\r\n    $line_breaker.removeClass('fr-visible').removeData('instance') \r\n\r\n    // Tags between which that line break needs to be done.\r\n    const $tag1 = $line_breaker.data('tag1') \r\n    const $tag2 = $line_breaker.data('tag2') \r\n\r\n    // P, DIV or none.\r\n    const default_tag = editor.html.defaultTag() \r\n\r\n    // The line break needs to be done before the first element in the editor.\r\n    if ($tag1 == null) {\r\n\r\n      // If the tag is in a TD tag then just add <br> no matter what the default_tag is.\r\n      if (default_tag && $tag2.parent().get(0).tagName != 'TD' && $tag2.parents(default_tag).length === 0) {\r\n        $tag2.before(`<${default_tag}>${FE.MARKERS}<br></${default_tag}>`)\r\n      }\r\n      else {\r\n        $tag2.before(`${FE.MARKERS}<br>`) \r\n      }\r\n\r\n      // The line break needs to be done either after the last element in the editor or between the 2 tags.\r\n      // Either way the line break is after the first tag.\r\n    }\r\n    else {\r\n\r\n      // If the tag is in a TD tag then just add <br> no matter what the default_tag is.\r\n      if (default_tag && $tag1.parent().get(0).tagName != 'TD' && $tag1.parents(default_tag).length === 0) {\r\n        $tag1.after(`<${default_tag}>${FE.MARKERS}<br></${default_tag}>`)\r\n      }\r\n      else {\r\n        $tag1.after(`${FE.MARKERS}<br>`) \r\n      }\r\n    }\r\n\r\n    // Cursor is now at the beginning of the new line.\r\n    instance.selection.restore()\r\n\r\n    // https://github.com/froala-labs/froala-editor-js-2/issues/1571\r\n    // enable toolbar if it is disabled because of contenteditable=false\r\n    editor.toolbar.enable();\r\n  }\r\n\r\n  /*\r\n   * Initialize the line breaker.\r\n   */\r\n  function _initLineBreaker() {\r\n\r\n    // Append line breaker HTML to editor wrapper.\r\n    if (!editor.shared.$line_breaker) {\r\n      editor.shared.$line_breaker = $(document.createElement('div')).attr('class', 'fr-line-breaker').html(`<a class=\"fr-floating-btn\" role=\"button\" tabIndex=\"-1\" title=\"${editor.language.translate('Break')}\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><rect x=\"17\" y=\"7\" width=\"2\" height=\"8\"/><rect x=\"10\" y=\"13\" width=\"7\" height=\"2\"/><path d=\"M10.000,10.000 L10.000,18.013 L5.000,14.031 L10.000,10.000 Z\"/></svg></a>`)\r\n    }\r\n\r\n    $line_breaker = editor.shared.$line_breaker \r\n\r\n    // Editor shared destroy.\r\n    editor.events.on('shared.destroy', function () {\r\n      $line_breaker.html('').removeData().remove() \r\n      $line_breaker = null \r\n    }, true) \r\n\r\n    // Editor destroy.\r\n    editor.events.on('destroy', function () {\r\n      $line_breaker.removeData('instance').removeClass('fr-visible')\r\n      $('body').first().append($line_breaker)\r\n      clearTimeout(mouseMoveTimer)\r\n    }, true)\r\n\r\n    editor.events.$on($line_breaker, 'mousemove', function (e) {\r\n      e.stopPropagation() \r\n    }, true)\r\n\r\n    // Add new line break.\r\n    editor.events.bindClick($line_breaker, 'a', _doLineBreak) \r\n  }\r\n\r\n  /*\r\n   * Tear up.\r\n   */\r\n  function _init() {\r\n    if (!editor.$wp) return false \r\n\r\n    _initLineBreaker() \r\n\r\n    // Remember if mouse is clicked so the line breaker does not appear.\r\n    mouseDownFlag = false \r\n\r\n    // Check tags under the mouse to see if the line breaker needs to be shown.\r\n    editor.events.$on(editor.$win, 'mousemove', _mouseTimer) \r\n\r\n    // Hide the line breaker if the page is scrolled.\r\n    editor.events.$on($(editor.win), 'scroll', _hide) \r\n\r\n    // Hide the line breaker on cell edit.\r\n    editor.events.on('popups.show.table.edit', _hide) \r\n\r\n    // Hide the line breaker after command is ran.\r\n    editor.events.on('commands.after', _hide) \r\n\r\n    // Prevent line breaker from showing while selecting text or dragging images.\r\n    editor.events.$on($(editor.win), 'mousedown', _mouseDown) \r\n\r\n    // Mouse is not pressed anymore, line breaker may be shown.\r\n    editor.events.$on($(editor.win), 'mouseup', _mouseUp) \r\n  }\r\n\r\n  return {\r\n    _init: _init\r\n  }\r\n} \r\n"],"names":["Object","assign","FE","DEFAULTS","lineBreakerTags","lineBreakerOffset","lineBreakerHorizontalOffset","PLUGINS","lineBreaker","editor","$","$line_breaker","mouseDownFlag","mouseMoveTimer","_show","$tag1","$tag2","breakerTop","breakerLeft","breakerWidth","parent_tag","parent_top","parent_bottom","tag_top","tag_bottom","parent","offset","top","Math","min","opts","outerWidth","left","outerHeight","abs","tag1_bottom","height","tag2_top","iframe","iframePaddingTop","helpers","getPX","$wp","find","css","iframePaddingLeft","$iframe","scrollLeft","scrollTop","$box","append","win","pageYOffset","pageXOffset","data","addClass","_checkTagSiblings","$tag","mouseY","$sibling","tag","get","next_node","nextSibling","offsetParent","nodeType","Node","TEXT_NODE","textContent","length","_checkTag","previousSibling","removeClass","removeData","$el","is","join","parents","_isInWp","inFroalaWrapper","o_tag","parentNode","_tagAt","x","y","doc","elementFromPoint","closest","node","isElement","_searchTagVertically","step","i","_searchTagHorizontally","direction","limit","_tagUnder","e","tag_under","pageX","pageY","tagName","getAttribute","indexOf","core","sameInstance","_mouseTimer","hasClass","popups","areVisible","el","querySelector","edit","isDisabled","clearTimeout","setTimeout","_hide","_mouseDown","_mouseUp","_doLineBreak","preventDefault","instance","default_tag","html","defaultTag","before","MARKERS","after","selection","restore","toolbar","enable","_initLineBreaker","shared","document","createElement","attr","language","translate","events","on","remove","first","$on","stopPropagation","bindClick","_init","$win"],"mappings":"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"}