/*!
 * froala_editor v3.2.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

{"version":3,"file":"quick_insert.js","sources":["../../../src/js/plugins/quick_insert.js"],"sourcesContent":["import FE from '../index.js'\r\n'use strict';\r\n\r\n// Extend defaults.\r\nObject.assign(FE.DEFAULTS, {\r\n  quickInsertButtons: ['image', 'video', 'embedly', 'table', 'ul', 'ol', 'hr'],\r\n  quickInsertTags: ['p', 'div', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'pre', 'blockquote'],\r\n  quickInsertEnabled: true\r\n})\r\n\r\nFE.QUICK_INSERT_BUTTONS = {}\r\n\r\nFE.DefineIcon('quickInsert', {\r\n  SVG_KEY: 'add',\r\n  template: 'svg'\r\n})\r\n\r\nFE.RegisterQuickInsertButton = function (name, data) {\r\n  FE.QUICK_INSERT_BUTTONS[name] = Object.assign({\r\n    undo: true\r\n  }, data)\r\n}\r\n\r\nFE.RegisterQuickInsertButton('image', {\r\n  icon: 'insertImage',\r\n  requiredPlugin: 'image',\r\n  title: 'Insert Image',\r\n  undo: false,\r\n  callback: function () {\r\n    const editor = this\r\n    const { $ } = editor\r\n\r\n    if (!editor.shared.$qi_image_input) {\r\n      editor.shared.$qi_image_input = $(document.createElement('input')).attr('accept', 'image/' + editor.opts.imageAllowedTypes.join(', image/').toLowerCase()).attr('name', `quickInsertImage${this.id}`).attr('style', 'display: none;').attr('type', 'file')\r\n\r\n      $('body').first().append(editor.shared.$qi_image_input)\r\n\r\n      editor.events.$on(editor.shared.$qi_image_input, 'change', function () {\r\n        const inst = $(this).data('inst')\r\n\r\n        if (this.files) {\r\n          inst.quickInsert.hide()\r\n          inst.image.upload(this.files)\r\n        }\r\n\r\n        // Chrome fix.\r\n        $(this).val('')\r\n      }, true)\r\n    }\r\n\r\n    editor.$qi_image_input = editor.shared.$qi_image_input\r\n\r\n    if (editor.helpers.isMobile()) editor.selection.save()\r\n    editor.events.disableBlur()\r\n    editor.$qi_image_input.data('inst', editor)[0].click()\r\n  }\r\n})\r\n\r\nFE.RegisterQuickInsertButton('video', {\r\n  icon: 'insertVideo',\r\n  requiredPlugin: 'video',\r\n  title: 'Insert Video',\r\n  undo: false,\r\n  callback: function () {\r\n    const res = prompt(this.language.translate('Paste the URL of the video you want to insert.'))\r\n\r\n    if (res) {\r\n      this.video.insertByURL(res)\r\n    }\r\n  }\r\n})\r\n\r\nFE.RegisterQuickInsertButton('embedly', {\r\n  icon: 'embedly',\r\n  requiredPlugin: 'embedly',\r\n  title: 'Embed URL',\r\n  undo: false,\r\n  callback: function () {\r\n    const res = prompt(this.language.translate('Paste the URL of any web content you want to insert.'))\r\n\r\n    if (res) {\r\n      this.embedly.add(res)\r\n    }\r\n  }\r\n})\r\n\r\nFE.RegisterQuickInsertButton('table', {\r\n  icon: 'insertTable',\r\n  requiredPlugin: 'table',\r\n  title: 'Insert Table',\r\n  callback: function () {\r\n    this.table.insert(2, 2)\r\n  }\r\n})\r\n\r\nFE.RegisterQuickInsertButton('ol', {\r\n  icon: 'formatOL',\r\n  requiredPlugin: 'lists',\r\n  title: 'Ordered List',\r\n  callback: function () {\r\n    this.lists.format('OL')\r\n  }\r\n})\r\n\r\nFE.RegisterQuickInsertButton('ul', {\r\n  icon: 'formatUL',\r\n  requiredPlugin: 'lists',\r\n  title: 'Unordered List',\r\n  callback: function () {\r\n    this.lists.format('UL')\r\n  }\r\n})\r\n\r\nFE.RegisterQuickInsertButton('hr', {\r\n  icon: 'insertHR',\r\n  title: 'Insert Horizontal Line',\r\n  callback: function () {\r\n    this.commands.insertHR()\r\n  }\r\n})\r\n\r\nFE.PLUGINS.quickInsert = function (editor) {\r\n\r\n  const { $ } = editor\r\n\r\n  let $quick_insert\r\n\r\n  /*\r\n   * Set the quick insert button left and top.\r\n   */\r\n  function _place($tag) {\r\n\r\n    // Quick insert's possition.\r\n    let qiTop\r\n    let qiLeft\r\n    let qiTagAlign\r\n\r\n    qiTop = $tag.offset().top - editor.$box.offset().top\r\n\r\n    if ((((editor.$iframe && editor.$iframe.offset().left) || 0) + $tag.offset().left - $tag.position().left - 4) < $quick_insert.outerWidth()) {\r\n      qiLeft = $tag.offset().left + $quick_insert.outerWidth();\r\n    }\r\n    else {\r\n      qiLeft = 0 - $quick_insert.outerWidth();\r\n    }\r\n\r\n    if (editor.opts.enter != FE.ENTER_BR) {\r\n      qiTagAlign = ($quick_insert.outerHeight() - $tag.outerHeight()) / 2\r\n    }\r\n\r\n    // Enter key is BR. Insert an empty SPAN to get line height.\r\n    else {\r\n      const $span = $(document.createElement('span')).html(FE.INVISIBLE_SPACE)\r\n      $span.insertAfter($tag)\r\n      qiTagAlign = ($quick_insert.outerHeight() - $tag.next().outerHeight()) / 2\r\n      $tag.next().remove()\r\n    }\r\n\r\n    if (editor.opts.iframe) {\r\n      const iframePaddingTop = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-top'))\r\n      qiTop += editor.$iframe.offset().top + iframePaddingTop\r\n    }\r\n\r\n    // Reposition QI helper if visible.\r\n    if ($quick_insert.hasClass('fr-on')) {\r\n      if (qiTop >= 0) {\r\n        $helper.css('top', qiTop - qiTagAlign)\r\n      }\r\n    }\r\n\r\n    // Set quick insert's top and left.\r\n    if (qiTop >= 0 && qiTop - Math.abs(qiTagAlign) <= editor.$box.outerHeight() - $tag.outerHeight()) {\r\n      if ($quick_insert.hasClass('fr-hidden')) {\r\n        if ($quick_insert.hasClass('fr-on')) _showQIHelper()\r\n        $quick_insert.removeClass('fr-hidden')\r\n      }\r\n      else if ($quick_insert.hasClass('fr-visible')) {\r\n        $quick_insert.addClass('fr-hidden')\r\n        _hideHelper()\r\n      }\r\n\r\n      $quick_insert.css('top', qiTop - qiTagAlign)\r\n    }\r\n    else {\r\n      $quick_insert.css('top',  qiTagAlign)\r\n      \r\n    }\r\n   \r\n    $quick_insert.css('left', qiLeft)\r\n  }\r\n\r\n  /*\r\n   * Show quick insert.\r\n   * Compute top, left, width and show the quick insert.\r\n   */\r\n  function _show($tag) {\r\n    if (!$quick_insert) _initquickInsert()\r\n\r\n    // Hide the quick insert helper if visible.\r\n    if ($quick_insert.hasClass('fr-on')) {\r\n      _hideHelper()\r\n    }\r\n\r\n    editor.$box.append($quick_insert)\r\n\r\n    // Quick insert's possition.\r\n    _place($tag)\r\n\r\n    $quick_insert.data('tag', $tag)\r\n\r\n    // Show the quick insert.\r\n    $quick_insert.addClass('fr-visible')\r\n  }\r\n\r\n  /*\r\n   * Check the tag where the cursor is.\r\n   */\r\n  function _checkTag() {\r\n    // If editor has focus.\r\n    if (editor.core.hasFocus()) {\r\n      let tag = editor.selection.element()\r\n\r\n      // Get block tag if Enter key is not BR.\r\n      if (editor.opts.enter != FE.ENTER_BR && !editor.node.isBlock(tag)) {\r\n        tag = editor.node.blockParent(tag)\r\n      }\r\n\r\n      if (editor.opts.enter == FE.ENTER_BR && !editor.node.isBlock(tag)) {\r\n        const deep_tag = editor.node.deepestParent(tag)\r\n\r\n        if (deep_tag) tag = deep_tag\r\n      }\r\n\r\n      const _enterInBR = function () {\r\n        return (editor.opts.enter != FE.ENTER_BR && editor.node.isEmpty(tag) && editor.opts.quickInsertTags.indexOf(tag.tagName.toLowerCase()) >= 0)\r\n      }\r\n\r\n      const _enterInP = function () {\r\n        return (\r\n          editor.opts.enter == FE.ENTER_BR &&\r\n          ((tag.tagName == 'BR' && (!tag.previousSibling || tag.previousSibling.tagName == 'BR' || editor.node.isBlock(tag.previousSibling))) ||\r\n            (editor.node.isEmpty(tag) && (!tag.previousSibling || tag.previousSibling.tagName == 'BR' || editor.node.isBlock(tag.previousSibling)) && (!tag.nextSibling || tag.nextSibling.tagName == 'BR' || editor.node.isBlock(tag.nextSibling))))\r\n        )\r\n      }\r\n\r\n      if (tag && (_enterInBR() || _enterInP())) {\r\n        // If the quick insert is not repositioned, just close the helper.\r\n        if ($quick_insert && $quick_insert.data('tag').is($(tag)) && $quick_insert.hasClass('fr-on')) {\r\n          _hideHelper()\r\n        }\r\n\r\n        // If selection is collapsed.\r\n        else if (editor.selection.isCollapsed()) {\r\n          _show($(tag))\r\n        }\r\n      }\r\n\r\n      // Quick insert should not be visible.\r\n      else {\r\n        hide()\r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Hide quick insert.\r\n   */\r\n  function hide() {\r\n    if ($quick_insert) {\r\n      // Hide the quick insert helper if visible.\r\n      if ($quick_insert.hasClass('fr-on')) {\r\n        _hideHelper()\r\n      }\r\n\r\n      // Hide the quick insert.\r\n      $quick_insert.removeClass('fr-visible fr-on')\r\n      $quick_insert.css('left', -9999).css('top', -9999)\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Show the quick insert helper.\r\n   */\r\n  let $helper\r\n\r\n  function _showQIHelper(e) {\r\n    if (e) e.preventDefault()\r\n\r\n    // Hide helper.\r\n    if ($quick_insert.hasClass('fr-on') && !$quick_insert.hasClass('fr-hidden')) {\r\n      _hideHelper()\r\n    }\r\n\r\n    else {\r\n      if (!editor.shared.$qi_helper) {\r\n        const { quickInsertButtons : btns } = editor.opts\r\n        let btns_html = '<div class=\"fr-qi-helper\">'\r\n        let idx = 0\r\n\r\n        for (let i = 0; i < btns.length; i++) {\r\n          const info = FE.QUICK_INSERT_BUTTONS[btns[i]]\r\n\r\n          if (info) {\r\n            if (!info.requiredPlugin || (FE.PLUGINS[info.requiredPlugin] && editor.opts.pluginsEnabled.indexOf(info.requiredPlugin) >= 0)) {\r\n              btns_html += `<a class=\"fr-btn fr-floating-btn\" role=\"button\" title=\"${editor.language.translate(info.title)}\" tabIndex=\"-1\" data-cmd=\"${btns[i]}\" style=\"transition-delay: ${(0.025 * (idx++))}s;\">${editor.icon.create(info.icon)}</a>`\r\n            }\r\n          }\r\n        }\r\n\r\n        btns_html += '</div>'\r\n        editor.shared.$qi_helper = $(btns_html)\r\n\r\n        // Quick insert helper tooltip.\r\n        editor.tooltip.bind(editor.shared.$qi_helper, 'a.fr-btn')\r\n\r\n        editor.events.$on(editor.shared.$qi_helper, 'mousedown', function (e) {\r\n          e.preventDefault()\r\n        }, true)\r\n      }\r\n\r\n      ({ $qi_helper : $helper } = editor.shared );\r\n      editor.$box.append($helper)\r\n\r\n      // Show the quick insert helper.\r\n      setTimeout(function () {\r\n        $helper.css('top', parseFloat($quick_insert.css('top')))\r\n        $helper.css('left', parseFloat($quick_insert.css('left')) + $quick_insert.outerWidth())\r\n        $helper.find('a').addClass('fr-size-1')\r\n        $quick_insert.addClass('fr-on')\r\n      }, 10)\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Hides the quick insert helper and places the cursor.\r\n   */\r\n  function _hideHelper() {\r\n    const $helper = editor.$box.find('.fr-qi-helper')\r\n    const transition_delay = 25 //transition delay on fade in was set 0.025s\r\n\r\n    if ($helper.length) {\r\n      //set transition effect for quick insert link items on hide starting from last child\r\n      let childItems = $helper.find('a'); //get all the buttons from quick insert menu\r\n      let index = 0;\r\n      //hide the quick insert buttons starting from lefmost button with increase in delay to the righmost button\r\n      for (; index < childItems.length; index++) (function(index) {\r\n        setTimeout(function() {\r\n          $helper.children().eq(childItems.length-1-index).removeClass('fr-size-1'); //removing class to hide the button\r\n        }, transition_delay*index); //set the increasing transition delay\r\n      })(index);\r\n\r\n      //remove on button and set back add button\r\n      setTimeout(function() {\r\n        $helper.css('left', -9999)\r\n        if ($quick_insert && !$quick_insert.hasClass('fr-hidden')) $quick_insert.removeClass('fr-on') //show Add button\r\n      }, transition_delay*index); //set the transition delay for Add button\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Initialize the quick insert.\r\n   */\r\n  function _initquickInsert() {\r\n    if (!editor.shared.$quick_insert) {\r\n      // Append quick insert HTML to editor wrapper.\r\n      editor.shared.$quick_insert = $(document.createElement('div')).attr('class', 'fr-quick-insert').html(`<a class=\"fr-floating-btn\" role=\"button\" tabIndex=\"-1\" title=\"${editor.language.translate('Quick Insert')}\">${editor.icon.create('quickInsert')}</a>`)//'<div class=\"fr-quick-insert\"><a class=\"fr-floating-btn\" role=\"button\" tabIndex=\"-1\" title=\"' + editor.language.translate('Quick Insert') + '\">' + editor.icon.create('quickInsert') + '</a></div>')\r\n    }\r\n\r\n    ({ $quick_insert } = editor.shared );\r\n\r\n    // Quick Insert tooltip.\r\n    editor.tooltip.bind(editor.$box, '.fr-quick-insert > a.fr-floating-btn')\r\n\r\n    // Editor destroy.\r\n    editor.events.on('destroy', function () {\r\n      $('body').first().append($quick_insert.removeClass('fr-on'))\r\n      if ($helper) {\r\n        _hideHelper()\r\n        $('body').first().append($helper.css('left', -9999).css('top', -9999))\r\n      }\r\n    }, true)\r\n\r\n    editor.events.on('shared.destroy', function () {\r\n      $quick_insert.html('').removeData().remove()\r\n      $quick_insert = null\r\n\r\n      if ($helper) {\r\n        $helper.html('').removeData().remove()\r\n        $helper = null\r\n      }\r\n    }, true)\r\n\r\n    // Hide before a command is executed.\r\n    editor.events.on('commands.before', hide)\r\n\r\n    // Check if the quick insert should be shown after a command has been executed.\r\n    editor.events.on('commands.after', function () {\r\n      if (!editor.popups.areVisible()) {\r\n        _checkTag()\r\n      }\r\n    })\r\n\r\n    // User clicks on the quick insert.\r\n    editor.events.bindClick(editor.$box, '.fr-quick-insert > a', _showQIHelper)\r\n\r\n    // User clicks on a button from the quick insert helper.\r\n    editor.events.bindClick(editor.$box, '.fr-qi-helper > a.fr-btn', function (e) {\r\n      const cmd = $(e.currentTarget).data('cmd')\r\n\r\n      // Trigger commands.before.\r\n      if (editor.events.trigger('quickInsert.commands.before', [cmd]) === false) {\r\n        return false\r\n      }\r\n\r\n      FE.QUICK_INSERT_BUTTONS[cmd].callback.apply(editor, [e.currentTarget])\r\n\r\n      if (FE.QUICK_INSERT_BUTTONS[cmd].undo) {\r\n        editor.undo.saveStep()\r\n      }\r\n\r\n      // Trigger commands.after.\r\n      editor.events.trigger('quickInsert.commands.after', [cmd])\r\n\r\n      editor.quickInsert.hide()\r\n    })\r\n\r\n    // Scroll in editor wrapper. Quick insert buttons should scroll along\r\n    editor.events.$on(editor.$wp, 'scroll', _repositionQIButton)\r\n\r\n    // Re-position the quick insert button when more toolbar is expanded completely\r\n    editor.events.$on(editor.$tb, 'transitionend', '.fr-more-toolbar', _repositionQIButton)\r\n  }\r\n\r\n  /**\r\n   * Reposition the quick insert button\r\n   */\r\n  function _repositionQIButton() {\r\n    if ($quick_insert.hasClass('fr-visible')) {\r\n      _place($quick_insert.data('tag'))\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Tear up.\r\n   */\r\n  function _init() {\r\n    if (!editor.$wp || !editor.opts.quickInsertEnabled) return false\r\n\r\n    // Hide the quick insert if user click on an image.\r\n    editor.popups.onShow('image.edit', hide)\r\n\r\n    // Check tag where cursor is to see if the quick insert needs to be shown.\r\n    editor.events.on('mouseup', _checkTag)\r\n\r\n    if (editor.helpers.isMobile()) {\r\n      editor.events.$on($(editor.o_doc), 'selectionchange', _checkTag)\r\n    }\r\n\r\n    // Hide the quick insert when editor loses focus.\r\n    editor.events.on('blur', hide)\r\n\r\n    // Check if the quick insert should be shown after a key was pressed.\r\n    editor.events.on('keyup', _checkTag)\r\n\r\n    // Hide quick insert on keydown.\r\n    editor.events.on('keydown', function () {\r\n      setTimeout(function () {\r\n        _checkTag()\r\n      }, 0)\r\n    })\r\n  }\r\n\r\n  return {\r\n    _init: _init,\r\n    hide: hide\r\n  }\r\n}\r\n"],"names":["Object","assign","FE","DEFAULTS","quickInsertButtons","quickInsertTags","quickInsertEnabled","QUICK_INSERT_BUTTONS","DefineIcon","SVG_KEY","template","RegisterQuickInsertButton","name","data","undo","icon","requiredPlugin","title","callback","editor","$","shared","$qi_image_input","document","createElement","attr","opts","imageAllowedTypes","join","toLowerCase","id","first","append","events","$on","inst","files","quickInsert","hide","image","upload","val","helpers","isMobile","selection","save","disableBlur","click","res","prompt","language","translate","video","insertByURL","embedly","add","table","insert","lists","format","commands","insertHR","PLUGINS","$quick_insert","_place","$tag","qiTop","qiLeft","qiTagAlign","offset","top","$box","$iframe","left","position","outerWidth","enter","ENTER_BR","outerHeight","$span","html","INVISIBLE_SPACE","insertAfter","next","remove","iframe","iframePaddingTop","getPX","$wp","find","css","hasClass","$helper","Math","abs","_showQIHelper","removeClass","addClass","_hideHelper","_show","_initquickInsert","_checkTag","core","hasFocus","tag","element","node","isBlock","blockParent","deep_tag","deepestParent","_enterInBR","isEmpty","indexOf","tagName","_enterInP","previousSibling","nextSibling","is","isCollapsed","e","preventDefault","$qi_helper","btns","btns_html","idx","i","length","info","pluginsEnabled","create","tooltip","bind","setTimeout","parseFloat","transition_delay","childItems","index","children","eq","on","removeData","popups","areVisible","bindClick","cmd","currentTarget","trigger","apply","saveStep","_repositionQIButton","$tb","_init","onShow","o_doc"],"mappings":";;;;;;;;EAIAA,MAAM,CAACC,MAAP,CAAcC,EAAE,CAACC,QAAjB,EAA2B;EACzBC,EAAAA,kBAAkB,EAAE,CAAC,OAAD,EAAU,OAAV,EAAmB,SAAnB,EAA8B,OAA9B,EAAuC,IAAvC,EAA6C,IAA7C,EAAmD,IAAnD,CADK;EAEzBC,EAAAA,eAAe,EAAE,CAAC,GAAD,EAAM,KAAN,EAAa,IAAb,EAAmB,IAAnB,EAAyB,IAAzB,EAA+B,IAA/B,EAAqC,IAArC,EAA2C,IAA3C,EAAiD,KAAjD,EAAwD,YAAxD,CAFQ;EAGzBC,EAAAA,kBAAkB,EAAE;EAHK,CAA3B;EAMAJ,EAAE,CAACK,oBAAH,GAA0B,EAA1B;EAEAL,EAAE,CAACM,UAAH,CAAc,aAAd,EAA6B;EAC3BC,EAAAA,OAAO,EAAE,KADkB;EAE3BC,EAAAA,QAAQ,EAAE;EAFiB,CAA7B;;EAKAR,EAAE,CAACS,yBAAH,GAA+B,UAAUC,IAAV,EAAgBC,IAAhB,EAAsB;EACnDX,EAAAA,EAAE,CAACK,oBAAH,CAAwBK,IAAxB,IAAgCZ,MAAM,CAACC,MAAP,CAAc;EAC5Ca,IAAAA,IAAI,EAAE;EADsC,GAAd,EAE7BD,IAF6B,CAAhC;EAGD,CAJD;;EAMAX,EAAE,CAACS,yBAAH,CAA6B,OAA7B,EAAsC;EACpCI,EAAAA,IAAI,EAAE,aAD8B;EAEpCC,EAAAA,cAAc,EAAE,OAFoB;EAGpCC,EAAAA,KAAK,EAAE,cAH6B;EAIpCH,EAAAA,IAAI,EAAE,KAJ8B;EAKpCI,EAAAA,QAAQ,EAAE,oBAAY;EACpB,QAAMC,MAAM,GAAG,IAAf;EADoB,QAEZC,CAFY,GAEND,MAFM,CAEZC,CAFY;;EAIpB,QAAI,CAACD,MAAM,CAACE,MAAP,CAAcC,eAAnB,EAAoC;EAClCH,MAAAA,MAAM,CAACE,MAAP,CAAcC,eAAd,GAAgCF,CAAC,CAACG,QAAQ,CAACC,aAAT,CAAuB,OAAvB,CAAD,CAAD,CAAmCC,IAAnC,CAAwC,QAAxC,EAAkD,WAAWN,MAAM,CAACO,IAAP,CAAYC,iBAAZ,CAA8BC,IAA9B,CAAmC,UAAnC,EAA+CC,WAA/C,EAA7D,EAA2HJ,IAA3H,CAAgI,MAAhI,4BAA2J,KAAKK,EAAhK,GAAsKL,IAAtK,CAA2K,OAA3K,EAAoL,gBAApL,EAAsMA,IAAtM,CAA2M,MAA3M,EAAmN,MAAnN,CAAhC;EAEAL,MAAAA,CAAC,CAAC,MAAD,CAAD,CAAUW,KAAV,GAAkBC,MAAlB,CAAyBb,MAAM,CAACE,MAAP,CAAcC,eAAvC;EAEAH,MAAAA,MAAM,CAACc,MAAP,CAAcC,GAAd,CAAkBf,MAAM,CAACE,MAAP,CAAcC,eAAhC,EAAiD,QAAjD,EAA2D,YAAY;EACrE,YAAMa,IAAI,GAAGf,CAAC,CAAC,IAAD,CAAD,CAAQP,IAAR,CAAa,MAAb,CAAb;;EAEA,YAAI,KAAKuB,KAAT,EAAgB;EACdD,UAAAA,IAAI,CAACE,WAAL,CAAiBC,IAAjB;EACAH,UAAAA,IAAI,CAACI,KAAL,CAAWC,MAAX,CAAkB,KAAKJ,KAAvB;EACD,SANoE;;;EASrEhB,QAAAA,CAAC,CAAC,IAAD,CAAD,CAAQqB,GAAR,CAAY,EAAZ;EACD,OAVD,EAUG,IAVH;EAWD;;EAEDtB,IAAAA,MAAM,CAACG,eAAP,GAAyBH,MAAM,CAACE,MAAP,CAAcC,eAAvC;EAEA,QAAIH,MAAM,CAACuB,OAAP,CAAeC,QAAf,EAAJ,EAA+BxB,MAAM,CAACyB,SAAP,CAAiBC,IAAjB;EAC/B1B,IAAAA,MAAM,CAACc,MAAP,CAAca,WAAd;EACA3B,IAAAA,MAAM,CAACG,eAAP,CAAuBT,IAAvB,CAA4B,MAA5B,EAAoCM,MAApC,EAA4C,CAA5C,EAA+C4B,KAA/C;EACD;EAhCmC,CAAtC;EAmCA7C,EAAE,CAACS,yBAAH,CAA6B,OAA7B,EAAsC;EACpCI,EAAAA,IAAI,EAAE,aAD8B;EAEpCC,EAAAA,cAAc,EAAE,OAFoB;EAGpCC,EAAAA,KAAK,EAAE,cAH6B;EAIpCH,EAAAA,IAAI,EAAE,KAJ8B;EAKpCI,EAAAA,QAAQ,EAAE,oBAAY;EACpB,QAAM8B,GAAG,GAAGC,MAAM,CAAC,KAAKC,QAAL,CAAcC,SAAd,CAAwB,gDAAxB,CAAD,CAAlB;;EAEA,QAAIH,GAAJ,EAAS;EACP,WAAKI,KAAL,CAAWC,WAAX,CAAuBL,GAAvB;EACD;EACF;EAXmC,CAAtC;EAcA9C,EAAE,CAACS,yBAAH,CAA6B,SAA7B,EAAwC;EACtCI,EAAAA,IAAI,EAAE,SADgC;EAEtCC,EAAAA,cAAc,EAAE,SAFsB;EAGtCC,EAAAA,KAAK,EAAE,WAH+B;EAItCH,EAAAA,IAAI,EAAE,KAJgC;EAKtCI,EAAAA,QAAQ,EAAE,oBAAY;EACpB,QAAM8B,GAAG,GAAGC,MAAM,CAAC,KAAKC,QAAL,CAAcC,SAAd,CAAwB,sDAAxB,CAAD,CAAlB;;EAEA,QAAIH,GAAJ,EAAS;EACP,WAAKM,OAAL,CAAaC,GAAb,CAAiBP,GAAjB;EACD;EACF;EAXqC,CAAxC;EAcA9C,EAAE,CAACS,yBAAH,CAA6B,OAA7B,EAAsC;EACpCI,EAAAA,IAAI,EAAE,aAD8B;EAEpCC,EAAAA,cAAc,EAAE,OAFoB;EAGpCC,EAAAA,KAAK,EAAE,cAH6B;EAIpCC,EAAAA,QAAQ,EAAE,oBAAY;EACpB,SAAKsC,KAAL,CAAWC,MAAX,CAAkB,CAAlB,EAAqB,CAArB;EACD;EANmC,CAAtC;EASAvD,EAAE,CAACS,yBAAH,CAA6B,IAA7B,EAAmC;EACjCI,EAAAA,IAAI,EAAE,UAD2B;EAEjCC,EAAAA,cAAc,EAAE,OAFiB;EAGjCC,EAAAA,KAAK,EAAE,cAH0B;EAIjCC,EAAAA,QAAQ,EAAE,oBAAY;EACpB,SAAKwC,KAAL,CAAWC,MAAX,CAAkB,IAAlB;EACD;EANgC,CAAnC;EASAzD,EAAE,CAACS,yBAAH,CAA6B,IAA7B,EAAmC;EACjCI,EAAAA,IAAI,EAAE,UAD2B;EAEjCC,EAAAA,cAAc,EAAE,OAFiB;EAGjCC,EAAAA,KAAK,EAAE,gBAH0B;EAIjCC,EAAAA,QAAQ,EAAE,oBAAY;EACpB,SAAKwC,KAAL,CAAWC,MAAX,CAAkB,IAAlB;EACD;EANgC,CAAnC;EASAzD,EAAE,CAACS,yBAAH,CAA6B,IAA7B,EAAmC;EACjCI,EAAAA,IAAI,EAAE,UAD2B;EAEjCE,EAAAA,KAAK,EAAE,wBAF0B;EAGjCC,EAAAA,QAAQ,EAAE,oBAAY;EACpB,SAAK0C,QAAL,CAAcC,QAAd;EACD;EALgC,CAAnC;;EAQA3D,EAAE,CAAC4D,OAAH,CAAWzB,WAAX,GAAyB,UAAUlB,MAAV,EAAkB;EAAA,MAEjCC,CAFiC,GAE3BD,MAF2B,CAEjCC,CAFiC;EAIzC,MAAI2C,aAAJ;EAEA;EACF;EACA;;EACE,WAASC,MAAT,CAAgBC,IAAhB,EAAsB;EAEpB;EACA,QAAIC,KAAJ;EACA,QAAIC,MAAJ;EACA,QAAIC,UAAJ;EAEAF,IAAAA,KAAK,GAAGD,IAAI,CAACI,MAAL,GAAcC,GAAd,GAAoBnD,MAAM,CAACoD,IAAP,CAAYF,MAAZ,GAAqBC,GAAjD;;EAEA,QAAK,CAAEnD,MAAM,CAACqD,OAAP,IAAkBrD,MAAM,CAACqD,OAAP,CAAeH,MAAf,GAAwBI,IAA3C,IAAoD,CAArD,IAA0DR,IAAI,CAACI,MAAL,GAAcI,IAAxE,GAA+ER,IAAI,CAACS,QAAL,GAAgBD,IAA/F,GAAsG,CAAvG,GAA4GV,aAAa,CAACY,UAAd,EAAhH,EAA4I;EAC1IR,MAAAA,MAAM,GAAGF,IAAI,CAACI,MAAL,GAAcI,IAAd,GAAqBV,aAAa,CAACY,UAAd,EAA9B;EACD,KAFD,MAGK;EACHR,MAAAA,MAAM,GAAG,IAAIJ,aAAa,CAACY,UAAd,EAAb;EACD;;EAED,QAAIxD,MAAM,CAACO,IAAP,CAAYkD,KAAZ,IAAqB1E,EAAE,CAAC2E,QAA5B,EAAsC;EACpCT,MAAAA,UAAU,GAAG,CAACL,aAAa,CAACe,WAAd,KAA8Bb,IAAI,CAACa,WAAL,EAA/B,IAAqD,CAAlE;EACD,KAFD;EAAA,SAKK;EACH,YAAMC,KAAK,GAAG3D,CAAC,CAACG,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAD,CAAD,CAAkCwD,IAAlC,CAAuC9E,EAAE,CAAC+E,eAA1C,CAAd;EACAF,QAAAA,KAAK,CAACG,WAAN,CAAkBjB,IAAlB;EACAG,QAAAA,UAAU,GAAG,CAACL,aAAa,CAACe,WAAd,KAA8Bb,IAAI,CAACkB,IAAL,GAAYL,WAAZ,EAA/B,IAA4D,CAAzE;EACAb,QAAAA,IAAI,CAACkB,IAAL,GAAYC,MAAZ;EACD;;EAED,QAAIjE,MAAM,CAACO,IAAP,CAAY2D,MAAhB,EAAwB;EACtB,UAAMC,gBAAgB,GAAGnE,MAAM,CAACuB,OAAP,CAAe6C,KAAf,CAAqBpE,MAAM,CAACqE,GAAP,CAAWC,IAAX,CAAgB,YAAhB,EAA8BC,GAA9B,CAAkC,aAAlC,CAArB,CAAzB;EACAxB,MAAAA,KAAK,IAAI/C,MAAM,CAACqD,OAAP,CAAeH,MAAf,GAAwBC,GAAxB,GAA8BgB,gBAAvC;EACD,KA/BmB;;;EAkCpB,QAAIvB,aAAa,CAAC4B,QAAd,CAAuB,OAAvB,CAAJ,EAAqC;EACnC,UAAIzB,KAAK,IAAI,CAAb,EAAgB;EACd0B,QAAAA,OAAO,CAACF,GAAR,CAAY,KAAZ,EAAmBxB,KAAK,GAAGE,UAA3B;EACD;EACF,KAtCmB;;;EAyCpB,QAAIF,KAAK,IAAI,CAAT,IAAcA,KAAK,GAAG2B,IAAI,CAACC,GAAL,CAAS1B,UAAT,CAAR,IAAgCjD,MAAM,CAACoD,IAAP,CAAYO,WAAZ,KAA4Bb,IAAI,CAACa,WAAL,EAA9E,EAAkG;EAChG,UAAIf,aAAa,CAAC4B,QAAd,CAAuB,WAAvB,CAAJ,EAAyC;EACvC,YAAI5B,aAAa,CAAC4B,QAAd,CAAuB,OAAvB,CAAJ,EAAqCI,aAAa;EAClDhC,QAAAA,aAAa,CAACiC,WAAd,CAA0B,WAA1B;EACD,OAHD,MAIK,IAAIjC,aAAa,CAAC4B,QAAd,CAAuB,YAAvB,CAAJ,EAA0C;EAC7C5B,QAAAA,aAAa,CAACkC,QAAd,CAAuB,WAAvB;;EACAC,QAAAA,WAAW;EACZ;;EAEDnC,MAAAA,aAAa,CAAC2B,GAAd,CAAkB,KAAlB,EAAyBxB,KAAK,GAAGE,UAAjC;EACD,KAXD,MAYK;EACHL,MAAAA,aAAa,CAAC2B,GAAd,CAAkB,KAAlB,EAA0BtB,UAA1B;EAED;;EAEDL,IAAAA,aAAa,CAAC2B,GAAd,CAAkB,MAAlB,EAA0BvB,MAA1B;EACD;EAED;EACF;EACA;EACA;;;EACE,WAASgC,KAAT,CAAelC,IAAf,EAAqB;EACnB,QAAI,CAACF,aAAL,EAAoBqC,gBAAgB,GADjB;;EAInB,QAAIrC,aAAa,CAAC4B,QAAd,CAAuB,OAAvB,CAAJ,EAAqC;EACnCO,MAAAA,WAAW;EACZ;;EAED/E,IAAAA,MAAM,CAACoD,IAAP,CAAYvC,MAAZ,CAAmB+B,aAAnB,EARmB;;EAWnBC,IAAAA,MAAM,CAACC,IAAD,CAAN;;EAEAF,IAAAA,aAAa,CAAClD,IAAd,CAAmB,KAAnB,EAA0BoD,IAA1B,EAbmB;;EAgBnBF,IAAAA,aAAa,CAACkC,QAAd,CAAuB,YAAvB;EACD;EAED;EACF;EACA;;;EACE,WAASI,SAAT,GAAqB;EACnB;EACA,QAAIlF,MAAM,CAACmF,IAAP,CAAYC,QAAZ,EAAJ,EAA4B;EAC1B,UAAIC,GAAG,GAAGrF,MAAM,CAACyB,SAAP,CAAiB6D,OAAjB,EAAV,CAD0B;;EAI1B,UAAItF,MAAM,CAACO,IAAP,CAAYkD,KAAZ,IAAqB1E,EAAE,CAAC2E,QAAxB,IAAoC,CAAC1D,MAAM,CAACuF,IAAP,CAAYC,OAAZ,CAAoBH,GAApB,CAAzC,EAAmE;EACjEA,QAAAA,GAAG,GAAGrF,MAAM,CAACuF,IAAP,CAAYE,WAAZ,CAAwBJ,GAAxB,CAAN;EACD;;EAED,UAAIrF,MAAM,CAACO,IAAP,CAAYkD,KAAZ,IAAqB1E,EAAE,CAAC2E,QAAxB,IAAoC,CAAC1D,MAAM,CAACuF,IAAP,CAAYC,OAAZ,CAAoBH,GAApB,CAAzC,EAAmE;EACjE,YAAMK,QAAQ,GAAG1F,MAAM,CAACuF,IAAP,CAAYI,aAAZ,CAA0BN,GAA1B,CAAjB;EAEA,YAAIK,QAAJ,EAAcL,GAAG,GAAGK,QAAN;EACf;;EAED,UAAME,UAAU,GAAG,SAAbA,UAAa,GAAY;EAC7B,eAAQ5F,MAAM,CAACO,IAAP,CAAYkD,KAAZ,IAAqB1E,EAAE,CAAC2E,QAAxB,IAAoC1D,MAAM,CAACuF,IAAP,CAAYM,OAAZ,CAAoBR,GAApB,CAApC,IAAgErF,MAAM,CAACO,IAAP,CAAYrB,eAAZ,CAA4B4G,OAA5B,CAAoCT,GAAG,CAACU,OAAJ,CAAYrF,WAAZ,EAApC,KAAkE,CAA1I;EACD,OAFD;;EAIA,UAAMsF,SAAS,GAAG,SAAZA,SAAY,GAAY;EAC5B,eACEhG,MAAM,CAACO,IAAP,CAAYkD,KAAZ,IAAqB1E,EAAE,CAAC2E,QAAxB,KACE2B,GAAG,CAACU,OAAJ,IAAe,IAAf,KAAwB,CAACV,GAAG,CAACY,eAAL,IAAwBZ,GAAG,CAACY,eAAJ,CAAoBF,OAApB,IAA+B,IAAvD,IAA+D/F,MAAM,CAACuF,IAAP,CAAYC,OAAZ,CAAoBH,GAAG,CAACY,eAAxB,CAAvF,CAAD,IACEjG,MAAM,CAACuF,IAAP,CAAYM,OAAZ,CAAoBR,GAApB,MAA6B,CAACA,GAAG,CAACY,eAAL,IAAwBZ,GAAG,CAACY,eAAJ,CAAoBF,OAApB,IAA+B,IAAvD,IAA+D/F,MAAM,CAACuF,IAAP,CAAYC,OAAZ,CAAoBH,GAAG,CAACY,eAAxB,CAA5F,MAA0I,CAACZ,GAAG,CAACa,WAAL,IAAoBb,GAAG,CAACa,WAAJ,CAAgBH,OAAhB,IAA2B,IAA/C,IAAuD/F,MAAM,CAACuF,IAAP,CAAYC,OAAZ,CAAoBH,GAAG,CAACa,WAAxB,CAAjM,CAFH,CADF;EAKD,OAND;;EAQA,UAAIb,GAAG,KAAKO,UAAU,MAAMI,SAAS,EAA9B,CAAP,EAA0C;EACxC;EACA,YAAIpD,aAAa,IAAIA,aAAa,CAAClD,IAAd,CAAmB,KAAnB,EAA0ByG,EAA1B,CAA6BlG,CAAC,CAACoF,GAAD,CAA9B,CAAjB,IAAyDzC,aAAa,CAAC4B,QAAd,CAAuB,OAAvB,CAA7D,EAA8F;EAC5FO,UAAAA,WAAW;EACZ,SAFD;EAAA,aAKK,IAAI/E,MAAM,CAACyB,SAAP,CAAiB2E,WAAjB,EAAJ,EAAoC;EACvCpB,YAAAA,KAAK,CAAC/E,CAAC,CAACoF,GAAD,CAAF,CAAL;EACD;EACF,OAVD;EAAA,WAaK;EACHlE,UAAAA,IAAI;EACL;EACF;EACF;EAED;EACF;EACA;;;EACE,WAASA,IAAT,GAAgB;EACd,QAAIyB,aAAJ,EAAmB;EACjB;EACA,UAAIA,aAAa,CAAC4B,QAAd,CAAuB,OAAvB,CAAJ,EAAqC;EACnCO,QAAAA,WAAW;EACZ,OAJgB;;;EAOjBnC,MAAAA,aAAa,CAACiC,WAAd,CAA0B,kBAA1B;EACAjC,MAAAA,aAAa,CAAC2B,GAAd,CAAkB,MAAlB,EAA0B,CAAC,IAA3B,EAAiCA,GAAjC,CAAqC,KAArC,EAA4C,CAAC,IAA7C;EACD;EACF;EAED;EACF;EACA;;;EACE,MAAIE,OAAJ;;EAEA,WAASG,aAAT,CAAuByB,CAAvB,EAA0B;EACxB,QAAIA,CAAJ,EAAOA,CAAC,CAACC,cAAF,GADiB;;EAIxB,QAAI1D,aAAa,CAAC4B,QAAd,CAAuB,OAAvB,KAAmC,CAAC5B,aAAa,CAAC4B,QAAd,CAAuB,WAAvB,CAAxC,EAA6E;EAC3EO,MAAAA,WAAW;EACZ,KAFD,MAIK;EACH,UAAI,CAAC/E,MAAM,CAACE,MAAP,CAAcqG,UAAnB,EAA+B;EAAA,YACAC,IADA,GACSxG,MAAM,CAACO,IADhB,CACrBtB,kBADqB;EAE7B,YAAIwH,SAAS,GAAG,4BAAhB;EACA,YAAIC,GAAG,GAAG,CAAV;;EAEA,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,IAAI,CAACI,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;EACpC,cAAME,IAAI,GAAG9H,EAAE,CAACK,oBAAH,CAAwBoH,IAAI,CAACG,CAAD,CAA5B,CAAb;;EAEA,cAAIE,IAAJ,EAAU;EACR,gBAAI,CAACA,IAAI,CAAChH,cAAN,IAAyBd,EAAE,CAAC4D,OAAH,CAAWkE,IAAI,CAAChH,cAAhB,KAAmCG,MAAM,CAACO,IAAP,CAAYuG,cAAZ,CAA2BhB,OAA3B,CAAmCe,IAAI,CAAChH,cAAxC,KAA2D,CAA3H,EAA+H;EAC7H4G,cAAAA,SAAS,0EAA8DzG,MAAM,CAAC+B,QAAP,CAAgBC,SAAhB,CAA0B6E,IAAI,CAAC/G,KAA/B,CAA9D,2CAAgI0G,IAAI,CAACG,CAAD,CAApI,0CAAsK,QAASD,GAAG,EAAlL,kBAA6L1G,MAAM,CAACJ,IAAP,CAAYmH,MAAZ,CAAmBF,IAAI,CAACjH,IAAxB,CAA7L,SAAT;EACD;EACF;EACF;;EAED6G,QAAAA,SAAS,IAAI,QAAb;EACAzG,QAAAA,MAAM,CAACE,MAAP,CAAcqG,UAAd,GAA2BtG,CAAC,CAACwG,SAAD,CAA5B,CAhB6B;;EAmB7BzG,QAAAA,MAAM,CAACgH,OAAP,CAAeC,IAAf,CAAoBjH,MAAM,CAACE,MAAP,CAAcqG,UAAlC,EAA8C,UAA9C;EAEAvG,QAAAA,MAAM,CAACc,MAAP,CAAcC,GAAd,CAAkBf,MAAM,CAACE,MAAP,CAAcqG,UAAhC,EAA4C,WAA5C,EAAyD,UAAUF,CAAV,EAAa;EACpEA,UAAAA,CAAC,CAACC,cAAF;EACD,SAFD,EAEG,IAFH;EAGD;;EAEe7B,MAAAA,OA3Bb,GA2ByBzE,MAAM,CAACE,MA3BhC,CA2BAqG,UA3BA;EA4BHvG,MAAAA,MAAM,CAACoD,IAAP,CAAYvC,MAAZ,CAAmB4D,OAAnB,EA5BG;;EA+BHyC,MAAAA,UAAU,CAAC,YAAY;EACrBzC,QAAAA,OAAO,CAACF,GAAR,CAAY,KAAZ,EAAmB4C,UAAU,CAACvE,aAAa,CAAC2B,GAAd,CAAkB,KAAlB,CAAD,CAA7B;EACAE,QAAAA,OAAO,CAACF,GAAR,CAAY,MAAZ,EAAoB4C,UAAU,CAACvE,aAAa,CAAC2B,GAAd,CAAkB,MAAlB,CAAD,CAAV,GAAwC3B,aAAa,CAACY,UAAd,EAA5D;EACAiB,QAAAA,OAAO,CAACH,IAAR,CAAa,GAAb,EAAkBQ,QAAlB,CAA2B,WAA3B;EACAlC,QAAAA,aAAa,CAACkC,QAAd,CAAuB,OAAvB;EACD,OALS,EAKP,EALO,CAAV;EAMD;EACF;EAED;EACF;EACA;;;EACE,WAASC,WAAT,GAAuB;EACrB,QAAMN,OAAO,GAAGzE,MAAM,CAACoD,IAAP,CAAYkB,IAAZ,CAAiB,eAAjB,CAAhB;EACA,QAAM8C,gBAAgB,GAAG,EAAzB,CAFqB;;EAIrB,QAAI3C,OAAO,CAACmC,MAAZ,EAAoB;EAAA;EAClB;EACA,YAAIS,UAAU,GAAG5C,OAAO,CAACH,IAAR,CAAa,GAAb,CAAjB,CAFkB;;EAGlB,YAAIgD,KAAK,GAAG,CAAZ,CAHkB;;EAKlB,eAAOA,KAAK,GAAGD,UAAU,CAACT,MAA1B,EAAkCU,KAAK,EAAvC;EAA2C,WAAC,UAASA,KAAT,EAAgB;EAC1DJ,YAAAA,UAAU,CAAC,YAAW;EACpBzC,cAAAA,OAAO,CAAC8C,QAAR,GAAmBC,EAAnB,CAAsBH,UAAU,CAACT,MAAX,GAAkB,CAAlB,GAAoBU,KAA1C,EAAiDzC,WAAjD,CAA6D,WAA7D,EADoB;EAErB,aAFS,EAEPuC,gBAAgB,GAACE,KAFV,CAAV,CAD0D;EAI3D,WAJ0C,EAIxCA,KAJwC;EAA3C,SALkB;;;EAYlBJ,QAAAA,UAAU,CAAC,YAAW;EACpBzC,UAAAA,OAAO,CAACF,GAAR,CAAY,MAAZ,EAAoB,CAAC,IAArB;EACA,cAAI3B,aAAa,IAAI,CAACA,aAAa,CAAC4B,QAAd,CAAuB,WAAvB,CAAtB,EAA2D5B,aAAa,CAACiC,WAAd,CAA0B,OAA1B,EAFvC;EAGrB,SAHS,EAGPuC,gBAAgB,GAACE,KAHV,CAAV,CAZkB;EAAA;EAgBnB;EACF;EAED;EACF;EACA;;;EACE,WAASrC,gBAAT,GAA4B;EAC1B,QAAI,CAACjF,MAAM,CAACE,MAAP,CAAc0C,aAAnB,EAAkC;EAChC;EACA5C,MAAAA,MAAM,CAACE,MAAP,CAAc0C,aAAd,GAA8B3C,CAAC,CAACG,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAD,CAAD,CAAiCC,IAAjC,CAAsC,OAAtC,EAA+C,iBAA/C,EAAkEuD,IAAlE,gFAAwI7D,MAAM,CAAC+B,QAAP,CAAgBC,SAAhB,CAA0B,cAA1B,CAAxI,gBAAsLhC,MAAM,CAACJ,IAAP,CAAYmH,MAAZ,CAAmB,aAAnB,CAAtL,UAA9B,CAFgC;EAGjC;;EAEEnE,IAAAA,aANuB,GAML5C,MAAM,CAACE,MANF,CAMvB0C,aANuB;EAQ1B;EACA5C,IAAAA,MAAM,CAACgH,OAAP,CAAeC,IAAf,CAAoBjH,MAAM,CAACoD,IAA3B,EAAiC,sCAAjC,EAT0B;;EAY1BpD,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,SAAjB,EAA4B,YAAY;EACtCxH,MAAAA,CAAC,CAAC,MAAD,CAAD,CAAUW,KAAV,GAAkBC,MAAlB,CAAyB+B,aAAa,CAACiC,WAAd,CAA0B,OAA1B,CAAzB;;EACA,UAAIJ,OAAJ,EAAa;EACXM,QAAAA,WAAW;;EACX9E,QAAAA,CAAC,CAAC,MAAD,CAAD,CAAUW,KAAV,GAAkBC,MAAlB,CAAyB4D,OAAO,CAACF,GAAR,CAAY,MAAZ,EAAoB,CAAC,IAArB,EAA2BA,GAA3B,CAA+B,KAA/B,EAAsC,CAAC,IAAvC,CAAzB;EACD;EACF,KAND,EAMG,IANH;EAQAvE,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,gBAAjB,EAAmC,YAAY;EAC7C7E,MAAAA,aAAa,CAACiB,IAAd,CAAmB,EAAnB,EAAuB6D,UAAvB,GAAoCzD,MAApC;EACArB,MAAAA,aAAa,GAAG,IAAhB;;EAEA,UAAI6B,OAAJ,EAAa;EACXA,QAAAA,OAAO,CAACZ,IAAR,CAAa,EAAb,EAAiB6D,UAAjB,GAA8BzD,MAA9B;EACAQ,QAAAA,OAAO,GAAG,IAAV;EACD;EACF,KARD,EAQG,IARH,EApB0B;;EA+B1BzE,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,iBAAjB,EAAoCtG,IAApC,EA/B0B;;EAkC1BnB,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,gBAAjB,EAAmC,YAAY;EAC7C,UAAI,CAACzH,MAAM,CAAC2H,MAAP,CAAcC,UAAd,EAAL,EAAiC;EAC/B1C,QAAAA,SAAS;EACV;EACF,KAJD,EAlC0B;;EAyC1BlF,IAAAA,MAAM,CAACc,MAAP,CAAc+G,SAAd,CAAwB7H,MAAM,CAACoD,IAA/B,EAAqC,sBAArC,EAA6DwB,aAA7D,EAzC0B;;EA4C1B5E,IAAAA,MAAM,CAACc,MAAP,CAAc+G,SAAd,CAAwB7H,MAAM,CAACoD,IAA/B,EAAqC,0BAArC,EAAiE,UAAUiD,CAAV,EAAa;EAC5E,UAAMyB,GAAG,GAAG7H,CAAC,CAACoG,CAAC,CAAC0B,aAAH,CAAD,CAAmBrI,IAAnB,CAAwB,KAAxB,CAAZ,CAD4E;;EAI5E,UAAIM,MAAM,CAACc,MAAP,CAAckH,OAAd,CAAsB,6BAAtB,EAAqD,CAACF,GAAD,CAArD,MAAgE,KAApE,EAA2E;EACzE,eAAO,KAAP;EACD;;EAED/I,MAAAA,EAAE,CAACK,oBAAH,CAAwB0I,GAAxB,EAA6B/H,QAA7B,CAAsCkI,KAAtC,CAA4CjI,MAA5C,EAAoD,CAACqG,CAAC,CAAC0B,aAAH,CAApD;;EAEA,UAAIhJ,EAAE,CAACK,oBAAH,CAAwB0I,GAAxB,EAA6BnI,IAAjC,EAAuC;EACrCK,QAAAA,MAAM,CAACL,IAAP,CAAYuI,QAAZ;EACD,OAZ2E;;;EAe5ElI,MAAAA,MAAM,CAACc,MAAP,CAAckH,OAAd,CAAsB,4BAAtB,EAAoD,CAACF,GAAD,CAApD;EAEA9H,MAAAA,MAAM,CAACkB,WAAP,CAAmBC,IAAnB;EACD,KAlBD,EA5C0B;;EAiE1BnB,IAAAA,MAAM,CAACc,MAAP,CAAcC,GAAd,CAAkBf,MAAM,CAACqE,GAAzB,EAA8B,QAA9B,EAAwC8D,mBAAxC,EAjE0B;;EAoE1BnI,IAAAA,MAAM,CAACc,MAAP,CAAcC,GAAd,CAAkBf,MAAM,CAACoI,GAAzB,EAA8B,eAA9B,EAA+C,kBAA/C,EAAmED,mBAAnE;EACD;EAED;EACF;EACA;;;EACE,WAASA,mBAAT,GAA+B;EAC7B,QAAIvF,aAAa,CAAC4B,QAAd,CAAuB,YAAvB,CAAJ,EAA0C;EACxC3B,MAAAA,MAAM,CAACD,aAAa,CAAClD,IAAd,CAAmB,KAAnB,CAAD,CAAN;EACD;EACF;EAED;EACF;EACA;;;EACE,WAAS2I,KAAT,GAAiB;EACf,QAAI,CAACrI,MAAM,CAACqE,GAAR,IAAe,CAACrE,MAAM,CAACO,IAAP,CAAYpB,kBAAhC,EAAoD,OAAO,KAAP,CADrC;;EAIfa,IAAAA,MAAM,CAAC2H,MAAP,CAAcW,MAAd,CAAqB,YAArB,EAAmCnH,IAAnC,EAJe;;EAOfnB,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,SAAjB,EAA4BvC,SAA5B;;EAEA,QAAIlF,MAAM,CAACuB,OAAP,CAAeC,QAAf,EAAJ,EAA+B;EAC7BxB,MAAAA,MAAM,CAACc,MAAP,CAAcC,GAAd,CAAkBd,CAAC,CAACD,MAAM,CAACuI,KAAR,CAAnB,EAAmC,iBAAnC,EAAsDrD,SAAtD;EACD,KAXc;;;EAcflF,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,MAAjB,EAAyBtG,IAAzB,EAde;;EAiBfnB,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,OAAjB,EAA0BvC,SAA1B,EAjBe;;EAoBflF,IAAAA,MAAM,CAACc,MAAP,CAAc2G,EAAd,CAAiB,SAAjB,EAA4B,YAAY;EACtCP,MAAAA,UAAU,CAAC,YAAY;EACrBhC,QAAAA,SAAS;EACV,OAFS,EAEP,CAFO,CAAV;EAGD,KAJD;EAKD;;EAED,SAAO;EACLmD,IAAAA,KAAK,EAAEA,KADF;EAELlH,IAAAA,IAAI,EAAEA;EAFD,GAAP;EAID,CAnWD;;;;"}