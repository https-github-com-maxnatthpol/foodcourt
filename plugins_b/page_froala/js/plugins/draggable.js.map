/*!
 * froala_editor v3.2.6 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2021 Froala Labs
 */

{"version":3,"file":"draggable.js","sources":["../../../src/js/plugins/draggable.js"],"sourcesContent":["import FE from '../index.js'\r\n'use strict';\r\n\r\n// Extend defaults.\r\nObject.assign(FE.DEFAULTS, {\r\n  dragInline: true\r\n})\r\n\r\nFE.PLUGINS.draggable = function(editor) {\r\n  const { $ } = editor\r\n  function _dragStart(e) {\r\n    if (e.originalEvent && e.originalEvent.target && e.originalEvent.target.nodeType === Node.TEXT_NODE) {\r\n\r\n      return true \r\n    }\r\n\r\n    // Image with link.\r\n    if (e.target && e.target.tagName === 'A' && e.target.childNodes.length === 1 && e.target.childNodes[0].tagName === 'IMG') {\r\n      e.target = e.target.childNodes[0] \r\n    }\r\n\r\n    if (!$(e.target).hasClass('fr-draggable')) {\r\n      e.preventDefault()\r\n\r\n      return false\r\n    }\r\n\r\n    // Save in undo step if we cannot do.\r\n    if (!editor.undo.canDo()) {\r\n      editor.undo.saveStep()\r\n    }\r\n\r\n    if (editor.opts.dragInline) {\r\n      editor.$el.attr('contenteditable', true)\r\n    }\r\n    else {\r\n      editor.$el.attr('contenteditable', false)\r\n    }\r\n\r\n    if (editor.opts.toolbarInline) editor.toolbar.hide()\r\n\r\n    $(e.target).addClass('fr-dragging')\r\n\r\n    if (!editor.browser.msie && !editor.browser.edge) {\r\n      editor.selection.clear()\r\n    }\r\n\r\n    e.originalEvent.dataTransfer.setData('text', 'Froala')\r\n  }\r\n\r\n  const _tagOK = (tag_under) => !(tag_under && (tag_under.tagName === 'HTML' || tag_under.tagName === 'BODY' || editor.node.isElement(tag_under)))\r\n\r\n  function _setHelperSize(top, left, width) {\r\n    if (editor.opts.iframe) {\r\n      const iframePaddingTop = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-top'))\r\n      const iframePaddingLeft = editor.helpers.getPX(editor.$wp.find('.fr-iframe').css('padding-left'))\r\n      top += editor.$iframe.offset().top + iframePaddingTop\r\n      left += editor.$iframe.offset().left + iframePaddingLeft\r\n    }\r\n\r\n    if ($draggable_helper.offset().top !== top) $draggable_helper.css('top', top)\r\n\r\n    if ($draggable_helper.offset().left !== left) $draggable_helper.css('left', left)\r\n\r\n    if ($draggable_helper.width() !== width) $draggable_helper.css('width', width)\r\n  }\r\n\r\n  function _positionHelper(e) {\r\n\r\n    // The tag under the mouse cursor.\r\n    let tag_under = editor.doc.elementFromPoint(e.originalEvent.pageX - editor.win.pageXOffset, e.originalEvent.pageY - editor.win.pageYOffset)\r\n\r\n    if (!_tagOK(tag_under)) {\r\n\r\n      // Look above for the closest tag.\r\n      let top_offset = 0\r\n      let top_tag = tag_under\r\n\r\n      while (!_tagOK(top_tag) && top_tag === tag_under && e.originalEvent.pageY - editor.win.pageYOffset - top_offset > 0) {\r\n        top_offset++ \r\n        top_tag = editor.doc.elementFromPoint(e.originalEvent.pageX - editor.win.pageXOffset, e.originalEvent.pageY - editor.win.pageYOffset - top_offset)\r\n      }\r\n\r\n      if (!_tagOK(top_tag) || ($draggable_helper && editor.$el.find(top_tag).length === 0 && top_tag !== $draggable_helper.get(0))) { top_tag = null  }\r\n\r\n      // Look below for the closest tag.\r\n      let bottom_offset = 0 \r\n      let bottom_tag = tag_under \r\n\r\n      while (!_tagOK(bottom_tag) && bottom_tag === tag_under && e.originalEvent.pageY - editor.win.pageYOffset + bottom_offset < $(editor.doc).height()) {\r\n        bottom_offset++ \r\n        bottom_tag = editor.doc.elementFromPoint(e.originalEvent.pageX - editor.win.pageXOffset, e.originalEvent.pageY - editor.win.pageYOffset + bottom_offset)\r\n      }\r\n\r\n      if (!_tagOK(bottom_tag) || ($draggable_helper && editor.$el.find(bottom_tag).length === 0 && bottom_tag !== $draggable_helper.get(0))) { bottom_tag = null }\r\n\r\n      if (bottom_tag === null && top_tag) tag_under = top_tag\r\n\r\n      else if (bottom_tag && top_tag === null) tag_under = bottom_tag\r\n\r\n      else if (bottom_tag && top_tag) {\r\n        tag_under = (top_offset < bottom_offset ? top_tag : bottom_tag)\r\n      }\r\n      else {\r\n        tag_under = null\r\n      }\r\n    }\r\n\r\n    // Stop if tag under is draggable helper.\r\n    if ($(tag_under).hasClass('fr-drag-helper')) return false\r\n\r\n    // Get block parent.\r\n    if (tag_under && !editor.node.isBlock(tag_under)) {\r\n      tag_under = editor.node.blockParent(tag_under)\r\n    }\r\n\r\n    // Normalize TABLE parent.\r\n    if (tag_under && ['TD', 'TH', 'TR', 'THEAD', 'TBODY'].indexOf(tag_under.tagName) >= 0) {\r\n      tag_under = $(tag_under).parents('table').get(0)\r\n    }\r\n\r\n    // Normalize LIST parent.\r\n    if (tag_under && ['LI'].indexOf(tag_under.tagName) >= 0) {\r\n      tag_under = $(tag_under).parents('UL, OL').get(0)\r\n    }\r\n\r\n    if (tag_under && !$(tag_under).hasClass('fr-drag-helper')) {\r\n\r\n      // Init helper.\r\n      if (!$draggable_helper) {\r\n        if (!FE.$draggable_helper) FE.$draggable_helper = $(document.createElement('div')).attr('class', 'fr-drag-helper')\r\n\r\n        $draggable_helper = FE.$draggable_helper\r\n\r\n        editor.events.on('shared.destroy', function () {\r\n          $draggable_helper.html('').removeData().remove()\r\n          $draggable_helper = null\r\n        }, true)\r\n      }\r\n\r\n      let above\r\n      const mouse_y = e.originalEvent.pageY\r\n\r\n      if (mouse_y < $(tag_under).offset().top + $(tag_under).outerHeight() / 2) above = true\r\n      else above = false\r\n\r\n      let $tag_under = $(tag_under)\r\n      let margin = 0\r\n\r\n      // Should go below and there is no tag below.\r\n      if (!above && $tag_under.next().length === 0) {\r\n        if ($draggable_helper.data('fr-position') !== 'after' || !$tag_under.is($draggable_helper.data('fr-tag'))) {\r\n          margin = parseFloat($tag_under.css('margin-bottom')) || 0\r\n\r\n          _setHelperSize(\r\n            $tag_under.offset().top + $(tag_under).height() + margin / 2 - editor.$box.offset().top,\r\n            $tag_under.offset().left - editor.win.pageXOffset - editor.$box.offset().left,\r\n            $tag_under.width()\r\n          ) \r\n\r\n          $draggable_helper.data('fr-position', 'after')\r\n        }\r\n      }\r\n      else {\r\n\r\n        // Should go below then we take the next tag.\r\n        if (!above) {\r\n          $tag_under = $tag_under.next()\r\n        }\r\n\r\n        if ($draggable_helper.data('fr-position') !== 'before' || !$tag_under.is($draggable_helper.data('fr-tag'))) {\r\n          if ($tag_under.prev().length > 0) {\r\n            margin = parseFloat($tag_under.prev().css('margin-bottom')) || 0\r\n          }\r\n          margin = Math.max(margin, parseFloat($tag_under.css('margin-top')) || 0)\r\n\r\n          _setHelperSize(\r\n            $tag_under.offset().top - margin / 2 - editor.$box.offset().top,\r\n            $tag_under.offset().left - editor.win.pageXOffset - editor.$box.offset().left,\r\n            $tag_under.width()\r\n          )\r\n\r\n          $draggable_helper.data('fr-position', 'before')\r\n        }\r\n      }\r\n\r\n      $draggable_helper.data('fr-tag', $tag_under)\r\n\r\n      $draggable_helper.addClass('fr-visible')\r\n      editor.$box.append($draggable_helper)\r\n    }\r\n    else if ($draggable_helper && editor.$box.find($draggable_helper).length > 0) {\r\n      $draggable_helper.removeClass('fr-visible')\r\n    }\r\n  }\r\n\r\n  function _dragOver(e) {\r\n    e.originalEvent.dataTransfer.dropEffect = 'move'\r\n\r\n    if (!editor.opts.dragInline) {\r\n      e.preventDefault()\r\n\r\n      _positionHelper(e)\r\n    }\r\n\r\n    else if (!_getDraggedEl() || editor.browser.msie || editor.browser.edge) {\r\n      e.preventDefault()\r\n    }\r\n  }\r\n\r\n  function _dragEnter(e) {\r\n    e.originalEvent.dataTransfer.dropEffect = 'move'\r\n\r\n    if (!editor.opts.dragInline) {\r\n      e.preventDefault()\r\n    }\r\n  }\r\n\r\n  function _documentDragEnd(e) {\r\n    editor.$el.attr('contenteditable', true) \r\n    const $draggedEl = editor.$el.find('.fr-dragging') \r\n\r\n    if ($draggable_helper && $draggable_helper.hasClass('fr-visible') && editor.$box.find($draggable_helper).length) {\r\n      _drop(e) \r\n    }\r\n    else if ($draggedEl.length) {\r\n      e.preventDefault() \r\n      e.stopPropagation() \r\n    }\r\n\r\n    if ($draggable_helper && editor.$box.find($draggable_helper).length) {\r\n      $draggable_helper.removeClass('fr-visible') \r\n    }\r\n\r\n    $draggedEl.removeClass('fr-dragging') \r\n  }\r\n\r\n  function _getDraggedEl() {\r\n    let $draggedEl = null \r\n\r\n    // Search of the instance we're dragging from.\r\n    for (let i = 0;  i < FE.INSTANCES.length;  i++) {\r\n      $draggedEl = FE.INSTANCES[i].$el.find('.fr-dragging') \r\n\r\n      if ($draggedEl.length) {\r\n        return $draggedEl.get(0) \r\n      }\r\n    }\r\n  }\r\n\r\n  function _drop(e) {\r\n    editor.$el.attr('contenteditable', true) \r\n    let $draggedEl \r\n    let inst \r\n\r\n    // Inst is the intance we're dragging from.\r\n    for (let i = 0;  i < FE.INSTANCES.length;  i++) {\r\n      $draggedEl = FE.INSTANCES[i].$el.find('.fr-dragging') \r\n\r\n      if ($draggedEl.length) {\r\n        inst = FE.INSTANCES[i] \r\n        break \r\n      }\r\n    }\r\n\r\n    // There is a dragged element.\r\n    if ($draggedEl.length) {\r\n\r\n      // Cancel anything else.\r\n      e.preventDefault() \r\n      e.stopPropagation() \r\n\r\n      // Look for draggable helper.\r\n      if ($draggable_helper && $draggable_helper.hasClass('fr-visible') && editor.$box.find($draggable_helper).length) {\r\n        $draggable_helper.data('fr-tag')[$draggable_helper.data('fr-position')]('<span class=\"fr-marker\"></span>') \r\n        $draggable_helper.removeClass('fr-visible') \r\n      }\r\n      else {\r\n        const ok = editor.markers.insertAtPoint(e.originalEvent) \r\n\r\n        if (ok === false) return false \r\n      }\r\n\r\n      // Remove dragging class.\r\n      $draggedEl.removeClass('fr-dragging') \r\n\r\n      $draggedEl = editor.events.chainTrigger('element.beforeDrop', $draggedEl) \r\n\r\n      if ($draggedEl === false) {\r\n        return false \r\n      }\r\n\r\n      // Image with link.\r\n      let $droppedEl = $draggedEl \r\n\r\n      if ($draggedEl.parent().is('A') && $draggedEl.parent().get(0).childNodes.length === 1) {\r\n        $droppedEl = $draggedEl.parent() \r\n      }\r\n\r\n      // Replace marker with the dragged element.\r\n      if (!editor.core.isEmpty()) {\r\n        const $marker = editor.$el.find('.fr-marker') \r\n        $marker.replaceWith(FE.MARKERS) \r\n        editor.selection.restore() \r\n      }\r\n      else {\r\n        editor.events.focus() \r\n      }\r\n\r\n      // Save undo step if the current instance is different than the original one.\r\n      if (inst !== editor && !editor.undo.canDo()) editor.undo.saveStep() \r\n\r\n      // Place new elements.\r\n      if (!editor.core.isEmpty()) {\r\n        const marker = editor.markers.insert() \r\n\r\n        // Make sure we do not have marker inside $droppedEl.\r\n        if ($droppedEl.find(marker).length === 0) {\r\n          $(marker).replaceWith($droppedEl) \r\n        }\r\n        else if ($draggedEl.find(marker).length === 0) {\r\n          $(marker).replaceWith($draggedEl) \r\n        }\r\n\r\n        $draggedEl.after(FE.MARKERS) \r\n        editor.selection.restore() \r\n      }\r\n      else {\r\n        editor.$el.html($droppedEl) \r\n      }\r\n\r\n      // Hide all popups.\r\n      editor.popups.hideAll() \r\n      editor.selection.save() \r\n      editor.$el.find(editor.html.emptyBlockTagsQuery()).not('TD, TH, LI, .fr-inner').not(editor.opts.htmlAllowedEmptyTags.join(',')).remove() \r\n      editor.html.wrap() \r\n      editor.html.fillEmptyBlocks() \r\n      editor.selection.restore() \r\n      editor.undo.saveStep() \r\n\r\n      if (editor.opts.iframe) editor.size.syncIframe() \r\n\r\n      // Mark changes in the original instance as well.\r\n      if (inst !== editor) {\r\n        inst.popups.hideAll() \r\n        inst.$el.find(inst.html.emptyBlockTagsQuery()).not('TD, TH, LI, .fr-inner').remove() \r\n        inst.html.wrap() \r\n        inst.html.fillEmptyBlocks() \r\n        inst.undo.saveStep() \r\n        inst.events.trigger('element.dropped') \r\n\r\n        if (inst.opts.iframe) inst.size.syncIframe() \r\n      }\r\n\r\n      editor.events.trigger('element.dropped', [$droppedEl]) \r\n\r\n      // Stop bubbling.\r\n\r\n      return false \r\n    }\r\n\r\n    // Save step when something else is dragged into the editor.\r\n    else {\r\n      if ($draggable_helper) $draggable_helper.removeClass('fr-visible') \r\n\r\n      if (!editor.undo.canDo()) editor.undo.saveStep() \r\n\r\n      setTimeout(function () {\r\n        editor.undo.saveStep() \r\n      }, 0) \r\n    }\r\n  }\r\n\r\n  /**\r\n   * Do cleanup when the html is taken.\r\n   */\r\n  function _cleanOnGet(el) {\r\n\r\n    // Remove drag helper.\r\n    if (el && el.tagName === 'DIV' && editor.node.hasClass(el, 'fr-drag-helper')) {\r\n      el.parentNode.removeChild(el) \r\n    }\r\n\r\n    // Remove from nested elements too.\r\n    else if (el && el.nodeType === Node.ELEMENT_NODE) {\r\n      const els = el.querySelectorAll('div.fr-drag-helper') \r\n\r\n      for (let i = 0;  i < els.length;  i++) {\r\n        els[i].parentNode.removeChild(els[i]) \r\n      }\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Initialize.\r\n   */\r\n  let $draggable_helper \r\n\r\n  function _init() {\r\n\r\n    // Force drag inline when ENTER_BR is active.\r\n    if (editor.opts.enter === FE.ENTER_BR) editor.opts.dragInline = true \r\n\r\n    // Starting to drag.\r\n    editor.events.on('dragstart', _dragStart, true) \r\n\r\n    // Inline dragging is off.\r\n    editor.events.on('dragover', _dragOver, true) \r\n    editor.events.on('dragenter', _dragEnter, true) \r\n\r\n    // Document drop. Remove moving class.\r\n    editor.events.on('document.dragend', _documentDragEnd, true) \r\n    editor.events.on('document.drop', _documentDragEnd, true) \r\n\r\n    // Drop.\r\n    editor.events.on('drop', _drop, true) \r\n\r\n    // Clean getting the HTML.\r\n    editor.events.on('html.processGet', _cleanOnGet)\r\n  }\r\n\r\n  return {\r\n    _init: _init\r\n  }\r\n}\r\n"],"names":["Object","assign","FE","DEFAULTS","dragInline","PLUGINS","draggable","editor","$","_dragStart","e","originalEvent","target","nodeType","Node","TEXT_NODE","tagName","childNodes","length","hasClass","preventDefault","undo","canDo","saveStep","opts","$el","attr","toolbarInline","toolbar","hide","addClass","browser","msie","edge","selection","clear","dataTransfer","setData","_tagOK","tag_under","node","isElement","_setHelperSize","top","left","width","iframe","iframePaddingTop","helpers","getPX","$wp","find","css","iframePaddingLeft","$iframe","offset","$draggable_helper","_positionHelper","doc","elementFromPoint","pageX","win","pageXOffset","pageY","pageYOffset","top_offset","top_tag","get","bottom_offset","bottom_tag","height","isBlock","blockParent","indexOf","parents","document","createElement","events","on","html","removeData","remove","above","mouse_y","outerHeight","$tag_under","margin","next","data","is","parseFloat","$box","prev","Math","max","append","removeClass","_dragOver","dropEffect","_getDraggedEl","_dragEnter","_documentDragEnd","$draggedEl","_drop","stopPropagation","i","INSTANCES","inst","ok","markers","insertAtPoint","chainTrigger","$droppedEl","parent","core","isEmpty","$marker","replaceWith","MARKERS","restore","focus","marker","insert","after","popups","hideAll","save","emptyBlockTagsQuery","not","htmlAllowedEmptyTags","join","wrap","fillEmptyBlocks","size","syncIframe","trigger","setTimeout","_cleanOnGet","el","parentNode","removeChild","ELEMENT_NODE","els","querySelectorAll","_init","enter","ENTER_BR"],"mappings":"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"}